<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=<%ChangeCharset();%>">
<META http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Cache-Control" content="no-cache">
<meta http-equiv="Expires" content="Thu, 01 Dec 1994 16:00:00 GMT"><META http-equiv="Content-Style-Type" content="text/css"><LINK rel="stylesheet" href="/html/tmp/WHR-G300N-160149-style-ENG.css" type="text/css">
<META http-equiv="Content-Style-Type" content="text/css">
<LINK rel="stylesheet" href="WHR-G300N-160149-style-ENG.css" type="text/css">

<script language="javascript" type="text/javascript" src="common.js"></script>
<script language="JavaScript">
<!--
function HandleKeyPressEvent(e)
{
 // handle i.e. (window.event) and firefox (e)
 var eventInstance = window.event ? event : e;
 
 // handle i.e. (charCode) and firefox (keyCode)
 var unicode = eventInstance.charCode ? eventInstance.charCode : eventInstance.keyCode;
 
 //alert(unicode); 
 if(unicode==13)
   gotoconfirm();
 //var key = String.fromCharCode(unicode); 
}
function gotoconfirm()
{
	var n;
	if (document.getElementById("id_WIFIWPAPSK1").value!="******")
	{
		var err_title="<%GetString("WizardFuncWlanWpapsk2aes","22");%>";
		var err_msg="<%GetString("WizardFuncWlanWpapsk2aes","23");%>";
		var key_value=document.getElementById("id_WIFIWPAPSK1").value;
		
		if(check_0Tof(key_value))
		{		
			if(key_value.length<8)			
			{
				Show_WizardError(err_title,err_msg);
				return;
			}
		}
		else
		{
			if (key_value.length<8)
			{
				Show_WizardError(err_title,err_msg);
				return;
			}
			else if(key_value.length==64)
			{
				Show_WizardError(err_title,err_msg+" <%GetString("WizardFuncWlanWpapsk2aes","26");%>");
				return;
			}
			else if (!wifipskcheck(key_value))
			{
				Show_WizardError(err_title,err_msg);
				return;
			}
		}
		if(!Escape_String(key_value))
		{
			Show_WizardError(err_title,err_msg);
			return;					
		}

	}
	else
		document.getElementById("id_WIFIWPAPSK1").disabled=true;
	document.getElementById("wpa2pska_title").innerHTML = "<%GetString("WizardFuncWlanWpapsk2aes","9");%>";
	document.getElementById("wpa2pska_subtitle").innerHTML = "<%GetString("WizardFuncWlanWpapsk2aes","10");%>";
	document.getElementById("content").style.display = "none";
	document.getElementById("b_content").style.display = "none";
	document.getElementById("confirm").style.display = "";
	document.getElementById("b_confirm").style.display = "";
  document.getElementById("id_WIFIWPAPSK1").value = document.getElementById("id_WIFIWPAPSK1").value.replace("&quot;", "\"");
	/*
	var aoss_mode="<%NvramGet("WIFIAOSSMode");%>";
	if ((document.getElementById("id_WIFIWPAPSK0").value.length == 64)&&(aoss_mode =="1"))
	*/
	/*
	if ((document.getElementById("id_WIFIWPAPSK1").value.length == 64))
		document.getElementById("aoss_disable_flag").style.display = "";
	else
		document.getElementById("aoss_disable_flag").style.display = "none";
	*/

}                                      
function apply()
{
	document.main.submit();
}                                     

// -->
</script>
</head>

<BODY class=WIZ_BODY onkeypress="javascript:HandleKeyPressEvent(event);">
<FORM onsubmit="return false;" method="POST" name="main" action="wizard_func_wlan_wpa2psk_aes_abgn.html">

	<input type="hidden" name="WIFIAuthType1" value="WPA2PSK">
	<input type="hidden" name="WIFIEncrypType1" value="AES">
	
  <table class=WIZ_FRAME>
<tbody>
  <tr class=HEAD>
    <td class=TBL_L></td>
    <td class=TBL_C></td>
    <td class=TBL_R></td>
  </tr>

  <tr class=TBL>
    <td class=TBL_L></td>
    <td class=TBL_C>

      <table class=WIZ_FRAME2>
        <tbody>

          <TR class=HEAD>
            <TD class=TBL_L></TD>
            <TD class=TBL_C><%GetString("WizardFuncWlanWpapsk2aes","1");%></TD>
     	  <TD class=TBL_R></TD>
          </TR>
     	<TR class=HEAD2>
     	  <TD class=TBL_L></TD>
     	  <TD class=TBL_C id="wpa2pska_title"><%GetString("WizardFuncWlanWpapsk2aes","2");%>
     	  </TD>
     	  <TD class=TBL_R></TD>
          </TR>
          <TR class=TBL>
            <TD class=TBL_L></TD>
            <td class=TBL_C>
     	    <table class=WIZ_FRAME3>
                <tbody>
                  <tr class=HEAD>
                    <td class=TBL_L></td>
                    <td class=TBL_C id="wpa2pska_subtitle"><%GetString("WizardFuncWlanWpapsk2aes","29");%>
                  	<div id="id_errtbl" class="C_ERR" style="display:none;"></div>
     			</td>
     			<td class=TBL_R></td>
                  </tr>
                  <tr class=TBL>
     			<td class=TBL_L></td>
     			<td class=TBL_C>
     			<div id="content">
     			  <table class=WIZ_SET>
     			    <TBODY>
     				 <TR>
     				   <th>
     					<%GetString("WizardFuncWlanWpapsk2aes","4");%>
     				   </th>
     				   <TD>
     					<!--<input type="password" name="WIFIWPAPSK1" id="id_WIFIWPAPSK1" size="64" maxlength="64"
     						     value="<%ChangeKeyToStar("WIFIWPAPSK1");%>">-->
							<input type="password" name="WIFIWPAPSK1" id="id_WIFIWPAPSK1" size="64" maxlength="64"
     						     value="<%NvramGet_WPAPSK("WIFIWPAPSK1");%>">
     				   </TD>
     				 </TR>
     			    </TBODY>
     			  </TABLE>
     			  <TABLE class=WIZ_TIPS>
     			    <TBODY>
     				 <TR>
     				   <TD>
     					<P>
     						<%GetString("WizardFuncWlanWpapsk2aes","5");%><br>
     					</P>
     				   </TD>
     				 </TR>
     			    </TBODY>
     			  </TABLE>
     			   </div>
     			  <div id="confirm" style="display:none;">
      				<TABLE class=WIZ_TIPS>
      				    <tr>
     					<td>
     			   		<P>
					<%GetString("WizardFuncWlanWpapsk2aes","11");%><br>
					<%GetString("WizardFuncWlanWpapsk2aes","12");%><br>
					<%GetString("WizardFuncWlanWpapsk2aes","13");%><br>
					
					<!--Already block in previous detections
					<span id="aoss_disable_flag"><p style="color:red;">
					<%GetString("WizardFuncWlanWpapsk2aes","24");%>
					<br><%GetString("WizardFuncWlanWpapsk2aes","25");%>
					</p></span>
					-->

					<%GetString("WizardFuncWlanWpapsk2aes","14");%><br>
					<%GetString("WizardFuncWlanWpapsk2aes","15");%><br>
					<ol>
					  <li><%GetString("WizardFuncWlanWpapsk2aes","16");%></li>
					  <li><%GetString("WizardFuncWlanWpapsk2aes","17");%></li>
					  <li><%GetString("WizardFuncWlanWpapsk2aes","18");%></li>
					</ol>
					<%GetString("WizardFuncWlanWpapsk2aes","19");%>
					</P>
     					</td>            
     				    </tr>
     				</TABLE>
      			</div>
     			</TD>
     			<TD class=TBL_R></TD>
     		   </TR>
     		   <TR class=FOOT>
     			<TD class=TBL_L></TD>
     			<TD class=TBL_C></TD>
     			<TD class=TBL_R></TD>
     		   </TR>
     		 </TBODY>
     	    </TABLE>
     	  </td>
     	  <TD class=TBL_R></TD>
     	</TR>
          <TR class=FOOT>
            <TD class=TBL_L></TD>
            <TD class=TBL_C></TD>
            <TD class=TBL_R></TD>
          </TR>
        </TBODY>
      </TABLE>
<div id="b_content">
      <table class=NAVI>
        <tbody>
          <tr>
            <td class=NAVI_L>
                  <INPUT type="button" value="<%GetString("WizardFuncWlanWpapsk2aes","6");%>" onClick=location.href="wizard_func_wlan_crypto.html">
     	  </td>
     	  <td class=NAVI_C>
     	  </td>
     	  <td class=NAVI_R>
                  <INPUT type="button" value="<%GetString("WizardFuncWlanWpapsk2aes","7");%>" onclick="gotoconfirm()">
     	  </td>
     	</tr>
        </tbody>
      </table>
      </div>
      <div id="b_confirm" style="display:none;">
      <table class=NAVI>
        <tbody>
          <tr>
            <td class=NAVI_L>
                  <INPUT type="button" value="<%GetString("WizardFuncWlanWpapsk2aes","6");%>" onClick=location.href="wizard_func_wlan_wpa2psk_aes.html">
     	  </td>
     	  <td class=NAVI_C>
     	  </td>
     	  <td class=NAVI_R>
                  <INPUT type="button" value="<%GetString("WizardFuncWlanWpapsk2aes","7");%>" onclick="apply();">
     	  </td>
     	</tr>
        </tbody>
      </table>
      </div>   
    </td>
    <td class=TBL_R></td>
  </tr>

  <tr class=FOOT>
    <td class=TBL_L></td>
    <td class=TBL_C></td>
    <td class=TBL_R></td>
  </tr>
</tbody>
</table>
<!--<input type=hidden name=sWebSessionnum value=33>-->
<!--<input type=hidden name=sWebSessionid value=-266134064>-->
<input type="hidden" name="nosave_session_num" value="<% NvramGet("session_num"); %>">
</FORM>
</BODY>
</HTML>
