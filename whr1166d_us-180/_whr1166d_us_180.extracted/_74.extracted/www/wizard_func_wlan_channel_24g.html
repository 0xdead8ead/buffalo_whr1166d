

<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=<%ChangeCharset();%>">
<META http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Cache-Control" content="no-cache">
<meta http-equiv="Expires" content="Thu, 01 Dec 1994 16:00:00 GMT"><META http-equiv="Content-Style-Type" content="text/css"><LINK rel="stylesheet" href="WHR-G300N-160149-style-ENG.css" type="text/css">
<script src="OnceOnly.html"></script>
</head>
<script language="javascript" type="text/javascript" src="common.js"></script>
<script type="text/javascript">
<!--
<%GetExtCnlJS("main","WIFIHTEXTCHA","WIFIChannel", "wizard");%>
function HandleKeyPressEvent(e)
{
 // handle i.e. (window.event) and firefox (e)
 var eventInstance = window.event ? event : e;
 
 // handle i.e. (charCode) and firefox (keyCode)
 var unicode = eventInstance.charCode ? eventInstance.charCode : eventInstance.keyCode;
 
 //alert(unicode); 
 if(unicode==13)
   confirm();
 //var key = String.fromCharCode(unicode); 
}
function show_table(idname)
{
  document.getElementById(idname).style.display = "";
}

function hide_table(idname)
{
  document.getElementById(idname).style.display = "none";
}

function Create(TargetSelectName, OptionListArray) 
{ 
     var iMaxArrayCnt = OptionListArray.length;
     var iCnt = 0; 
     for (iCnt = 0; iCnt < iMaxArrayCnt; iCnt++){ 
     	
     	oAdd = document.createElement('option');
     	if(TargetSelectName.childNodes[iCnt]  != undefined) {
     		TargetSelectName.removeChild(TargetSelectName.childNodes[iCnt]);
     	}
     	TargetSelectName.appendChild(oAdd);
     	
     	TargetSelectName.childNodes[iCnt].setAttribute('value',OptionListArray[iCnt]);
     	oAddx= document.createTextNode(OptionListArray[iCnt]);
     	if(TargetSelectName.childNodes[iCnt].firstChild  != undefined) {
     		TargetSelectName.childNodes[iCnt].removeChild(TargetSelectName.childNodes[iCnt].firstChild);
     	}
     	
     	TargetSelectName.childNodes[iCnt].appendChild(oAddx);
     }
     TargetSelectName.length=iCnt;
}

var ex_channel_11bg_set_full  = new Array("1","2","3","4","5","6","7","8","9","10","11"

); 
var ex_channel_11bg_set_1ch   = new Array("5");
var ex_channel_11bg_set_2ch   = new Array("6");
var ex_channel_11bg_set_3ch   = new Array("7");
var ex_channel_11bg_set_4ch   = new Array("8");
var ex_channel_11bg_set_5ch_11N   = new Array("9" ,"1");
var ex_channel_11bg_set_6ch_11N   = new Array("10","2");
var ex_channel_11bg_set_7ch_11N   = new Array("11","3");
var ex_channel_11bg_set_8ch_11N   = new Array(

	"4");
var ex_channel_11bg_set_9ch_11N   = new Array(

	"5");
var ex_channel_11bg_set_10ch  = new Array("6");
var ex_channel_11bg_set_11ch  = new Array("7");


function ex_channel_11bg_change()
{
     var BandWidth = 20;
     
     document.forms[0].WIFIHTEXTCHA.disabled = 0;

     if (document.main.WIFIHTBW.value == "1"){
     	if(document.main.WIFIChannel.value == "0"){
     		Create(document.getElementById('id_WIFIHTEXTCHA'), ex_channel_11bg_set_full);
     		document.forms[0].WIFIHTEXTCHA.disabled = 1;
     	} else if(document.main.WIFIChannel.value == "1"){
     		Create(document.getElementById('id_WIFIHTEXTCHA'), ex_channel_11bg_set_1ch);
     	} else if(document.main.WIFIChannel.value == "2"){
     		Create(document.getElementById('id_WIFIHTEXTCHA'), ex_channel_11bg_set_2ch);
     	} else if(document.main.WIFIChannel.value == "3"){
     		Create(document.getElementById('id_WIFIHTEXTCHA'), ex_channel_11bg_set_3ch);
     	} else if(document.main.WIFIChannel.value == "4"){
     		Create(document.getElementById('id_WIFIHTEXTCHA'), ex_channel_11bg_set_4ch);
     	} else if(document.main.WIFIChannel.value == "5"){
     		Create(document.getElementById('id_WIFIHTEXTCHA'), ex_channel_11bg_set_5ch_11N);
     	} else if(document.main.WIFIChannel.value == "6"){
     		Create(document.getElementById('id_WIFIHTEXTCHA'), ex_channel_11bg_set_6ch_11N);
     	} else if(document.main.WIFIChannel.value == "7"){
     		Create(document.getElementById('id_WIFIHTEXTCHA'), ex_channel_11bg_set_7ch_11N);
     	} else if(document.main.WIFIChannel.value == "8"){
     		Create(document.getElementById('id_WIFIHTEXTCHA'), ex_channel_11bg_set_8ch_11N);
     	} else if(document.main.WIFIChannel.value == "9"){
     		Create(document.getElementById('id_WIFIHTEXTCHA'), ex_channel_11bg_set_9ch_11N);
     	} else if(document.main.WIFIChannel.value == "10"){
     		Create(document.getElementById('id_WIFIHTEXTCHA'), ex_channel_11bg_set_10ch);
     	} else if(document.main.WIFIChannel.value == "11"){
     		Create(document.getElementById('id_WIFIHTEXTCHA'), ex_channel_11bg_set_11ch);
     	}

     } else {
     	Create(document.getElementById('id_WIFIHTEXTCHA'), ex_channel_11bg_set_full);
     	document.forms[0].WIFIHTEXTCHA.disabled = 1;
     }
}

function enableExtChn()
{
	if (document.getElementById("id_WIFIHTBW").selectedIndex && document.main.WIFIChannel.value!="0")
		document.getElementById("id_WIFIHTEXTCHA").disabled=false;
	else
		document.getElementById("id_WIFIHTEXTCHA").disabled=true;
		
	var wds_enable="<%NvramGet("WIFIApCliEnable");%>";
	if (wds_enable==1)
		document.getElementById("id_WIFIHTEXTCHA").disabled=true;
}

function channel_change_11a() {
     ex_channel_change_11a();
}

function check_duplicate_ssid(check_ssid){

	ssid3_enable = "<%NvramGet("WIFISsid3Enable");%>";

	if( ssid3_enable == "1" ){
		if( "<%NvramGet("WIFISsid3");%>" == check_ssid.value ){return 1;}
	}

	if( "<%NvramGet("WIFIAOSSMode");%>" == "1" ){
		if( "<%NvramGet("WIFIAOSSSSID3");%>" == check_ssid.value ){return 1;}
		if( "<%NvramGet("WIFIAOSSSSID4");%>" == check_ssid.value ){return 1;}
	}
	
	return 0;
}

function confirm()
{
	var WFSID=document.getElementById("id_WIFISsid1");
	var CH=document.getElementById("id_WIFIChannel");
	var HT=document.getElementById("id_WIFIHTBW");
	var EXTCH=document.getElementById("id_WIFIHTEXTCHA");
	var n;
	if(WFSID.value.length==0)
	{
		Show_WizardError("<%GetString("WizardFuncWlanChannel","34");%>","<%GetString("WizardFuncWlanChannel","35");%>");
		return;
	}
	else if(check_duplicate_ssid(WFSID)==1)
	{
		Show_WizardError("<%GetString("WizardFuncWlanChannel","34");%>","<%GetString("WlanMulti","74");%>");
		return;
	}
	else if(!Escape_String(WFSID.value))
	{
		Show_WizardError("<%GetString("WizardFuncWlanChannel","34");%>","<%GetString("WlanSingle","64");%>");
		return;		
	}
	/*else
	{
		for (n=0;n<WFSID.value.length;n++)
		{
			if (WFSID.value.charAt(n)==';')
			{
				Show_error("<%GetString("WizardFuncWlanChannel","34");%>","<%GetString("WizardFuncWlanChannel","42");%>");
				return;
			}
		}
	}*/
    Hide_error();
    if("<%CheckAPVer("mode");%>"=="1")
    {
      var SSID1="<%NvramGet("WIFISsid1Enable");%>";  
      if (SSID1=="0")
      {
        document.getElementById("id_wifimain").style.display="none";
        document.getElementById("id_wificonfirm").style.display="";
      }
      else
      {
        document.getElementById("id_wifimain").style.display="";
        document.getElementById("id_wificonfirm").style.display="none";
        apply();
      }
    }
    else
    {
        self.location.href='wizard_func_wlan_channel_check.html?WFSID='+WFSID.value+'&CH='+CH.value+'&HT='+HT.value+'&EXTCH='+EXTCH.value;    
    }
}
	
function back()
{
        document.getElementById("id_wifimain").style.display="";
        document.getElementById("id_wificonfirm").style.display="none";
}

function apply()
{
    if(document.getElementById("mm_WIFISsid1Enable").value==0)
        document.getElementById("mm_WIFISsid1Enable").value=1;
	document.main.submit();
}

// -->
</script>


<BODY class=WIZ_BODY onkeypress="javascript:HandleKeyPressEvent(event);" onload="enableExtChn();">

<FORM   onsubmit="return false;"  method="POST" name="main" action="wizard_func_wlan_channel.html">
<input type="hidden" name="WIFISsid1Enable" id="mm_WIFISsid1Enable" value="<%NvramGet("WIFISsid1Enable");%>">
  <table class=WIZ_FRAME>
<tbody>
  <tr class=HEAD>
    <td class=TBL_L></td>
    <td class=TBL_C></td>
    <td class=TBL_R></td>
  </tr>

  <tr class=TBL>
    <td class=TBL_L></td>
    <td class=TBL_C>


<span id="id_wifimain">
      <table class=WIZ_FRAME2>
        <tbody>

          <TR class=HEAD>
            <TD class=TBL_L></TD>
            <TD class=TBL_C><%GetString("WizardFuncWlanChannel","1");%></TD>
     	  <TD class=TBL_R></TD>
          </TR>
     	<TR class=HEAD2>
     	  <TD class=TBL_L></TD>
     	  <TD class=TBL_C><%GetString("WizardFuncWlanChannel","2");%></TD>
     	  <TD class=TBL_R></TD>
          </TR>
          <TR class=TBL>
            <TD class=TBL_L></TD>
            <td class=TBL_C>
     	    <table class=WIZ_FRAME3>
                <tbody>
                  <tr class=HEAD>
                    <td class=TBL_L></td>
                    <td class=TBL_C>&nbsp;<%GetString("WizardFuncWlanChannel","2");%>
                  	<div id="id_errtbl" class="C_ERR" style="display:none;"></div>
     			</td>
     			<td class=TBL_R></td>
                  </tr>
                  <tr class=TBL>
     			<td class=TBL_L></td>
     			<td class=TBL_C>
     			  <table class=WIZ_SET>
     			    <TBODY>
                      <TR>
                        <th><span class=WLAN11G><%GetString("WizardFuncWlanChannel","3");%></span></th>
     			    <TD>
<!--  -->
     				 <p><%GetString("WizardFuncWlanChannel","4");%>: <input type="text" size="40" maxlength="32" name="WIFISsid1" id="id_WIFISsid1" value="<%NvramGetAdv("WIFISsid1");%>"></p>
				 <p>
     				   <%GetString("WizardFuncWlanChannel","5");%>: 
				   <select name="WIFIChannel" id="id_WIFIChannel" onchange="<%GetExtCnlJS();%>" onclick="enableExtChn();" <%NvramMatch("WIFIApCliEnable","1","disabled");%>>
			     		<%GetChannelList();%>
	                           </select>
     				 <%GetChannelString();%></p>
		    		 <p>
		       		   <%GetString("WizardFuncWlanChannel","9");%>: 
				   <select name="WIFIHTBW"  id="id_WIFIHTBW" onclick="enableExtChn();" <%NvramMatch("WIFIApCliEnable","1","disabled");%>>
				        <option value="0" <%NvramMatch("WIFIBW_Option", "0", "selected");%>>20 <%GetString("WizardFuncWlanChannel","37");%></option>
				        <option value="1" <%NvramMatch("WIFIBW_Option", "1", "selected");%>>20/40 <%GetString("WizardFuncWlanChannel","37");%></option>
						<option value="2" <%NvramMatch("WIFIBW_Option", "2", "selected");%>>40 <%GetString("WizardFuncWlanChannel","37");%></option>
			           </select>
				 </p>
		    		 <p>
        	   		   <%GetString("WizardFuncWlanChannel","10");%>: <select size="1" name="WIFIHTEXTCHA" id="id_WIFIHTEXTCHA" style="width:45px;" <%NvramMatch("WIFIApCliEnable","1","disabled");%>><%GetExtChannel("wizard");%></select>
        			 </p>
                            </TD>
                      </TR>
                    </TBODY>
     			  </table>
     			  <table class=WIZ_TIPS>
     			    <TBODY>
     				 <TR>
     				   <TD>
                        <P>
<b><%GetString("WizardFuncWlanChannel","11");%></b><br>
<%GetString("WizardFuncWlanChannel","12");%>
<br><br>
<%GetString("WizardFuncWlanChannel","13");%><br> 
<%GetString("WizardFuncWlanChannel","14");%><br>
<%GetString("WizardFuncWlanChannel","15");%><br>


                        </P>
                        <P>

<%GetString("WizardFuncWlanChannel","16");%><br>
<%GetString("WizardFuncWlanChannel","17");%><br>

                        </P>
                        
<%CheckAOSSActing("wizard_func_wlan_channel.html");%>

<p style="color:red;">
</p>
     			       </TD>
     			     </TR>
     			   </TBODY>
     			 </table> <!-- class=WIZ_TIPS -->

     			</TD>
     			<TD class=TBL_R></TD>
     		   </TR>
     		   <TR class=FOOT>
     			<TD class=TBL_L></TD>
     			<TD class=TBL_C></TD>
     			<TD class=TBL_R></TD>
     		   </TR>
     		 </TBODY>
     	    </TABLE>
     	  </td>
     	  <TD class=TBL_R></TD>
     	</TR>
          <TR class=FOOT>
            <TD class=TBL_L></TD>
            <TD class=TBL_C></TD>
            <TD class=TBL_R></TD>
          </TR>
        </TBODY>
      </TABLE>
  
      <table class=NAVI>
        <tbody>
          <tr>
            <td class=NAVI_L>
     	    <INPUT type="button" value="<%GetString("WizardFuncWlanChannel","18");%>" onClick="top.location.href='index.html'">
     	  </td>
     	  <td class=NAVI_C>
     	  </td>
     	  <td class=NAVI_R>
     	    <INPUT type="button" value="<%GetString("WizardFuncWlanChannel","19");%>" onClick="confirm()">
     	  </td>
     	</tr>
        </tbody>
      </table>            
</span>  
<span id="id_wificonfirm" style="display:none;">
      <table class=WIZ_FRAME2>
        <tbody>

          <TR class=HEAD>
            <TD class=TBL_L></TD>
            <TD class=TBL_C><%GetString("WizardFuncWlanChannel","1");%></TD>
     	  <TD class=TBL_R></TD>
          </TR>
     	<TR class=HEAD2>
     	  <TD class=TBL_L></TD>
     	  <TD class=TBL_C><%GetString("WizardFuncWlanChannel","2");%></TD>
     	  <TD class=TBL_R></TD>
          </TR>
          <TR class=TBL>
            <TD class=TBL_L></TD>
            <td class=TBL_C>
     	    <table class=WIZ_FRAME3>
                <tbody>
                  <tr class=HEAD>
                    <td class=TBL_L></td>
                    <td class=TBL_C>&nbsp;<%GetString("WizardFuncWlanChannel","22");%>
                  	<div id="id_errtbl" class="C_ERR" style="display:none;"></div>
     			</td>
     			<td class=TBL_R></td>
                  </tr>
                  <tr class=TBL>
     			<td class=TBL_L></td>
     			<td class=TBL_C>
     			  <table>
     			    <tbody>
     				 <tr>
     				   <td>                
                    <p><%GetString("WizardFuncWlanChannel","23");%></p>
                    <p><%GetString("WizardFuncWlanChannel","43");%></p>
                    <!--Currently SSID1 is not used. If you continue the setting, SSID1 is enabled. Changing wireless channel solely does not effect SSID1 setting though.-->
                        </td></tr></tbody></table>
     			</TD>     
     			<TD class=TBL_R></TD>
     		   </TR>
     		   <TR class=FOOT>
     			<TD class=TBL_L></TD>
     			<TD class=TBL_C></TD>
     			<TD class=TBL_R></TD>
     		   </TR>
     		 </TBODY>
     	    </TABLE>
     	  </td>
     	  <TD class=TBL_R></TD>
     	</TR>
          <TR class=FOOT>
            <TD class=TBL_L></TD>
            <TD class=TBL_C></TD>
            <TD class=TBL_R></TD>
          </TR>
        </TBODY>
      </TABLE>
  
      <table class=NAVI>
        <tbody>
          <tr>
            <td class=NAVI_L>
     	    <INPUT type="button" value="<%GetString("WizardFuncWlanChannel","18");%>" onClick="back()">
     	  </td>
     	  <td class=NAVI_C>
     	  </td>
     	  <td class=NAVI_R>
     	    <INPUT type="button" value="<%GetString("WizardFuncWlanChannel","19");%>" onClick="apply()">
     	  </td>
     	</tr>
        </tbody>
      </table>
</span>            

    </td>
    <td class=TBL_R></td>
  </tr>

  <tr class=FOOT>
    <td class=TBL_L></td>
    <td class=TBL_C></td>
    <td class=TBL_R></td>
  </tr>
</tbody>
</table>
<input type="hidden" name="nosave_session_num" value="<% NvramGet("session_num"); %>">
</FORM>
</BODY>
</HTML>
