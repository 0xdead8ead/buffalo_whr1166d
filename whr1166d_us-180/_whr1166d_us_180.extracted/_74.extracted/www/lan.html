<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=<%ChangeCharset();%>">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Cache-Control" content="no-cache">
<META http-equiv="Content-Style-Type" content="text/css">
<LINK rel="stylesheet" href="WHR-G300N-160149-style-ENG.css" type="text/css">
<LINK rel="stylesheet" href="WHR-G300N-160149-style-ad-ENG.css" type="text/css">
<link rel="alternate stylesheet" id="anothercss_common" type="text/css" href="/images/style-PY20-common.css">
<link rel="alternate stylesheet" id="iecss_common" type="text/css" href="/images/style-PY20-common-compatible.css">
<script language="JavaScript" type="text/javascript" src="common.js"></script>
<script type="text/javascript" src="/js/yahoo_2.0.0.js"></script>
<script type="text/javascript" src="/js/connection_2.0.0.js"></script>
<script type="text/javascript" src="/js/event_2.0.0.js"></script>
<script language="JavaScript">
<!--
var oCallback = {
success:function(oResponse) { 
			document.getElementById("id_main").style.display = "none";
			top.document.getElementById("indicator").style.display = "";
			top.document.getElementById("waiting_err_text").style.display = "none";
			top.document.getElementById("waiting_err_btn").style.display = "none";
			top.dispWaiting(true);
			window.setTimeout("window.location.href='lan.html'", 10000);
}, 
failure:function(oResponse) {  
} 
}
function checkbroadcast(lanip,lanmask,dhcpip,endip,num) 
{
	var i=0;
	var ip,mask,start,end;
	var lastip=new Array(4);
	var startip,endip,chkip;
	var setflag=0;
	ip=lanip.split('.');
	mask=lanmask.split('.');
	start=dhcpip.split('.');
	end=endip.split('.');
	for (i=3;i>=0;i--)
	{
		if (mask[i]==0)
			lastip[i]=255;
		else
		{
			if (mask[i]!=255)
				lastip[i]=(ip[i]&mask[i])+(255-mask[i]);
			else
				lastip[i]=start[i];
		}
			
	}
	//startip=start[0]+":"+start[1]+":"+start[2]+":"+start[3];
	//chkip=lastip[0]+":"+lastip[1]+":"+lastip[2]+":"+lastip[3];
	//alert("before:startip:"+startip+"endip:"+endip+"chkip:"+chkip);
	startip=Math.pow(255,3)*(parseInt(start[0],10))+Math.pow(255,2)*(parseInt(start[1],10))+255*(parseInt(start[2],10))+(parseInt(start[3],10));  
	endip=Math.pow(255,3)*(parseInt(end[0],10))+Math.pow(255,2)*(parseInt(end[1],10))+255*(parseInt(end[2],10))+(parseInt(end[3],10));
	chkip=Math.pow(255,3)*(parseInt(lastip[0],10))+Math.pow(255,2)*(parseInt(lastip[1],10))+255*(parseInt(lastip[2],10))+(parseInt(lastip[3],10));
	//alert("after:startip:"+startip+"endip:"+endip+"chkip:"+chkip);
	if ((parseInt(startip,10)<=parseInt(chkip,10))&&(parseInt(endip,10)>=parseInt(chkip,10)))	
		return false;
	else
		return true;
}

function dhcps_ext_exist() {
  var oElmsExt = document.getElementById("dhcpleasetime");
  if(oElmsExt.length == 0)
  {
    return(false);
  }
  return(true);
}

function dhcp_sv_select()
{
  var disable_flag = 0;
  
  if (document.getElementById("id_DHCPSEnable").checked == true) 
  {
    disable_flag = 0;
    document.nosave_form.DHCPSEnable.value="1";
  } 
  else 
  {
    disable_flag = 1;
    document.nosave_form.DHCPSEnable.value="0";
  }
  
  document.nosave_form.DHCPSIPStart.disabled = disable_flag;
  document.getElementById("id_DHCPSIPEnd").disabled = disable_flag;
  document.nosave_form.DHCPSExcludedIPAll.disabled = disable_flag;
  
  if( dhcps_ext_exist()==true ) 
  {
    document.getElementById("dhcpleasetime").disabled = disable_flag;
    document.nosave_form.DHCPSDefaultGWStatus[0].disabled = disable_flag;
    document.nosave_form.DHCPSDefaultGWStatus[1].disabled = disable_flag;
    document.nosave_form.DHCPSDefaultGWStatus[2].disabled = disable_flag;
    document.nosave_form.DHCPSDefaultGW.disabled = disable_flag;
    document.nosave_form.DHCPSDNSServerStatus[0].disabled = disable_flag;
    document.nosave_form.DHCPSDNSServerStatus[1].disabled = disable_flag;
    document.nosave_form.DHCPSDNSServerStatus[2].disabled = disable_flag;
    document.nosave_form.DHCPSDNSServer1.disabled = disable_flag;
    document.nosave_form.DHCPSDNSServer2.disabled = disable_flag;
    document.nosave_form.DHCPSWINSServerStatus[0].disabled = disable_flag;
    document.nosave_form.DHCPSWINSServerStatus[1].disabled = disable_flag;
    document.nosave_form.DHCPSWINSServerStatus[2].disabled = disable_flag;
    document.nosave_form.DHCPSWINSServer.disabled = disable_flag;
    document.nosave_form.DHCPSDomainNameStatus[0].disabled = disable_flag;
    document.nosave_form.DHCPSDomainNameStatus[1].disabled = disable_flag;
    document.nosave_form.DHCPSDomainNameStatus[2].disabled = disable_flag;
    document.nosave_form.DHCPSDomainName.disabled = disable_flag;
    
    if(disable_flag == 0) 
    {
      dhcps_ext_select();
    }
  }
}

function dhcps_ext_select()
{
  if (document.nosave_form.DHCPSDefaultGWStatus[1].checked == true) 
  {
    document.nosave_form.DHCPSDefaultGW.disabled = 0;
  } 
  else 
  {
    document.nosave_form.DHCPSDefaultGW.disabled = 1;
  }
  
  if (document.nosave_form.DHCPSDNSServerStatus[1].checked == true) 
  {
    document.nosave_form.DHCPSDNSServer1.disabled = 0;
    document.nosave_form.DHCPSDNSServer2.disabled = 0;
  } 
  else 
  {
    document.nosave_form.DHCPSDNSServer1.disabled = 1;
    document.nosave_form.DHCPSDNSServer2.disabled = 1;
  }
  
  if (document.nosave_form.DHCPSWINSServerStatus[1].checked == true) 
  {
    document.nosave_form.DHCPSWINSServer.disabled = 0;
  } 
  else 
  {
    document.nosave_form.DHCPSWINSServer.disabled = 1;
  }
  
  if (document.nosave_form.DHCPSDomainNameStatus[1].checked == true) 
  {
    document.nosave_form.DHCPSDomainName.disabled = 0;
  } 
  else 
  {
    document.nosave_form.DHCPSDomainName.disabled = 1;
  }
}

function set_display()
{
  if(document.getElementById("id_DHCPSAdvancedDisplay").checked == true)
  {
    document.getElementById("dhcps_ext_settings").style.display = "";
    document.nosave_form.DHCPSAdvancedDisplay.value="1";
  } 
  else 
  {
    document.getElementById("dhcps_ext_settings").style.display = "none";
    document.nosave_form.DHCPSAdvancedDisplay.value="0";
  }
  SetCwinHeight();
}

function InitForms()
{
  var dhcpstartip="<%NvramGet("DHCPSIPStart");%>";
  var dhcpendip="<%NvramGet("DHCPSIPEnd");%>";
  var dhcpendipnum_3="<%NvramGet("DHCPSMaxUser");%>";
  var n1,n2;
  var leasetime= "<%NvramGet("DHCPSLeaseTime");%>";
  var wanunnum= "<%NvramGet("UnIPEnable");%>";
  
  top.dispWaiting(false);
  //document.getElementById("id_main").style.display = "block";
  checkBrowserCss();
  dhcp_sv_select('nosave_form');
  set_display();

  if (wanunnum == "1")
  {
	document.forms[0].UnIPIPAddr.disabled = 0;
	document.forms[0].UnIPNetmask.disabled = 0;
  }
  else
  {
    document.forms[0].UnIPIPAddr.disabled = 1;
    document.forms[0].UnIPNetmask.disabled = 1;
  }
  
  function dhcps_ext_exist() {
  var oElmsExt = document.getElementById("dhcpleasetime");
  if(oElmsExt.length == 0)
  {
    return(false);
  }
  return(true);
}
    document.getElementById("id_DHCPSIPEnd").value=dhcpendipnum_3.toString();//set dhcp end ip num
/*
  n1=dhcpstartip.split('.');
  n2=dhcpendip.split('.');
  if (n1[2]==n2[2])
  {
    dhcpendipnum_3=parseInt(n2[3],10)-parseInt(n1[3],10)+1;//start-end+1
    document.getElementById("id_DHCPSIPEnd").value=dhcpendipnum_3.toString();//set dhcp end ip num
  }
  else //if (n1[2]!=n2[2])
  {
    dhcpendipnum_3=parseInt(n2[3],10)+255-parseInt(n1[3],10)+1;//start+255-end+1
    document.getElementById("id_DHCPSIPEnd").value=dhcpendipnum_3.toString();//set dhcp end ip num
  }*/
  
  document.getElementById("dhcpleasetime").value = (parseInt(leasetime))/3600;
}

function check_ip_format(ip, item, type,netmask)
{
	var n;
	var lanip=document.nosave_form.LanIPAddr.value;
	var lanmask=document.nosave_form.LanNetmask.options[document.nosave_form.LanNetmask.selectedIndex].value;
	var canNotSetTo255=0;
	var wanip="<%NvramGet("WanCurrentIP");%>";
	var wanmask="<%NvramGet("WanCurrentNetmask");%>";
	
	if (netmask)
	{
		if (netmask.length > 0)
		{
			o = netmask.split('.');
			if (o.length==4)
			{
				if (o[2]>=254)
					canNotSetTo255=1;
			}
		}
	}
	
	if(!isAllowValueIP(ip,item))
	{
    return false;
  }
  if (ip=="0.0.0.0")
  {
    Show_error(item,"<%GetString("Lan","30");%>");
    return false;
  }
  if (ip=="255.255.255.255")
  {
    Show_error(item,"<%GetString("Lan","31");%>");
    return false;
  }
  
  if (!isBlank(ip))
  {
    n = ip.split('.');
    
    if (n.length!=4)
    {
      Show_error(item,"<%GetString("Lan","33");%>");
      return false;
    }
    else
    {
      if(isBlank(n[0]))
      {
        Show_error(item,"<%GetString("Lan","33");%>");
        return false;
      }	
      //else if((isNaN(n[0]))||(n[0]<=0)||(n[0]>255)||!check_integer(n[0])||check_initial_zero(n[0])) 
	  else if((isNaN(n[0]))||(n[0]<=0)||(n[0]>255)||!check_integer(n[0])) 
      {
        Show_error(item,"<%GetString("Lan","33");%>");
        return false;
      }
      else if (n[0]==127)
      {
        Show_error(item,"<%GetString("Lan","34");%>");
        return false;
      }
	  else if (n[0]>=224 && n[0]<=239)
      {
        Show_error(item,"<%GetString("WizardFuncInet","49");%>");
        return false;
      }
      else if (n[0]>=240 && n[0]<=255)
      {
        Show_error(item,"<%GetString("Lan","35");%>");
        return false;
      }	
      
      if(isBlank(n[1]))
      {
        Show_error(item,"<%GetString("Lan","33");%>");
        return false;
      }
      //else if((isNaN(n[1]))||(n[1]<0)||(n[1]>255)||!check_integer(n[1])||check_initial_zero(n[1])) 
	  else if((isNaN(n[1]))||(n[1]<0)||(n[1]>255)||!check_integer(n[1])) 
      {
        Show_error(item,"<%GetString("Lan","33");%>");
        return false;
      }		
      
      if(isBlank(n[2]))
      {
        Show_error(item,"<%GetString("Lan","33");%>");
        return false;
      }
      //else if((isNaN(n[2]))||(n[2]<0)||(n[2]>255)||!check_integer(n[2])||check_initial_zero(n[2])) 
	  else if((isNaN(n[2]))||(n[2]<0)||(n[2]>255)||!check_integer(n[2])) 
      {
        Show_error(item,"<%GetString("Lan","33");%>");
        return false; 
      }
      
      if(isBlank(n[3]))
      {
        Show_error(item,"<%GetString("Lan","33");%>");
        return false;
      }
      //else if((isNaN(n[3]))||(n[3]<0)||(n[3]>255)||!check_integer(n[3])||check_initial_zero(n[3]))
	  else if((isNaN(n[3]))||(n[3]<0)||(n[3]>255)||!check_integer(n[3]))
      {
      	if (!(canNotSetTo255==0 && n[3]==255))
       	{
        	Show_error(item,"<%GetString("Lan","33");%>");
        	return false;
        }
      }
    }
    
	if (type=="lanip")
	{
		if(wanip!="" && check_the_same_subnet(wanip,ip,wanmask))
		{
		    Show_error(item,"<%GetString("Lan","69");%>");
			return false;
		}
	}
	
	
    if (type=="defaultgw")//check default getway
    {
      if (!check_the_same_subnet(lanip,ip,lanmask))
      {
        Show_error(item,"<%GetString("Lan","28");%>");
        return false;
      }
      if (check_subnet(lanip,ip,lanmask))
      {
        Show_error(item,"<%GetString("Lan","70");%>");
        return false;
      }
      if (check_broadcast(lanip,ip,lanmask))
      {
        Show_error(item,"<%GetString("Lan","71");%>");
        return false;
      }
    }
  }
  return true;
}

function isEmpty(s)
{
	if(s.length==0)
	{
		return true;
	}
	else
	{
		return false;
	}
}

function check_initial_zero(tmp)
{
	if(tmp.length>1&&tmp.charAt(0)=="0")
	{
		return true;
	}
	return false;
}

function isAllowValueIP(s,item)
{
  var i;
	for (i=0; i<s.length; i++)
	{
		var c;
		
		c=s.charAt(i);
	
		if (((c>='0')&&(c<='9')) || (c=='.'))
		{
      continue;
		}
		else
		{
			Show_error(item,"<%GetString("Lan","36");%>");
      return false;
		}
	}
	
	return true;
}

function checkExcludeIP()
{
  var excip=document.nosave_form.DHCPSExcludedIPAll.value;
  var n1,n2;
  var i;
  var item="<%GetString("Lan","39");%>";
  
  n1=excip.split(',');
  
  for (i=0; i<n1.length; i++)//divide with, and divide with-   and checkip(all ip)
  {
    if (isEmpty(n1[i]))
    {
      Show_error(item,"<%GetString("Lan","33");%>");
      return false;
    }
    
    n2=n1[i].split('-');
    
    if (n2.length==1)
    {
      if (isEmpty(n1[i]))
      {
        Show_error(item,"<%GetString("Lan","33");%>");
        return false;
      }
      if (!check_ip_format(n1[i],"<%GetString("Lan","39");%>",""))
      {
        return false;
      }
      if (!checkExcludeRange(n1[i]))
      {
        return false;
      }
    }
    else if (n2.length==2)
    {
      if (isEmpty(n2[0]) || isEmpty(n2[1]))
      {
        Show_error(item,"<%GetString("Lan","33");%>");
        return false;
      }
      if (!check_ip_format(n2[0],"<%GetString("Lan","39");%>","") || !check_ip_format(n2[1],"<%GetString("Lan","39");%>",""))
      {
        return false;
      }
      
      if (!checkExcludeRange(n2[0]) || !checkExcludeRange(n2[1]))//checkip(Excluded IP Addresses)  should in same subnetmask
      {
        return false;
      }
	if (!ipBig(n2[1],n2[0]))
      //if (!ipBig(n2[2],n1[2]))//check- first ip should big than later
      {
        Show_error(item,"<%GetString("Lan","40");%>");
        return false;
      }
    }
    else//if more Character
    {
      Show_error(item,"<%GetString("Lan","33");%>");
      return false;
    }
  }
 
  return true;
}

function checkExcludeRange(ip)
{
  var lanip=document.nosave_form.LanIPAddr.value;
	var lanmask=document.nosave_form.LanNetmask.options[document.nosave_form.LanNetmask.selectedIndex].value;
	var dhcpstartip=document.nosave_form.DHCPSIPStart.value;
	var dhcpendip=document.nosave_form.DHCPSIPEnd.value;
	var item="<%GetString("Lan","39");%>";
  
  if (!check_the_same_subnet(ip,lanip,lanmask))//same subnetmask
  {
    Show_error(item,"<%GetString("Lan","28");%>");
    return false;
  }
  
  if (ipBig(dhcpstartip,ip) || ipBig(ip,dhcpendip))//in dhcp range  if (ip < dhcpstartip || ip > dhcpendip)
  {
    Show_error(item,"<%GetString("Lan","29");%>");
    return false;
  }
  
  return true;
}

function ipBig(ip1,ip2)
{
	var start, end;
	var startip, endip;
	start=ip1.split('.');
	startip=Math.pow(255,3)*(parseInt(start[0],10))+Math.pow(255,2)*(parseInt(start[1],10))+255*(parseInt(start[2],10))+(parseInt(start[3],10));
 	end=ip2.split('.');
 	endip=Math.pow(255,3)*(parseInt(end[0],10))+Math.pow(255,2)*(parseInt(end[1],10))+255*(parseInt(end[2],10))+(parseInt(end[3],10));
	
	if (parseInt(startip,10)>parseInt(endip,10))//ip1 > ip2
		return true;
	else //if ip1<=ip2
		return false;
}

function checkDHCPRange()
{
  var lanip=ip_normalize_0(document.nosave_form.LanIPAddr.value);
	var lanmask=document.nosave_form.LanNetmask.options[document.nosave_form.LanNetmask.selectedIndex].value;
	var dhcpstartip=ip_normalize_0(document.nosave_form.DHCPSIPStart.value);
	var dhcpendip=document.getElementById("id_DHCPSIPEnd").value;
	var dhcpendipnum_3,dhcpendipnum_2;
	var item="<%GetString("Lan","41");%>";
	var n1,n2;
  var n1_3,n2_3,n1_2,n2_2;
	var dhcpendip_ip;
	
	if (!check_the_same_subnet(dhcpstartip,lanip,lanmask))//start ip should be same subnetmask wuth lanip
  {
    Show_error(item,"<%GetString("Lan","28");%>");
    return false;
  }
  
  n1=dhcpstartip.split('.');
  n2=lanip.split('.');
  n1_3=parseInt(n1[3],10);//start ip
  n2_3=parseInt(n2[3],10);//lan ip
  dhcpendipnum_3=parseInt(dhcpendip,10)+n1_3-1;//start+end-1
  
  if (n1[2]==n2[2])
  {
    dhcpendip_ip=n1[0]+"."+n1[1]+"."+n1[2]+"."+dhcpendipnum_3.toString();
    
    if (dhcpendipnum_3>255)
    {
      dhcpendipnum_3=dhcpendipnum_3-255;
      dhcpendipnum_2=parseInt(n1[2],10)+1;
      dhcpendip_ip=n1[0]+"."+n1[1]+"."+dhcpendipnum_2.toString()+"."+dhcpendipnum_3.toString();
    }
    if (!check_the_same_subnet(dhcpendip_ip,lanip,lanmask))//end ip should be same subnetmask with lanip
    {
      Show_error(item,"<%GetString("Lan","28");%>");
      return false;
    }
    if (!ipBig(dhcpstartip,lanip) && !ipBig(lanip,dhcpendip_ip))//can't include lanip
    {
      Show_error(item,"<%GetString("Lan","42");%>");
      return false;
    }
  }
  else //if (n1[2]!=n2[2])
  {
    dhcpendipnum_3=dhcpendipnum_3-255;
    dhcpendipnum_2=parseInt(n1[2],10)+1;
    dhcpendip_ip=n1[0]+"."+n1[1]+"."+dhcpendipnum_2.toString()+"."+dhcpendipnum_3.toString();
    
    if (!check_the_same_subnet(dhcpendip_ip,lanip,lanmask))//end ip should be same subnetmask with lanip
    {
      Show_error(item,"<%GetString("Lan","28");%>");
      return false;
    }
    if (!ipBig(dhcpstartip,lanip) && !ipBig(lanip,dhcpendip_ip))//can't include lanip  if(dhcpstartip <= lanip <= dhcpendip)
    {
      Show_error(item,"<%GetString("Lan","42");%>");
      return false;
    }
  }    
  //---------------------------add 0423
   var d_mask=turnCIDRMask(lanmask);
   var FirstIP=NetworkIP(ip2long(lanip), d_mask);
   var LastIP=BrocastIP(FirstIP, d_mask);
   var _BrocastIP=long2ip(LastIP);   
  if (dhcpstartip==_BrocastIP)
  {
    Show_error(item,"<%GetString("Lan","46");%>");
    return false;
  }
  //---------------------------add 0423 end
  //alert(lanip+" : "+lanmask+" : "+dhcpstartip+" : "+dhcpendip_ip+" : "+dhcpendip);
  if(!checkbroadcast(lanip,lanmask,dhcpstartip,dhcpendip_ip,dhcpendip))
  {
      Show_error(item,"<%GetString("Lan","28");%>");
      return false;
  }
  document.nosave_form.DHCPSIPEnd.value=dhcpendip_ip;//set hidden dhcp end ip

  return true;
}

function checkDomainValue()
{
  var domain=document.nosave_form.DHCPSDomainName.value;
  var domain_s=domain.split('.');

  /*
  if(domain_s[0].length<=2)
  {
	Show_error("<%GetString("Lan","43");%>","<%GetString("Lan","44");%>");	
	return false;
  }
  */
 
  for (i=0; i<domain.length; i++)
	{
		var c;
			
		c=domain.charAt(i);
		
		if (((c>='0')&&(c<='9')) || ((c>='a')&&(c<='z')) || ((c>='A')&&(c<='Z')) || (c=='.') || (c=='-'))
		{
			continue;
		}
		else
		{
		  Show_error("<%GetString("Lan","43");%>","<%GetString("Lan","36");%>");
			return false;
		}
	}
	
	if ((domain.charAt(0)=='-')||(domain.charAt(0)=='.') ||(domain.charAt(domain.length-1)=='-') ||(domain.charAt(domain.length-1)=='.'))
	{
		Show_error("<%GetString("Lan","43");%>","<%GetString("Lan","44");%>");
		return false;		
	}
	if( domain.match('.') || domain.match('-'))
	{
		var i;
		for ( i=0;i<domain.length;i++)
		{
			if ((domain.charAt(i)=='.') && (domain.charAt(i+1)=='.'))
			{
				Show_error("<%GetString("Lan","43");%>","<%GetString("Lan","36");%>");
				return false;
			}
			if ((domain.charAt(i)=='-') && (domain.charAt(i+1)=='.'))
			{
				Show_error("<%GetString("Lan","43");%>","<%GetString("Lan","36");%>");
				return false;
			}
			if((domain.charAt(i)=='.') && (domain.charAt(i+1)=='-'))
			{
				Show_error("<%GetString("Lan","43");%>","<%GetString("Lan","36");%>");
				return false;
			}
		}		
	}
	return true;
}

function ip2long(ip)
{
    var ips = ip.split('.');
    var iplong = 0;
    iplong = ips[0]*Math.pow(256,3)+ips[1]*Math.pow(256,2)+ips[2]*Math.pow(256,1)+ips[3]*Math.pow(256,0)
    return iplong;
}

function long2ip(l) 
{
    var ip1 = Math.floor(l/Math.pow(256,3));
    var ip2 = Math.floor((l%Math.pow(256,3))/Math.pow(256,2));
    var ip3 = Math.floor(((l%Math.pow(256,3))%Math.pow(256,2))/Math.pow(256,1));
    var ip4 = Math.floor((((l%Math.pow(256,3))%Math.pow(256,2))%Math.pow(256,1))/Math.pow(256,0));
    return ip1 + '.' + ip2 + '.' + ip3 + '.' + ip4;
}

function NetworkIP(ip, mask)
{
    return ip - (ip & (Math.pow(2, 32-mask)-1)) ;
}

function BrocastIP(ip, mask) 
{
    return ip + (Math.pow(2, (32 - mask))-1);
}

function turnCIDRMask(mask) 
{
    var masks = mask.split('.');
    var count=0;
    var i,j;
    var tmp;
    for(i=0;i<=3;i++)
    {
        tmp=parseInt(masks[i],10);         
        tmp=tmp.toString(2);
        for(j=0;j<=8;j++)
        {
            if(tmp.charAt(j)=="1")
            count+=1;
        }
    }
    return count;
}

function checkIsNetworkBroadcast(ip,netmask,netmaskindex,item)
{

    var mask=turnCIDRMask(netmask);
    var FirstIP=NetworkIP(ip2long(ip), mask);
    var LastIP=BrocastIP(FirstIP, mask);
    var _NetworkIP=long2ip(FirstIP);
    var _BrocastIP=long2ip(LastIP);
    var _Mask=long2ip(((Math.pow(2, 32)-1) - (Math.pow(2, (32-mask))-1)));
    var flag_network_fail=0,flag_broadcast_fail=0;

    //alert("[_NetworkIP:"+_NetworkIP+"][_BrocastIP:"+_BrocastIP+"][sMask:"+_Mask+"]");
    if(ip==_NetworkIP)
        flag_network_fail=1;
    if(ip==_BrocastIP)
        flag_broadcast_fail=1;
        
    if(flag_network_fail==1)
    {
        Show_error(item,"<%GetString("Lan","45");%>");
            return false;	
    }
    if (flag_broadcast_fail==1)
    {
        Show_error(item,"<%GetString("Lan","46");%>");
        return false;
    }
      
      return true;
}

function checkItem()
{
  var lanipbefore="<%NvramGet("LanIPAddr");%>";
  var netmaskbefore="<%NvramGet("LanNetmask");%>";
  var DHCPSIPStartbefore="<%NvramGet("DHCPSIPStart");%>";
  var DHCPSMaxUserbefore="<%NvramGet("DHCPSMaxUser");%>";
  var DHCPSExcludedIPAllbefore="<%NvramGet("DHCPSExcludedIPAll");%>";
  var UnIPIPAddrbefore="<%NvramGet("UnIPIPAddr");%>";
  var UnIPNetmaskbefore="<%NvramGet("UnIPNetmask");%>";
  var lanipafter=document.nosave_form.LanIPAddr.value;
  var netmaskafter=document.nosave_form.LanNetmask.options[document.nosave_form.LanNetmask.selectedIndex].value;
  var DHCPSIPStartafter=document.nosave_form.DHCPSIPStart.value;
  var DHCPSMaxUserafter=document.nosave_form.DHCPSMaxUser.value;
  var DHCPSExcludedIPAllafter=document.nosave_form.DHCPSExcludedIPAll.value;
  var UnIPIPAddrafter=document.nosave_form.UnIPIPAddr.value;
  var UnIPNetmaskafter=document.nosave_form.UnIPNetmask.options[document.nosave_form.UnIPNetmask.selectedIndex].value;
  
  
  if (lanipbefore==lanipafter && DHCPSIPStartbefore==DHCPSIPStartafter && DHCPSMaxUserbefore==DHCPSMaxUserafter
  && DHCPSExcludedIPAllbefore==DHCPSExcludedIPAllafter && UnIPIPAddrbefore==UnIPIPAddrafter && UnIPNetmaskbefore==UnIPNetmaskafter)
  {
  	document.getElementById("id_editlanflag").value=4;
//    document.nosave_form.submit();
    YAHOO.util.Connect.setForm('nosave_form'); 
    YAHOO.util.Connect.asyncRequest('POST','lan.html'+'?timestampt='+new Date().toString(),oCallback); 

  }
  else
  {
    document.getElementById("content").style.display = "none";
    document.getElementById("confirm").style.display = "";
  }
}

function goBack()
{
  	document.getElementById("content").style.display = "";
	document.getElementById("confirm").style.display = "none";
	document.getElementById("id_errtbl").style.display = "none";
}

function apply()
{
  document.getElementById("id_editlanflag").value=2;
  document.nosave_form.LanIPAddr.value = ip_normalize_0(document.nosave_form.LanIPAddr.value);
  document.nosave_form.DHCPSDefaultGW.value = ip_normalize_0(document.nosave_form.DHCPSDefaultGW.value);
  document.nosave_form.DHCPSDNSServer1.value = ip_normalize_0(document.nosave_form.DHCPSDNSServer1.value);
  document.nosave_form.DHCPSDNSServer2.value = ip_normalize_0(document.nosave_form.DHCPSDNSServer2.value);
  document.nosave_form.DHCPSWINSServer.value = ip_normalize_0(document.nosave_form.DHCPSWINSServer.value);
  document.nosave_form.UnIPIPAddr.value = ip_normalize_0(document.nosave_form.UnIPIPAddr.value);
  
  document.nosave_form.submit();
//    YAHOO.util.Connect.setForm('nosave_form'); 
//    YAHOO.util.Connect.asyncRequest('POST','lan.html'+'?timestampt='+new Date().toString(),oCallback); 
}

function setLan()
{
  var lanmask=document.nosave_form.LanNetmask.options[document.nosave_form.LanNetmask.selectedIndex].value;
  var lanunnummask=document.nosave_form.UnIPNetmask.options[document.nosave_form.UnIPNetmask.selectedIndex].value;
  var lanip=document.nosave_form.LanIPAddr.value;
	var lanmask=document.nosave_form.LanNetmask.options[document.nosave_form.LanNetmask.selectedIndex].value;
  if (isEmpty(document.nosave_form.LanIPAddr.value))
  {
    Show_error("<%GetString("Lan","47");%>","<%GetString("Lan","38");%>");
    return false;
  }
  if (!check_ip_format(document.nosave_form.LanIPAddr.value,"<%GetString("Lan","47");%>","lanip",lanmask))//checkip(LAN Side IP Address)
  {
    return false;
  }
  if (document.nosave_form.UnIPIPAddr.value.length != 0)
  {
	if (!check_ip_format(document.nosave_form.UnIPIPAddr.value,"<%GetString("Lan","47");%>","unnumip",lanunnummask))
	{
		return false;
	}
	if (document.nosave_form.UnIPIPAddr.value == document.nosave_form.LanIPAddr.value)
	{
		Show_error("<%GetString("NewUI","295");%>","<%GetString("NewUI","296");%>");
		return false;
	}
  }
  if (!checkIsNetworkBroadcast(document.nosave_form.LanIPAddr.value,lanmask,document.nosave_form.LanNetmask.selectedIndex,"<%GetString("Lan","47");%>"))
  {
    return false;
  }
  if ("<%NvramGet("GuestPortManualIP");%>" == document.nosave_form.LanIPAddr.value && "<%NvramGet("GuestPortAuto");%>" == "0" )
  {
	Show_error("<%GetString("Lan","72");%>","<%GetString("Lan","73");%>");
	return false;
  }
  
  if (document.getElementById("id_DHCPSEnable").checked==true)//if(DHCP Server Function checked)
  {
    if (isEmpty(document.nosave_form.DHCPSIPStart.value))
    {
      Show_error("<%GetString("Lan","41");%>","<%GetString("Lan","38");%>");
      return false;
    }
    if (!check_ip_format(document.nosave_form.DHCPSIPStart.value,"<%GetString("Lan","41");%>",""))//checkip(dhcp ip start)  can't include lanip
    {
      return false;
    }
    
    if (isEmpty(document.getElementById("id_DHCPSIPEnd").value))//checkint(dhcp ip end)  1-256
    {
      Show_error("<%GetString("Lan","48");%>","<%GetString("Lan","38");%>");
      return false;
    }
    else if (!check_integer(document.getElementById("id_DHCPSIPEnd").value))
    {
      Show_error("<%GetString("Lan","48");%>","<%GetString("Lan","36");%>");
      return false;
    }
    else if (parseInt(document.getElementById("id_DHCPSIPEnd").value,10)<1)
    {
      Show_error("<%GetString("Lan","48");%>","<%GetString("Lan","49");%>");
      return false;
    }
    else if (parseInt(document.getElementById("id_DHCPSIPEnd").value,10)>256)
    {
      Show_error("<%GetString("Lan","48");%>","<%GetString("Lan","50");%>");
      return false;
    }
    
    if (!checkDHCPRange())
    {
      return false;
    }
    
    if (!isEmpty(document.nosave_form.DHCPSExcludedIPAll.value))
    {
      if (!checkExcludeIP())
      {
        return false;
      }
    }
    
    if (isEmpty(document.getElementById("dhcpleasetime").value))//checkint(Lease Period)  1-999
    {
      Show_error("<%GetString("Lan","51");%>","<%GetString("Lan","38");%>");
      return false;
    }
    else if (!check_integer(document.getElementById("dhcpleasetime").value))
    {
      Show_error("<%GetString("Lan","51");%>","<%GetString("Lan","36");%>");
      return false;
    }
    else if (parseInt(document.getElementById("dhcpleasetime").value,10)<1)
    {
      Show_error("<%GetString("Lan","51");%>","<%GetString("Lan","49");%>");
      return false;
    }
    
    leasetime=parseInt(document.getElementById("dhcpleasetime").value,10)*3600;
    document.nosave_form.DHCPSLeaseTime.value=leasetime.toString(10);
    
    if (document.nosave_form.DHCPSDefaultGWStatus[1].checked==true)//if (Default Gateway select)
    {
      if (isEmpty(document.nosave_form.DHCPSDefaultGW.value))//ip can't empty
      {
        Show_error("<%GetString("Lan","52");%>","<%GetString("Lan","38");%>");
        return false;
      }
      if (!check_ip_format(document.nosave_form.DHCPSDefaultGW.value,"<%GetString("Lan","52");%>","defaultgw"))//checkip(Default Gateway ip)  check same sunetmask
      {
        return false;
      }
    }
    
    if (document.nosave_form.DHCPSDNSServerStatus[1].checked==true)//if (DNS Servers select)
    {
      if (isEmpty(document.nosave_form.DHCPSDNSServer1.value))//Primary ip can't empty
      {
        Show_error("<%GetString("Lan","53");%>","<%GetString("Lan","38");%>");
        return false;
      }
      if (!check_ip_format(document.nosave_form.DHCPSDNSServer1.value,"<%GetString("Lan","53");%>",""))//checkip(ip)
      {
        return false;
      }
      if (!isEmpty(document.nosave_form.DHCPSDNSServer2.value))//if(secondary ip not emptry)
      {
          if (!check_ip_format(document.nosave_form.DHCPSDNSServer2.value,"<%GetString("Lan","54");%>",""))//checkip(secondary ip)
          {
            return false;
          }
      }
      if (document.nosave_form.DHCPSDNSServer1.value==document.nosave_form.DHCPSDNSServer2.value)//Primary can't same with secondary
      {
        Show_error("<%GetString("Lan","54");%>","<%GetString("Lan","55");%>");
        return false;
      }
      if (isEmpty(document.nosave_form.DHCPSDNSServer1.value) && !isEmpty(document.nosave_form.DHCPSDNSServer2.value))//if secondary not empty, Primary can't empty 
      {
        Show_error("<%GetString("Lan","53");%>","<%GetString("Lan","56");%>");
        return false;
      }
      if (check_subnet(lanip,document.nosave_form.DHCPSDNSServer1.value,lanmask))
      {
        Show_error("<%GetString("Lan","53");%>","<%GetString("Lan","70");%>");
        return false;
      }
      if (check_broadcast(lanip,document.nosave_form.DHCPSDNSServer1.value,lanmask))
      {
        Show_error("<%GetString("Lan","53");%>","<%GetString("Lan","71");%>");
        return false;
      }
      if (check_subnet(lanip,document.nosave_form.DHCPSDNSServer2.value,lanmask))
      {
        Show_error("<%GetString("Lan","54");%>","<%GetString("Lan","70");%>");
        return false;
      }
      if (check_broadcast(lanip,document.nosave_form.DHCPSDNSServer2.value,lanmask))
      {
        Show_error("<%GetString("Lan","54");%>","<%GetString("Lan","71");%>");
        return false;
      }
    }
    
    if (document.nosave_form.DHCPSWINSServerStatus[1].checked==true)//if (WINS Serverselect)
    {
      if (isEmpty(document.nosave_form.DHCPSWINSServer.value))//ip can't empty
      {
        Show_error("<%GetString("Lan","57");%>","<%GetString("Lan","38");%>");
        return false;
      }
      if (!check_ip_format(document.nosave_form.DHCPSWINSServer.value,"<%GetString("Lan","57");%>",""))//checkip(ip)
      {
        return false;
      }
      if (check_subnet(lanip,document.nosave_form.DHCPSWINSServer.value,lanmask))
      {
        Show_error("<%GetString("Lan","57");%>","<%GetString("Lan","70");%>");
        return false;
      }
      if (check_broadcast(lanip,document.nosave_form.DHCPSWINSServer.value,lanmask))
      {
        Show_error("<%GetString("Lan","57");%>","<%GetString("Lan","71");%>");
        return false;
      }
    }
    
    if (document.nosave_form.DHCPSDomainNameStatus[1].checked==true)//if (Domain Name selsct)
    {
      if (isEmpty(document.nosave_form.DHCPSDomainName.value))//name can't empty
      {
        Show_error("<%GetString("Lan","43");%>","<%GetString("Lan","38");%>");
        return false;
      }
      if (!checkDomainValue())//name should be latter number - .   - and . can't be first one and last one
      {
        return false;
      }
    }
  }
  
  checkItem();
}

// -->
</script>
</head>
<body id="id_main" class="BFK_BODY" onLoad="InitForms();" style="display:none;">
<br>

<form name="nosave_form" method="POST">
<input type="hidden" id="id_editlanflag" name="nosave_lanRestartFlag" value="0">
<div id="content">
<div id="id_errtbl" class="C_ERR" style="display:none;"></div>
  <table class="AD_SET">
    <tbody>
    <tr>
      <th><%GetString("Lan","1");%></th>
      <td>
        <table>
          <tr>
            <td><%GetString("Lan","2");%></td>
            <td>
              <input type="text" name="LanIPAddr" size="20" maxlength="15" value="<%NvramGet("LanIPAddr");%>">
            </td>
          </tr>
          <tr>
            <td><%GetString("Lan","3");%></td>
            <td><select size="1" name="LanNetmask">
       		<option value="255.255.255.252" <%NvramMatch("LanNetmask", "255.255.255.252", "selected");%>>255.255.255.252</option>
<option value="255.255.255.248" <%NvramMatch("LanNetmask", "255.255.255.248", "selected");%>>255.255.255.248</option>
<option value="255.255.255.240" <%NvramMatch("LanNetmask", "255.255.255.240", "selected");%>>255.255.255.240</option>
<option value="255.255.255.224" <%NvramMatch("LanNetmask", "255.255.255.224", "selected");%>>255.255.255.224</option>
<option value="255.255.255.192" <%NvramMatch("LanNetmask", "255.255.255.192", "selected");%>>255.255.255.192</option>
<option value="255.255.255.128" <%NvramMatch("LanNetmask", "255.255.255.128", "selected");%>>255.255.255.128</option>
<option value="255.255.255.0" <%NvramMatch("LanNetmask", "255.255.255.0", "selected");%>>255.255.255.0</option>
<option value="255.255.254.0" <%NvramMatch("LanNetmask", "255.255.254.0", "selected");%>>255.255.254.0</option>
<option value="255.255.252.0" <%NvramMatch("LanNetmask", "255.255.252.0", "selected");%>>255.255.252.0</option>
<option value="255.255.248.0" <%NvramMatch("LanNetmask", "255.255.248.0", "selected");%>>255.255.248.0</option>
<option value="255.255.240.0" <%NvramMatch("LanNetmask", "255.255.240.0", "selected");%>>255.255.240.0</option>
<option value="255.255.224.0" <%NvramMatch("LanNetmask", "255.255.224.0", "selected");%>>255.255.224.0</option>
<option value="255.255.192.0" <%NvramMatch("LanNetmask", "255.255.192.0", "selected");%>>255.255.192.0</option>
<option value="255.255.128.0" <%NvramMatch("LanNetmask", "255.255.128.0", "selected");%>>255.255.128.0</option>
<option value="255.255.0.0" <%NvramMatch("LanNetmask", "255.255.0.0", "selected");%>>255.255.0.0</option>
<option value="255.254.0.0" <%NvramMatch("LanNetmask", "255.254.0.0", "selected");%>>255.254.0.0</option>
<option value="255.252.0.0" <%NvramMatch("LanNetmask", "255.252.0.0", "selected");%>>255.252.0.0</option>
<option value="255.248.0.0" <%NvramMatch("LanNetmask", "255.248.0.0", "selected");%>>255.248.0.0</option>
<option value="255.240.0.0" <%NvramMatch("LanNetmask", "255.240.0.0", "selected");%>>255.240.0.0</option>
<option value="255.224.0.0" <%NvramMatch("LanNetmask", "255.224.0.0", "selected");%>>255.224.0.0</option>
<option value="255.192.0.0" <%NvramMatch("LanNetmask", "255.192.0.0", "selected");%>>255.192.0.0</option>
<option value="255.128.0.0" <%NvramMatch("LanNetmask", "255.128.0.0", "selected");%>>255.128.0.0</option>
<option value="255.0.0.0" <%NvramMatch("LanNetmask", "255.0.0.0", "selected");%>>255.0.0.0</option>
<option value="254.0.0.0" <%NvramMatch("LanNetmask", "254.0.0.0", "selected");%>>254.0.0.0</option>
<option value="252.0.0.0" <%NvramMatch("LanNetmask", "252.0.0.0", "selected");%>>252.0.0.0</option>
<option value="248.0.0.0" <%NvramMatch("LanNetmask", "248.0.0.0", "selected");%>>248.0.0.0</option>
<option value="240.0.0.0" <%NvramMatch("LanNetmask", "240.0.0.0", "selected");%>>240.0.0.0</option>
<option value="224.0.0.0" <%NvramMatch("LanNetmask", "224.0.0.0", "selected");%>>224.0.0.0</option>
<option value="192.0.0.0" <%NvramMatch("LanNetmask", "192.0.0.0", "selected");%>>192.0.0.0</option>
<option value="128.0.0.0" <%NvramMatch("LanNetmask", "128.0.0.0", "selected");%>>128.0.0.0</option>     
</select>
</td>
          </tr>
        </table>
      </td>
    </tr>
        <tr>
      <th><%GetString("Lan","4");%></th>
      <td>
        <input type="checkbox" id="id_DHCPSEnable"  onClick="dhcp_sv_select();" <%NvramMatch("DHCPSEnable", "1", "checked");%>><%GetString("Lan","5");%>
        <input type="hidden" value="<%NvramGet("DHCPSEnable");%>" name="DHCPSEnable">
      </td>
    </tr>
    <tr>
      <th><%GetString("Lan","6");%></th>
      <td>
        <input type="text" name="DHCPSIPStart" size="20" maxlength="15" value="<%NvramGet("DHCPSIPStart");%>"><%GetString("Lan","7");%>
        <input type="text" name="DHCPSMaxUser" id="id_DHCPSIPEnd" size="10" maxlength="3" value=""><%GetString("Lan","8");%><br>
        <input type="hidden" value="<%NvramGet("DHCPSIPEnd");%>" name="DHCPSIPEnd">
        <%GetString("Lan","9");%>:<input type="text" name="DHCPSExcludedIPAll" size="30" maxlength="128" value="<%NvramGet("DHCPSExcludedIPAll");%>">
      </td>
    </tr>

    </tbody>
  </table>

  <table class="AD_SET">
    <tbody>
    <tr>
      <th><%GetString("Multipppoe","50");%></th>
      <td>
        <table>
          <tr>
            <td><%GetString("Lan","2");%></td>
            <td>
              <input type="text" name="UnIPIPAddr" size="20" maxlength="15" value="<%NvramGet("UnIPIPAddr");%>">
            </td>
          </tr>
          <tr>
            <td><%GetString("Lan","3");%></td>
            <td><select size="1" name="UnIPNetmask">
       		<option value="255.255.255.252" <%NvramMatch("UnIPNetmask", "255.255.255.252", "selected");%>>255.255.255.252</option>
<option value="255.255.255.248" <%NvramMatch("UnIPNetmask", "255.255.255.248", "selected");%>>255.255.255.248</option>
<option value="255.255.255.240" <%NvramMatch("UnIPNetmask", "255.255.255.240", "selected");%>>255.255.255.240</option>
<option value="255.255.255.224" <%NvramMatch("UnIPNetmask", "255.255.255.224", "selected");%>>255.255.255.224</option>
<option value="255.255.255.192" <%NvramMatch("UnIPNetmask", "255.255.255.192", "selected");%>>255.255.255.192</option>
<option value="255.255.255.128" <%NvramMatch("UnIPNetmask", "255.255.255.128", "selected");%>>255.255.255.128</option>
<option value="255.255.255.0" <%NvramMatch("UnIPNetmask", "255.255.255.0", "selected");%>>255.255.255.0</option>
<option value="255.255.254.0" <%NvramMatch("UnIPNetmask", "255.255.254.0", "selected");%>>255.255.254.0</option>
<option value="255.255.252.0" <%NvramMatch("UnIPNetmask", "255.255.252.0", "selected");%>>255.255.252.0</option>
<option value="255.255.248.0" <%NvramMatch("UnIPNetmask", "255.255.248.0", "selected");%>>255.255.248.0</option>
<option value="255.255.240.0" <%NvramMatch("UnIPNetmask", "255.255.240.0", "selected");%>>255.255.240.0</option>
<option value="255.255.224.0" <%NvramMatch("UnIPNetmask", "255.255.224.0", "selected");%>>255.255.224.0</option>
<option value="255.255.192.0" <%NvramMatch("UnIPNetmask", "255.255.192.0", "selected");%>>255.255.192.0</option>
<option value="255.255.128.0" <%NvramMatch("UnIPNetmask", "255.255.128.0", "selected");%>>255.255.128.0</option>
<option value="255.255.0.0" <%NvramMatch("UnIPNetmask", "255.255.0.0", "selected");%>>255.255.0.0</option>
<option value="255.254.0.0" <%NvramMatch("UnIPNetmask", "255.254.0.0", "selected");%>>255.254.0.0</option>
<option value="255.252.0.0" <%NvramMatch("UnIPNetmask", "255.252.0.0", "selected");%>>255.252.0.0</option>
<option value="255.248.0.0" <%NvramMatch("UnIPNetmask", "255.248.0.0", "selected");%>>255.248.0.0</option>
<option value="255.240.0.0" <%NvramMatch("UnIPNetmask", "255.240.0.0", "selected");%>>255.240.0.0</option>
<option value="255.224.0.0" <%NvramMatch("UnIPNetmask", "255.224.0.0", "selected");%>>255.224.0.0</option>
<option value="255.192.0.0" <%NvramMatch("UnIPNetmask", "255.192.0.0", "selected");%>>255.192.0.0</option>
<option value="255.128.0.0" <%NvramMatch("UnIPNetmask", "255.128.0.0", "selected");%>>255.128.0.0</option>
<option value="255.0.0.0" <%NvramMatch("UnIPNetmask", "255.0.0.0", "selected");%>>255.0.0.0</option>
<option value="254.0.0.0" <%NvramMatch("UnIPNetmask", "254.0.0.0", "selected");%>>254.0.0.0</option>
<option value="252.0.0.0" <%NvramMatch("UnIPNetmask", "252.0.0.0", "selected");%>>252.0.0.0</option>
<option value="248.0.0.0" <%NvramMatch("UnIPNetmask", "248.0.0.0", "selected");%>>248.0.0.0</option>
<option value="240.0.0.0" <%NvramMatch("UnIPNetmask", "240.0.0.0", "selected");%>>240.0.0.0</option>
<option value="224.0.0.0" <%NvramMatch("UnIPNetmask", "224.0.0.0", "selected");%>>224.0.0.0</option>
<option value="192.0.0.0" <%NvramMatch("UnIPNetmask", "192.0.0.0", "selected");%>>192.0.0.0</option>
<option value="128.0.0.0" <%NvramMatch("UnIPNetmask", "128.0.0.0", "selected");%>>128.0.0.0</option>     
</select>
</td>
          </tr>
        </table>
      </td>
    </tr>
  </table>

  <table class="AD_TTL2">
    <tbody>
    <tr><td><%GetString("Lan","10");%> </td></tr>
    </tbody>
  </table>

  <table class="AD_SET">
    <tbody>
    <tr>
      <th><%GetString("Lan","11");%></th>
      <td>
        <input type="checkbox" id="id_DHCPSAdvancedDisplay" onClick="set_display();" <%NvramMatch("DHCPSAdvancedDisplay", "1", "checked");%>><%GetString("Lan","12");%>
        <input type="hidden" value="<%NvramGet("DHCPSAdvancedDisplay");%>" name="DHCPSAdvancedDisplay">
      </td>
    </tr>
    </tbody>
  </table>

  <table class="AD_SET" id="dhcps_ext_settings" style="display:none;">
    <tbody>
    <tr>
      <th><%GetString("Lan","13");%></th>
      <td>
        <input type="text" id="dhcpleasetime" size="5" maxlength="3" value=""><%GetString("Lan","14");%>
        <input type="hidden" value="<%NvramGet("DHCPSLeaseTime");%>" name="DHCPSLeaseTime">
      </td>
    </tr>
    <tr>
      <th><%GetString("Lan","15");%></th>
      <td>
        <table>
          <tr>
            <td><input type="radio" value="0" name="DHCPSDefaultGWStatus" onClick="dhcps_ext_select();" <%NvramMatch("DHCPSDefaultGWStatus", "0", "checked");%>></td>
            <td><%GetString("Lan","16");%><br>&nbsp;&nbsp;(<%NvramGet("LanIPAddr");%>)</td>
          </tr>
          <tr>
            <td><input type="radio" value="1" name="DHCPSDefaultGWStatus" onClick="dhcps_ext_select();" <%NvramMatch("DHCPSDefaultGWStatus", "1", "checked");%>></td>
            <td><%GetString("Lan","17");%><input type="text" name="DHCPSDefaultGW" size="20" maxlength="15"	value="<%NvramGet("DHCPSDefaultGW");%>"></td>
          </tr>
          <tr>
            <td><input type="radio" value="2" name="DHCPSDefaultGWStatus" onClick="dhcps_ext_select();" <%NvramMatch("DHCPSDefaultGWStatus", "2", "checked");%>></td>
            <td><%GetString("Lan","18");%></td>
          </tr>
        </table>
      </td>
    </tr>
    <tr>
      <th><%GetString("Lan","19");%></th>
      <td>
        <table>
          <tr>
            <td><input type="radio" value="0" name="DHCPSDNSServerStatus" maxlength="15" onClick="dhcps_ext_select();" <%NvramMatch("DHCPSDNSServerStatus", "0", "checked");%>></td>
            <td colspan="2" nowrap><%GetString("Lan","16");%><br>&nbsp;&nbsp;(<%NvramGet("LanIPAddr");%>)</td>
          </tr>
          <tr>
            <td valign="top" rowspan="3" nowrap>
              <input type="radio" value="1" name="DHCPSDNSServerStatus" onClick="dhcps_ext_select();" <%NvramMatch("DHCPSDNSServerStatus", "1", "checked");%>>
            </td>
            <td colspan="2" nowrap><%GetString("Lan","17");%></td>
          </tr>
          <tr>
            <td><%GetString("Lan","20");%>:</td>
            <td><input type="text" name="DHCPSDNSServer1" size="20" maxlength="15" value="<%NvramGet("DHCPSDNSServer1");%>"></td>
          </tr>
          <tr>
            <td><%GetString("Lan","21");%>:</td>
            <td><input type="text" name="DHCPSDNSServer2" size="20" maxlength="15" value="<%NvramGet("DHCPSDNSServer2");%>"></td>
          </tr>
          <tr>
            <td><input type="radio" value="2" name="DHCPSDNSServerStatus" onClick="dhcps_ext_select();" <%NvramMatch("DHCPSDNSServerStatus", "2", "checked");%>></td>
            <td colspan="2" nowrap><%GetString("Lan","18");%></td>
          </tr>
        </table>
      </td>
    </tr>
    <tr>
      <th><%GetString("HelpNet","152");%></th>
      <td>
        <table>
          <tr>
            <td><input type="radio" value="0" name="DHCPSWINSServerStatus" onClick="dhcps_ext_select();" <%NvramMatch("DHCPSWINSServerStatus", "0", "checked");%>></td>
            <td><%GetString("Lan","58");%><br>&nbsp;&nbsp;&#x28;<%GetLanDefault("WanCurrentWINSServer");%>&#x29;</td>
          </tr>
          <tr>
            <td><input type="radio" value="1" name="DHCPSWINSServerStatus" onClick="dhcps_ext_select();" <%NvramMatch("DHCPSWINSServerStatus", "1", "checked");%>></td>
            <td><%GetString("Lan","17");%><input type="text" name="DHCPSWINSServer" size="20" maxlength="15"	value="<%NvramGet("DHCPSWINSServer");%>"></td>
          </tr>
          <tr>
            <td><input type="radio" value="2" name="DHCPSWINSServerStatus" onClick="dhcps_ext_select();" <%NvramMatch("DHCPSWINSServerStatus", "2", "checked");%>></td>
            <td><%GetString("Lan","18");%></td>
          </tr>
        </table>
      </td>
    </tr>
    <tr>
      <th><%GetString("HelpNet","154");%></th>
      <td>
        <table>
          <tr>
            <td><input type="radio" value="0" name="DHCPSDomainNameStatus" onClick="dhcps_ext_select();" <%NvramMatch("DHCPSDomainNameStatus", "0", "checked");%>></td>
            <td><%GetString("Lan","25");%><br>&nbsp;&nbsp;&#x28;<%GetLanDefault("WanCurrentDomainName");%>&#x29;</td>
          </tr>
          <tr>
            <td><input type="radio" value="1" name="DHCPSDomainNameStatus" onClick="dhcps_ext_select();" <%NvramMatch("DHCPSDomainNameStatus", "1", "checked");%>></td>
            <td><%GetString("Lan","26");%><input type="text" name="DHCPSDomainName" size="32" maxlength="64" value="<%NvramGet("DHCPSDomainName");%>"></td>
          </tr>
          <tr>
            <td><input type="radio" value="2" name="DHCPSDomainNameStatus" onClick="dhcps_ext_select();" <%NvramMatch("DHCPSDomainNameStatus", "2", "checked");%>></td>
            <td><%GetString("Lan","18");%></td>
          </tr>
        </table>
      </td>
    </tr>
    </tbody>
  </table>
  <!--<p><input type="button" value="<%GetString("Lan","27");%>" onClick="setLan();"></p>-->
  	<div class="button5" id="lan_apply" onClick="setLan();">
		<div class="button_text"><%GetString("Lan","27");%></div>
	</div>
	<br/>
	<br/>
</div>
  <!---------------------------------------->
<div id="confirm" style="display:none;">
<p>
    <div id="selectitem"></div>
</p>
<p>
<%GetString("Lan","59");%>
</p>

<div class="C_CONFIRM">
<p>
<%GetString("Lan","60");%><br>
<ol>
<%GetString("Lan","61");%>
<%GetString("Lan","62");%>
<%GetString("Lan","63");%>
</ol>
<%GetString("Lan","64");%>
</p>
</div>
     <input type="button" id="go"   value="<%GetString("Lan","27");%>" onClick="apply();">
     <input type="button" id="back" value="<%GetString("Lan","65");%>" onClick="goBack();">
</div>
<input type="hidden" name="nosave_session_num" value="<% NvramGet("session_num"); %>">
</form>
</body>
</html>
