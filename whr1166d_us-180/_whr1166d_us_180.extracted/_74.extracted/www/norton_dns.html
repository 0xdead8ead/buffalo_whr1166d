<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Cache-Control" content="no-cache">
<META http-equiv="Content-Type" content="text/html; charset=<%ChangeCharset();%>">
<link rel="stylesheet" type="text/css" href="WHR-G300N-160149-style-ENG.css">   
<link rel="stylesheet" type="text/css" href="WHR-G300N-160149-style-ad-ENG.css">
<link rel="alternate stylesheet" id="anothercss_common" type="text/css" href="/images/style-PY20-common.css">
<link rel="alternate stylesheet" id="iecss_common" type="text/css" href="/images/style-PY20-common-compatible.css">
<link rel="stylesheet" type="text/css" href="/images/style-PY20-advanced.css">
<link rel="alternate stylesheet" id="anothercss_parental" type="text/css" href="/images/style-PY20-parental.css">
<link rel="alternate stylesheet" id="iecss_parental" type="text/css" href="/images/style-PY20-parental-compatible.css">
<script language="javascript" src="common.js"></script>
<script type="text/javascript" src="/js/prototype.js"></script>
<script type="text/javascript" src="/js/py20_common.js"></script>
<script type="text/javascript" src="/js/cookiectrl.js"></script>
<script type="text/javascript" src="/js/py20_icon_popup.js"></script>
<script type="text/javascript" src="/js/py20_backalert.js"></script>
<script type="text/javascript" src="/js/py20_set_wait.js"></script>
<script type="text/javascript" src="/js/yahoo_2.0.0.js"></script>
<script type="text/javascript" src="/js/connection_2.0.0.js"></script>
<script type="text/javascript" src="/js/event_2.0.0.js"></script>

<style type="text/css">

.input_item {
	padding: 10px 0px 10px 0px;
}
.filtering {
}
	.py20_th {
		padding: 15px 0px 5px 0px;
		font-size: 17px;
	}
	.norton_all {
		width: 620px;
		padding: 10px;
		margin-bottom: 15px;
		background-color: #E3E3E3;
	}
		.norton_left {
			float: left;
			width: 465px;
		}
			.py20_td {
				font-size: 12px;
			}
			.py20_td_level {
				width: 475px;
			}
			.font_td_enable {
				color: #325174;
			}
				.level_select {
					padding: 0px 5px 10px 0px;
				}
				.level_radio {
					float: left;
				}
				.level_text {
					float: left;
					width: 440px;
					padding-top: 2px;
				}
				.level_express {
					font-size: 14px;
					margin: 0px 0px 0px 30px;
				}
				.level_description {					
					margin: 0px 0px 0px 0px;
					font-size: 11px;	
					left:50px;
				}
		.norton_right {
			width: 151px;
			height: 95px;
			float: left;
			background: url(/images/py20_banner_norton.png) no-repeat center center;
		}
		.agreement {
			clear: both;
			padding: 15px 0px 0px 0px;
		}
			.check {
				padding: 0px 0px 5px 0px;
			}
				.check_left {
					float: left;
					font-size: 14px;
				}
				.check_right {
					float: left;
					font-size: 15px;
					width: 440px;
					padding-top: 2px;
				}
			.wanwarn {
				font-size: 13px;
				color: #FF3322;
				font-weight: bold;
				padding: 0px 0px 0px 25px;
			}
			.excuse_top {
				font-size: 13px;
				padding: 0px 0px 0px 25px;
			}
			.excuse {
				font-size: 13px;
				padding: 0px 0px 0px 5px;
			}
			.parental_link {
				color: #0000FF;
				text-decoration: underline;
				cursor: pointer;
			}
			.parental_nolink {
			}

.color_a {
	color: #325174;
}

.color_b {
	color: #000000;
}
.color_disable {
	color: #AAAAAA;
}





</style>

<script language="JavaScript">
var oCallback = {
success:function(oResponse) { 
			document.getElementById("id_main").style.display = "none";
			top.document.getElementById("indicator").style.display = "";
			top.document.getElementById("waiting_err_text").style.display = "none";
			top.document.getElementById("waiting_err_btn").style.display = "none";
			top.dispWaiting(true);
			window.setTimeout("window.location.href='norton_dns.html'", 30000);
}, 
failure:function(oResponse) { 
} 
}
  <!--
  var exec = false;
   var norton_edit_num=0;
  function onceOnly(thform) {
    if(exec == true){ 
      return false;
    } else {
      exec = true;
      return true;
    } 
  }

  
  var waiting = false;
	var popupDisable = false;
	var iconDisable = false;

	var WanIP = "<%GetWanIPAddress();%>";
	var nt_agree = '<%NvramGet("Nortonagree");%>';
	
	
function change_mac_symbol(Computers_value)
{
	var mac_add = Computers_value;		
	if (mac_add.length==12)
	{							
		var str_tmp = "";			
		var str = str_tmp.concat(mac_add.substr(0,2),":",mac_add.substr(2,2),":",mac_add.substr(4,2),":",mac_add.substr(6,2),":",mac_add.substr(8,2),":",mac_add.substr(10,2));
		Computers_value = str;						
	}	
	return Computers_value;
}

function change_mac(Computers_value)
{
	var mac_add = Computers_value;		
	
	if (mac_add.charAt(2)=='-' && mac_add.charAt(5)=='-' && mac_add.charAt(8)=='-' && mac_add.charAt(11)=='-' && mac_add.charAt(14)=='-')
	{					
		var str_tmp = "";			
		var str = str_tmp.concat(mac_add.substr(0,2),":",mac_add.substr(3,2),":",mac_add.substr(6,2),":",mac_add.substr(9,2),":",mac_add.substr(12,2),":",mac_add.substr(15,2));
		Computers_value = str;
	}				
	return Computers_value;
}

function checkMZenKaKu( c ) {
        var tmp = escape( c );
        if (tmp.length == 1) {
                return false;
        }
        return (tmp.charAt(1) == 'u');
}

  
  function handleBodyOnLoad()
	{
		/*iconImgPreLoad();
		getJsonParam("DEVICE", handleDeviceParamOnComplete);
		getJsonParam("FUNCTION", handleFunctionParamOnComplete);
		updateInnerHtml();
		*/
		top.dispWaiting(false);
		//document.getElementById("id_main").style.display = "block";
		checkBrowserCssTopPage();
		checkBrowserCss();
		getIconState();
		setInterval(getIconState, 2000);		
		
		if (isNaN(WanIP.charAt(0))) //Wan Disconnect
		{
			if (nt_agree == 1)
			{	
				document.getElementById("excuse_bottom").style.display = "block";
				document.getElementById("input_agree").style.display = "none";
				document.getElementById("cb_agree").style.display = "none";
				document.getElementById("text_agree").className = "agree_disable";
				document.getElementById("wanwarn").style.display = "none";
				setRadioDisabled(false);
				//document.getElementById("id_main").style.display = "block";
				//document.getElementById("button_accept").className = "button5_disable";
				document.getElementById("excuse_top").style.display = "none";				
				document.getElementById("norton_link_top").className = "parental_nolink";
				document.getElementById("norton_link").className = "parental_nolink";
				document.getElementById("faq_link").className = "norton_word parental_nolink";
				document.getElementById("Web_exclude_apply").disabled = "disabled";
				document.getElementById("Com_exclude_apply").disabled = "disabled";
			}
			else
			{	
				document.getElementById("excuse_bottom").style.display = "none";
				document.getElementById("input_agree").style.display = "block";
				document.getElementById("cb_agree").disabled = true;
				document.getElementById("text_agree").className = "agree_disable";
				document.getElementById("wanwarn").style.display = "block";
				setRadioDisabled(true);
				//document.getElementById("id_main").style.display = "block";
				//document.getElementById("button_accept").className = "button5_disable";
				document.getElementById("norton_link_top").className = "parental_nolink";
				document.getElementById("norton_link").className = "parental_nolink";
				document.getElementById("faq_link").className = "norton_word parental_nolink";
				document.getElementById("Web_exclude_apply").disabled = "disabled";
				document.getElementById("Com_exclude_apply").disabled = "disabled";
			}
		}
		else
		{
			if (nt_agree == 1) 
			{// agree
				document.getElementById("input_agree").style.display = "none";
				document.getElementById("excuse_bottom").style.display = "block";
				setRadioDisabled(false);
				//document.getElementById("id_main").style.display = "block";
				//document.getElementById("button_accept").className = "button5";
				document.getElementById("norton_link").className = "parental_link";
				document.getElementById("faq_link").className = "norton_word parental_link";
				document.getElementById("Web_exclude_apply").disabled = false;
				document.getElementById("Com_exclude_apply").disabled = false;
			}
			else
			{// not agree
				document.getElementById("input_agree").style.display = "block";
				document.getElementById("cb_agree").disabled = false;
				document.getElementById("excuse_bottom").style.display = "none";
				document.getElementById("text_agree").className = "block";
				document.getElementById("wanwarn").style.display = "none";
				setRadioDisabled(true);
				//document.getElementById("id_main").style.display = "block";
				//document.getElementById("button_accept").className = "button5_disable";
				document.getElementById("norton_link_top").className = "parental_link";
				document.getElementById("faq_link").className = "norton_word parental_link";
				document.getElementById("Web_exclude_apply").disabled = "disabled";
				document.getElementById("Com_exclude_apply").disabled = "disabled";
			}
		}
	}

	function getJsonParam(category, handle)
	{
		new Ajax.Request("/Ajax_get_value.html&action="+category,
			{method : 'get', onComplete : handle});
	}

	function setRadioDisabled(flg)
	{
		document.getElementById("r_level3").disabled = flg;
		document.getElementById("r_level2").disabled = flg;
		document.getElementById("r_level1").disabled = flg;
		document.getElementById("r_level0").disabled = flg;
		
		document.getElementById("w_level3").className = flg ? "norton_word agree_disable" : "norton_word";
		document.getElementById("w2_level3").className = flg ? "norton_word_2 agree_disable" : "norton_word_2";
		document.getElementById("w_level2").className = flg ? "norton_word agree_disable" : "norton_word";
		document.getElementById("w2_level2").className = flg ? "norton_word_2 agree_disable" : "norton_word_2";
		document.getElementById("w_level1").className = flg ? "norton_word agree_disable" : "norton_word";
		document.getElementById("w2_level1").className = flg ? "norton_word_2 agree_disable" : "norton_word_2";
		document.getElementById("w_level0").className = flg ? "norton_word agree_disable" : "norton_word";
		document.getElementById("w2_level0").className = flg ? "norton_word_2 agree_disable" : "norton_word_2";

		if (WanIP.length > 16) //Wan Disconnect
		{
			document.getElementById("text_agree").className = flg ? "agree_disable" : "";
		}
	}

	function handleAgreeOnChange()
	{
		if(document.getElementById("cb_agree").checked)
		{// agree
			setRadioDisabled(false);
			document.getElementById("r_level1").checked = true;
			document.getElementById("r_level0").checked = false;
			//document.getElementById("button_accept").className = "button5";
			//setRadioIdx(jQuery('#r_level1').attr('value'));
		}
		else
		{// not agree
			setRadioDisabled(true);
			document.getElementById("r_level1").checked = false;
			document.getElementById("r_level0").checked = true;
			//document.getElementById("button_accept").className = "button5_disable";
			//setRadioIdx(jQuery('#r_level0').attr('value'));
		}
		setDirty(true);
	}

	function handleLinkOnClick(url)
	{
		if(document.getElementById("norton_link").className == "parental_link")
		{
			window.open(url);
		}
		else if(document.getElementById("norton_link_top").className == "parental_link")
		{
			window.open(url);
		}
	}
  
  function Websites_Computers_Excluded_Filter_Add(value)
  {
  	if(value == 1)
	{
  		document.getElementById("norton_dns_main").style.display="none";
		document.getElementById("norton_dns_Websites_Add").style.display="";
		document.getElementById("Websites_Edit_butten").style.display="none";
		document.getElementById("Websites_Edit_Cancel").style.display="none";
		document.getElementById("norton_dns_Websites_value").value="";
		document.getElementById("norton_dns_Websites_value").focus();
		document.getElementById("Edit_Excluded_Websites").style.display="none";
	}
	else if(value == 2)
	{
		document.getElementById("norton_dns_main").style.display="none";
		document.getElementById("norton_dns_Computers_Add").style.display="";
		document.getElementById("Computers_Edit_butten").style.display="none";
		document.getElementById("Computers_Edit_Cancel").style.display="none";
		document.getElementById("norton_dns_Computers_value").value="";
		document.getElementById("norton_dns_Computers_value").focus();
		document.getElementById("Edit_Exclude_Computers").style.display="none";
	}
  }
  
  function Websites_Computers_Excluded_Filter_Edit(value,num)
  {
  	if(value == 1)
	{
  		document.getElementById("norton_dns_main").style.display="none";
		document.getElementById("norton_dns_Websites_Add").style.display="";
		document.getElementById("Websites_Add_butten").style.display="none";
		document.getElementById("Websites_Add_Cancel").style.display="none";
		document.getElementById("norton_dns_Websites_value").value=document.getElementById("Websites_Excluded_Filter".concat(num.toString())).value;	
		document.getElementById("norton_dns_Websites_value").focus();
		document.getElementById("Excluded_Websites").style.display="none";	
	}
	else if(value == 2)
	{
		document.getElementById("norton_dns_main").style.display="none";
		document.getElementById("norton_dns_Computers_Add").style.display="";
		document.getElementById("Computers_Add_butten").style.display="none";
		document.getElementById("Computers_Add_Cancel").style.display="none";
		document.getElementById("norton_dns_Computers_value").value=document.getElementById("Computers_Excluded_Filter".concat(num.toString())).value;	
		document.getElementById("norton_dns_Computers_value").focus();
		document.getElementById("Exclude_Computers").style.display="none";
	}
	this.norton_edit_num=num;
  }
	
  function norton_dns_cancel()
  {
	document.getElementById("norton_dns_Websites_Add").style.display="none";
	document.getElementById("norton_dns_Computers_Add").style.display="none";
	document.getElementById("norton_dns_main").style.display="";
	document.getElementById("norton_dns_Websites_err").innerHTML = "";
	document.getElementById("norton_dns_Computers_err").innerHTML = "";
	document.getElementById("Edit_Excluded_Websites").style.display="";
	document.getElementById("Excluded_Websites").style.display="";
	document.getElementById("Edit_Exclude_Computers").style.display="";
	document.getElementById("Exclude_Computers").style.display="";
	document.getElementById("Websites_Add_butten").style.display="";
	document.getElementById("Computers_Add_butten").style.display="";
	document.getElementById("Websites_Edit_butten").style.display="";
	document.getElementById("Computers_Edit_butten").style.display="";
	document.getElementById("Websites_Edit_Cancel").style.display="";
	document.getElementById("Computers_Edit_Cancel").style.display="";
	document.getElementById("Websites_Add_Cancel").style.display="";
	document.getElementById("Computers_Add_Cancel").style.display="";
  }
  
  function norton_dns_Websites_Computers_Add(value)
  {
  	var f;
	var i=0;
	if(value == 1) //norton_dns_Websites_Add
	{
		var error_full=1;
		var f =document.getElementById("norton_dns_Websites_save");
		var Websites_value = document.getElementById("norton_dns_Websites_value").value;		
		if(check_Websites() == 0)
			return;		
		for(i=1;i<=20;i++)
		{
			var name = "Websites_Excluded_Filter".concat(i.toString());
			if(document.getElementById(name).value == "")
			{
				document.getElementById(name).value = Websites_value;
				error_full=0;
				break;
			}
		}
		
		//f.submit();
		YAHOO.util.Connect.setForm('norton_dns_Websites_save'); 
    	YAHOO.util.Connect.asyncRequest('POST','norton_dns.html'+'?timestampt='+new Date().toString(),oCallback);	
	}
	else if(value == 2) //norton_dns_Computers_Add
  	{
		var error_full=1;
		var f =document.getElementById("norton_dns_Computers_save");
		var Computers_value = document.getElementById("norton_dns_Computers_value").value.toUpperCase();
		Computers_value = change_mac(Computers_value);
		Computers_value = change_mac_symbol(Computers_value);
		if(check_Computers() == 0)
			return;	
		for(i=1;i<=20;i++)
		{
			var name = "Computers_Excluded_Filter".concat(i.toString());
			if(document.getElementById(name).value == "")
			{
				document.getElementById(name).value = Computers_value;
				error_full=0;
				break;
			}
		}
		//f.submit();
		YAHOO.util.Connect.setForm('norton_dns_Computers_save'); 
    	YAHOO.util.Connect.asyncRequest('POST','norton_dns.html'+'?timestampt='+new Date().toString(),oCallback);	
	}
  }
  
  function norton_dns_Websites_Computers_Edit(value)
  {
  	if(value == 1)
	{
		var f =document.getElementById("norton_dns_Websites_save");
  		var name = "Websites_Excluded_Filter".concat(norton_edit_num.toString());
		var Websites_value = document.getElementById("norton_dns_Websites_value").value;		
		if(check_Websites() == 0)
			return;		
		document.getElementById(name).value = Websites_value;
		//f.submit();
		YAHOO.util.Connect.setForm('norton_dns_Websites_save'); 
    	YAHOO.util.Connect.asyncRequest('POST','norton_dns.html'+'?timestampt='+new Date().toString(),oCallback);	
	}
	else if(value == 2)
	{
		var f =document.getElementById("norton_dns_Computers_save");
		var name = "Computers_Excluded_Filter".concat(norton_edit_num.toString());
		var Computers_value = document.getElementById("norton_dns_Computers_value").value.toUpperCase();
		Computers_value = change_mac(Computers_value);
		Computers_value = change_mac_symbol(Computers_value);
		if(check_Computers() == 0)
			return;	
		document.getElementById(name).value = Computers_value;
		//f.submit();
		YAHOO.util.Connect.setForm('norton_dns_Computers_save'); 
    	YAHOO.util.Connect.asyncRequest('POST','norton_dns.html'+'?timestampt='+new Date().toString(),oCallback);
	}
  }
  
  function norton_dns_Websites_Computers_Delete(value,num)
  {
 	var i=0;
  	if(value == 1)
	{
		var f =document.getElementById("norton_dns_Websites_save");
		for(i=num;i<20;i++)
		{
			var name = "Websites_Excluded_Filter".concat(i.toString());
			var name2 = "Websites_Excluded_Filter".concat((i+1).toString());
			document.getElementById(name).value = document.getElementById(name2).value;
		}
		document.getElementById(name2).value = "";
		//f.submit();
		YAHOO.util.Connect.setForm('norton_dns_Websites_save'); 
    	YAHOO.util.Connect.asyncRequest('POST','norton_dns.html'+'?timestampt='+new Date().toString(),oCallback);
	}
	else if(value == 2)
	{
		var f =document.getElementById("norton_dns_Computers_save");
		for(i=num;i<20;i++)
		{
			var name = "Computers_Excluded_Filter".concat(i.toString());
			var name2 = "Computers_Excluded_Filter".concat((i+1).toString());
			document.getElementById(name).value = document.getElementById(name2).value;
		}
		document.getElementById(name2).value = "";
		//f.submit();
		YAHOO.util.Connect.setForm('norton_dns_Computers_save'); 
    	YAHOO.util.Connect.asyncRequest('POST','norton_dns.html'+'?timestampt='+new Date().toString(),oCallback);
	}
  }
  
  	function isIP(theIP)
	{
		var ip = theIP.split(".");
		var i;
		if(ip.length == 4 )
		{
			for(i=0;i<4;i++)
			{
				if( !(parseInt(ip[i])>=0 && parseInt(ip[i])<=255) )
				{
					return false;
				}
			}
		
		}
		else
			return false;
	
		return true;
	}
	function check_initial_zero(tmp)
	{	
		if(tmp.length>1&&tmp.charAt(0)=="0")
		{
			return true;
		}
		return false;
	}	
	function check_ip_format(ip)
	{		
		var n;
		var lanip='<%NvramGet("LanIPAddr");%>';
		var lanmask='<%NvramGet("LanNetmask");%>';
		var slash = ip.split("/");
		
		if (ip=="0.0.0.0")
		{
			check_errmsg("Websites","<%GetString("Wan","30");%>");	
			return false;
		}
		if (ip=="255.255.255.255")
		{
			check_errmsg("Websites","<%GetString("Wan","31");%>");	
			return false;
		}
		if (ip==lanip)
		{
			check_errmsg("Websites","<%GetString("Wan","32");%>");	
			return false;
		}

		if (slash.length == 2)
		{
			check_errmsg("Websites","<%GetString("Multipppoe","79");%>");
			return false;
		}

		if (!isBlank(ip))
		{
			n = ip.split('.');
			if (n.length!=4)
			{
				check_errmsg("Websites","<%GetString("Wan","33");%>");
				return false;
			}
			if(isBlank(n[0]))
			{
				check_errmsg("Websites","<%GetString("Wan","33");%>");
				return false;
			}	
			else if((isNaN(n[0]))||(n[0]<=0)||(n[0]>255)||!check_integer(n[0])||check_initial_zero(n[0])) 
			{
				check_errmsg("Websites","<%GetString("Wan","33");%>");
				return false;
			}
			else if (n[0]==127)
			{
				check_errmsg("Websites","<%GetString("Wan","34");%>");
				return false;
			}
			else if (n[0]>=224 && n[0]<=239)
			{
				check_errmsg("Websites","<%GetString("WizardFuncInet","49");%>");
				return false;
			}	
			else if (n[0]>=240 && n[0]<=255)
			{
				check_errmsg("Websites","<%GetString("Wan","35");%>");
				return false;
			}	
			if(isBlank(n[1]))
			{
				check_errmsg("Websites","<%GetString("Wan","33");%>");
				return false;
			}			
			else if((isNaN(n[1]))||(n[1]<0)||(n[1]>255)||!check_integer(n[1])||check_initial_zero(n[1])) 
			{
				check_errmsg("Websites","<%GetString("Wan","33");%>");
				return false;
			}
			if(isBlank(n[2]))
			{
				check_errmsg("Websites","<%GetString("Wan","33");%>");
				return false;
			}
			else if((isNaN(n[2]))||(n[2]<0)||(n[2]>255)||!check_integer(n[2])||check_initial_zero(n[2])) 
			{
				check_errmsg("Websites","<%GetString("Wan","33");%>");
				return false; 
			}

			if(isBlank(n[3]))
			{
				check_errmsg("Websites","<%GetString("Wan","33");%>");
				return false;
			}
			else if((isNaN(n[3]))||(n[3]<0)||(n[3]>255)||!check_integer(n[3])||check_initial_zero(n[3])) 
			{
				check_errmsg("Websites","<%GetString("Wan","33");%>");
				return false;
			}
		}
		return true;
	}
  function check_errmsg(name,errmsg)
  {
  	if(name=="Websites") //"<hr><p>Error:Excluded websites<br>Not configured.</p><hr>";
	{
		document.getElementById("norton_dns_Websites_err").innerHTML = "<hr><p><%GetString("Confirm","13");%><%GetString("NewUI","215");%><br>"+errmsg+"</p><hr>";
	}
	if(name=="Computers")
	{
		document.getElementById("norton_dns_Computers_err").innerHTML = "<hr><p><%GetString("Confirm","13");%><%GetString("NewUI","204");%><br>"+errmsg+"</p><hr>";
	}
  }
  function check_Websites()
  {
  	var i=0;
  	var Websites_value = document.getElementById("norton_dns_Websites_value").value;
	if(Websites_value == "")
	{
		//Not configured.
		check_errmsg("Websites","<%GetString("NewUI","281");%>");	
		return 0;
	}
	if(!Escape_String(Websites_value))
	{
		//Invalid character.
		check_errmsg("Websites","<%GetString("WDS","18");%>");	
		return 0;			
	}
	{
		var slash = Websites_value.split("/");
		if (slash.length == 2)
		{
			check_errmsg("Websites","<%GetString("Ntp","16");%>");
			return 0;
		}
		else if(slash.length ==1)
		{
			if(isIP(Websites_value)) //ip
			{
				if (!check_ip_format(Websites_value))
				{
					return 0;
				}
			}
			else //string
			{
				//part 1 reject sting 23~51
				var reject_string=" !\"#$%&'()+,/:;<=>?@[\\]^_`{|}~";
				for(var j=0;j<reject_string.length;j++)
				{
					for(var i=0;i<Websites_value.length;i++)
					{
						if(Websites_value.charAt(i) == reject_string.charAt(j))
				 		{
							check_errmsg("Websites","<%GetString("WDS","18");%>");
				 			return 0;
						}
					}
				}
				//part 2 reject string 52~60
				for(var i=0;i<Websites_value.length;i++)
				{
					if(Websites_value.charAt(i)=='.')
					{
						if(i-1>=0 && Websites_value.charAt(i-1)=='-')
						{
							check_errmsg("Websites","<%GetString("Ntp","16");%>");
				 			return 0;
						}
						if(i+1<Websites_value.length && Websites_value.charAt(i+1)=='-')
						{
							check_errmsg("Websites","<%GetString("Ntp","16");%>");
				 			return 0;
						}
					}
				}
				if(Websites_value.indexOf("..")!=-1)
				{
					check_errmsg("Websites","<%GetString("Ntp","16");%>");
				 	return 0;
				}
				var splitstring = Websites_value.split(".");
				for(var i=0;i<splitstring.length;i++)
				{
					if(splitstring[i].length>64)
					{
						check_errmsg("Websites","<%GetString("Ntp","16");%>");
						return 0;
					}
					if(splitstring[i].search("<!--")!=-1 && splitstring[i].indexOf("-->",splitstring[i].search("<!--"))!=-1)
					{
						check_errmsg("Websites","<%GetString("WDS","18");%>");
				 		return 0;
					}
					if(splitstring[i].search("/")!=-1 && splitstring[i].indexOf("/",splitstring[i].search("/"))!=-1)
					{
						check_errmsg("Websites","<%GetString("WDS","18");%>");
				 		return 0;
					}
					if(splitstring[i].search("/*")!=-1 && splitstring[i].indexOf("*/",splitstring[i].search("/*"))!=-1)
					{
						check_errmsg("Websites","<%GetString("WDS","18");%>");
				 		return 0;
					}
					if(splitstring[i].search("<html>")!=-1)
					{
						check_errmsg("Websites","<%GetString("WDS","18");%>");
				 		return 0;
					}
				}
			}
		}
		else
		{
			check_errmsg("Websites","<%GetString("Ntp","16");%>");
			return 0;
		}	
	}
	
	
	for(i=1;i<=20;i++)
	{
		var name = "Websites_Excluded_Filter".concat(i.toString());
		if(document.getElementById(name).value == Websites_value)
		{
			//"<hr><p>Error:Excluded websites<br>Already registered.</p><hr>";
			check_errmsg("Websites","<%GetString("NewUI","291");%>");
			return 0;
		}
		if(document.getElementById(name).value == "")
			return 1;
	}
	//"<hr><p>Error: Too many registered devices.</p><hr>";
	check_errmsg("Websites","<%GetString("NewUI","292");%>");
	return 0;
  }
  
  function check_mac_filter(mac,a) //Caspar modified for buffalo check error feature 20100324
{	//0:no error 1:mac length error 2:invalid character 3:mac address error 
	var i;
	var n;	
	var ff_valid=0;
	var zero_valid=0;
	var odd_valid=0;
	var valid=0;
	var odd_array="02468AaCcEe";
	
	for (i=0;i<mac.length;i++)
		if (checkMZenKaKu(mac.charAt(i)))
			return 1;
	
	if(mac.length == 17)
	{
		n = mac.split(':');

		if(n.length==6)
		{
			for (i=0;i<odd_array.length;i++)
			{
				if (n[0].charAt(1) == odd_array.charAt(i))
					odd_valid=1;
				else
					continue;	
			}

				
			for(i=0; i<6; i++)
			{
				if((isBlank(n[i]))||(!check_0Tof(n[i]))||(n[i].length != 2))
				{
					return 2;
				}
			}

			for(i=0; i<6; i++)
			{	
				if(((n[i].charAt(0)=='f')||(n[i].charAt(0)=='F'))&&((n[i].charAt(1)=='f')||(n[i].charAt(1)=='F')))
				{
					continue;
				}
				else
				{	
					ff_valid=1;	
					break;
				}
			}

			for(i=0; i<6; i++)
			{
				if((n[i].charAt(0)=='0')&&(n[i].charAt(1)=='0'))
				{
					continue;
				}
				else
				{	
					zero_valid=1;		
					break;
				}
			}

			if((ff_valid==1)&&(zero_valid==1)&&(odd_valid==1))
			{	
				return 0;
			}
			else
			{
				return 3;
			}
		}
		else
		{
			if (a==1)
				return 1;
			var str=mac;
			var str2="";
			for (i=2;i<15;i+=3)
			{			
				str2="";
				if (mac.charAt(i)=='-')
					str = str2.concat(str.slice(0,i),":",str.substr((i+1)));
			}			
			if(check_mac_filter(str,1))
				return 2;
			else
				return 3;
		}
	}
	else
	 return 1;
	
	
	return 0;
}


  
  function check_Computers()
  {
  	var Computers_value = document.getElementById("norton_dns_Computers_value").value.toUpperCase();
	Computers_value = change_mac(Computers_value);
	Computers_value = change_mac_symbol(Computers_value);
	
	if(Computers_value == "")
	{
		document.getElementById("norton_dns_Computers_err").innerHTML = "<hr><p>"+"<%GetString("NewUI","280");%>"+"<br>"+"<%GetString("NewUI","281");%>"+"<hr>"+"</p><hr>";
		return 0;
	}
	if(Computers_value.length != 17 && Computers_value.length != 12)
	{
		document.getElementById("norton_dns_Computers_err").innerHTML = "<hr><p>"+"<%GetString("NewUI","282");%>"+"<br>"+"<%GetString("NewUI","283");%>"+"<hr>"+"</p><hr>";
		return 0;
	}
	var a = check_mac_filter(Computers_value)
	if(a != 0)
	{
		if (a==1)
			document.getElementById("norton_dns_Computers_err").innerHTML = "<hr><p>"+"<%GetString("NewUI","282");%>"+"<br>"+"<%GetString("NewUI","292");%>"+"<hr>"+"</p><hr>";
		else if (a==2)
			document.getElementById("norton_dns_Computers_err").innerHTML = "<hr><p>"+"<%GetString("NewUI","282");%>"+"<br>"+"<%GetString("Dmz","12");%>"+"<hr>"+"</p><hr>";
		else if (a==3)
			document.getElementById("norton_dns_Computers_err").innerHTML = "<hr><p>"+"<%GetString("NewUI","282");%>"+"<br>"+"<%GetString("Wan","47");%>"+"<hr>"+"</p><hr>";
		return 0;
	}
	for(i=1;i<=20;i++)
	{
		var name = "Computers_Excluded_Filter".concat(i.toString());
		if(document.getElementById(name).value == Computers_value)
		{
			document.getElementById("norton_dns_Computers_err").innerHTML = "<hr><p>"+"<%GetString("NewUI","282");%>"+"<br>"+"<%GetString("NewUI","291");%>"+"<hr>"+"</p><hr>";
			return 0;
		}
		if(document.getElementById(name).value == "")
			return 1;
	}
	document.getElementById("norton_dns_Computers_err").innerHTML = "<hr><p>"+"<%GetString("NewUI","282");%>"+"<br>"+"<%GetString("NewUI","292");%>"+"<hr>"+"</p><hr>";
	return 0;
  }

  function  ConnectSafe_Filtering_Level_apply()
  {
  	var f =document.getElementById("norton_dns_main");
	
	if (document.getElementById("button_accept").className != "button5_disable")
	{
		if(document.getElementById("cb_agree").checked || '<%NvramGet("Nortonagree");%>' == '1')
		{// agree
			document.getElementById("id_Nortonagree").value = 1;
		}
		else
		{// not agree
			document.getElementById("id_Nortonagree").value = 0;
		}

		//f.submit();
		YAHOO.util.Connect.setForm('norton_dns_main'); 
    	YAHOO.util.Connect.asyncRequest('POST','norton_dns.html'+'?timestampt='+new Date().toString(),oCallback);
	}
  	//document.getElementById("ConnectSafe_Filtering_Level").value=document.getElementById("ConnectSafe_Filtering_Level_value").value;
  	
  }

	function checkBrowserCssTopPage()
	{
		var isIE = navigator.userAgent.search("MSIE") > -1;
		if(isIE){
			document.getElementById('iecss_parental').rel = 'stylesheet';
			document.getElementById('anothercss_parental').disabled = true;
		}
		else{
			document.getElementById('anothercss_parental').rel = 'stylesheet';
			document.getElementById('iecss_parental').disabled = true;
		}
	}

   -->
</script>

</head>

<body id="id_main" class="BFK_BODY" onLoad="handleBodyOnLoad();" style="display:none;">
<form id="norton_dns_main" method="POST" action="norton_dns.html">    
<div class="filtering">
	<div class="py20_th"><%GetString("NewUI","195");%></div>
	<div class="norton_all">
		<div class="norton_top"></div>
		<div class="norton_left">
			<div class="input_item" id="input_level">
				<div onClick="">
					<div class="radio_right">
					<table>
						<tr>
							<td valign="top" style="padding:4px 0 0 0;">
								<input type="radio" class="radio_left" name="ConnectSafe_Filtering_show_Level" id="r_level1" value="1" onChange="setDirty(true);" <% NvramMatch("ConnectSafe_Filtering_show_Level", "1", "checked"); %>/>
							</td>
							<td>
								<span class="norton_word" id="w_level1"><%GetString("NewUI","131");%></span>
							</td>
						</tr>
					</table>
					</div>
					<div style="clear:both"></div>
					<div class="level_express">
					<table>
						<tr>
							<td>
								<span class="level_description" id="w2_level1"><%GetString("NewUI","229");%></span>
							</td>
						</tr>
					</table>
					</div>
				</div>
				<label onClick="">
					<div class="radio_right">
					<table>
						<tr>
							<td valign="top" style="padding:4px 0 0 0;">
								<input type="radio" class="radio_left" name="ConnectSafe_Filtering_show_Level" id="r_level2" value="2" onChange="setDirty(true);" <% NvramMatch("ConnectSafe_Filtering_show_Level", "2", "checked"); %>/>
							</td>
							<td>
								<span class="norton_word" id="w_level2"><%GetString("NewUI","133");%></span>
							</td>
						</tr>
					</table>
					</div>
					<div style="clear:both"></div>
					<div class="level_express">
					<table>
						<tr>
							<td>
								<span class="level_description" id="w2_level2"><%GetString("NewUI","230");%></span>
							</td>
						</tr>
					</table>
					</div>
				</label>
				<label onClick="">
					<div class="radio_right">
					<table>
						<tr>
							<td valign="top" style="padding:4px 0 0 0;">
								<input type="radio" class="radio_left" name="ConnectSafe_Filtering_show_Level" id="r_level3" value="3" onChange="setDirty(true);" <% NvramMatch("ConnectSafe_Filtering_show_Level", "3", "checked"); %>/>
							</td>
							<td>
								<span class="norton_word" id="w_level3"><%GetString("NewUI","135");%></span>
							</td>
						</tr>
					</table>
					</div>
					<div style="clear:both"></div>
					<div class="level_express">
					<table>
						<tr>
							<td>
								<span class="level_description" id="w2_level3"><%GetString("NewUI","231");%></span>
							</td>
						</tr>
					</table>
					</div>
				</label>
				<label onClick="">
					<div class="radio_right">
					<table>
						<tr>
							<td valign="top" style="padding:4px 0 0 0;">
								<input type="radio" class="radio_left" name="ConnectSafe_Filtering_show_Level" id="r_level0" value="0" onChange="setDirty(true);" <% NvramMatch("ConnectSafe_Filtering_show_Level", "0", "checked"); %>/>
							</td>
							<td>	
								<span class="norton_word" id="w_level0"><%GetString("NewUI","137");%></span>
							</td>
						</tr>
					</table>
					</div>
					<div style="clear:both"></div>
					<div class="level_express">
					<table>
						<tr>
							<td>
								<span class="level_description" id="w2_level0"><%GetString("NewUI","232");%></span>
							</td>
						</tr>
					</table>
					</div>
				</label>
			</div>
			<div class="excuse" id="input_agree" style="display: none;">
				<label onClick="">
				<table>
					<tr class="norton_word">
						<td>
							<input type="hidden" name="Nortonagree" id="id_Nortonagree" value="<%NvramGet("Nortonagree");%>">
							<input type="checkbox" class="editbox_check" id="cb_agree" onClick="handleAgreeOnChange()">
							<span id="text_agree" class="">
								<%GetString("NewUI","139");%>
							</span>
						</td>
					</tr>
				</table>
				</label>
				<div id="wanwarn" >
				<table>
					<tr>
						<td class="wanwarn norton_word">
							<%GetString("NewUI","140");%>
						</td>
					</tr>
				</table>
				</div>
				<div class="excuse_top">
				<table>
					<tr class="norton_word">
						<td>
							<%GetString("NewUI","141");%>
							<span style="font-weight:bold">
								<%GetString("NewUI","142");%>
								<span id="norton_link_top" class="parental_nolink" onClick="handleLinkOnClick('http://go.symantec.com/connectsafe_terms')">
									<%GetString("NewUI","143");%> 
								</span>
								<%GetString("NewUI","144");%>
							</span>
						</td>
					</tr>
				</table>
				</div>
			</div>
			<div class="excuse" id="excuse_bottom" >
			<table>
				<tr class="norton_word">
					<td>
						<%GetString("NewUI","145");%>
						<span id="norton_link" class="parental_nolink" onClick="handleLinkOnClick('http://go.symantec.com/connectsafe_terms')"><%GetString("NewUI","146");%></span>
						<%GetString("NewUI","147");%>
						<br/>
					</td>
				</tr>
			</table>
			</div>

			<div class="excuse" id="faq">
			<table>
				<tr>
					<td>
						<br/>
						<span id="faq_link" class="" onClick="handleLinkOnClick('http://buffalo-tech.norton-hosting.com/')"><%GetString("NewUI","148");%></span>
						<br/>
					</td>
				</tr>
			</table>
			</div>
		</div>
		<div class="norton_right"></div>
		<div style="clear:both"></div>
	</div>
</div>

<table class="AD_TTL2">
	<tr>
		<td><%GetString("NewUI","196");%></td>
	</tr>
</table>

<%Norton_DNS_List("Websites_Excluded_Filter");%>

<p><input type="button" id ="Web_exclude_apply" value=<%GetString("NewUI","205");%> onClick="Websites_Computers_Excluded_Filter_Add(1);"></p>

<table class="AD_TTL2">
	<tr>
		<td><%GetString("NewUI","197");%></td>
	</tr>
</table>

<%Norton_DNS_List("Computers_Excluded_Filter");%>

<p><input type="button" id ="Com_exclude_apply" value=<%GetString("NewUI","206");%> onClick="Websites_Computers_Excluded_Filter_Add(2);"></p>

<div class="button5" id="button_accept" onClick="ConnectSafe_Filtering_Level_apply();">
	<div class="button_text"><%GetString("NewUI","198");%></div>
</div>
<br/>
<br/>
<input type="hidden" name="nosave_session_num" value="<% NvramGet("session_num"); %>">
</form>

<div id="norton_dns_Websites_Add" style="display:none">
	<div data-errmsg="errmsg"><div id="norton_dns_Websites_err" class="C_ERR"></div></div>
	<table class="AD_TTL2">
		<tbody>
			<tr>
				<td id="Excluded_Websites"><%GetString("NewUI","199");%></td>
				<td id="Edit_Excluded_Websites"><%GetString("NewUI","200");%></td>
			</tr>
		</tbody>
	</table>

	<table class="AD_SET">
		<thead></thead>
		<tfoot></tfoot>
		<tbody>
			<tr>
				<th><%GetString("NewUI","201");%></th>
				<td>
					<p class="form_parts">
					<input id="norton_dns_Websites_value" name="allow_domains" size="40" maxlength="255" type="text" value="">
					</p>
				</td>
			</tr>
		</tbody>
	</table>
	<input type="button" id="Websites_Add_butten" value=<%GetString("NewUI","207");%> onClick="norton_dns_Websites_Computers_Add(1);">
	<input type="button" id="Websites_Edit_butten" value=<%GetString("NewUI","208");%> onClick="norton_dns_Websites_Computers_Edit(1);">
	<input type="button" id="Websites_Add_Cancel" value=<%GetString("NewUI","209");%> onClick="norton_dns_cancel();">
	<input type="button" id="Websites_Edit_Cancel" value=<%GetString("NewUI","210");%> onClick="norton_dns_cancel();">
</div>

<div id="norton_dns_Computers_Add" style="display:none">
	<div data-errmsg="errmsg"><div id="norton_dns_Computers_err" class="C_ERR"></div></div>
	<table class="AD_TTL2">
		<tbody>
			<tr>
				<td id="Exclude_Computers"><%GetString("NewUI","202");%></td>
				<td id="Edit_Exclude_Computers"><%GetString("NewUI","203");%></td>
			</tr>
		</tbody>
	</table>

	<table class="AD_SET">
		<thead></thead>
		<tfoot></tfoot>
		<tbody>
			<tr>
				<th><%GetString("NewUI","204");%></th>
				<td>
					<p class="form_parts">
					<input id="norton_dns_Computers_value" name="allow_domains" size="40" maxlength="17" type="text" value="">
					</p>
				</td>
			</tr>
		</tbody>
	</table>
	<input type="button" id="Computers_Add_butten" value=<%GetString("NewUI","211");%> onClick="norton_dns_Websites_Computers_Add(2);">
	<input type="button" id="Computers_Edit_butten" value=<%GetString("NewUI","212");%> onClick="norton_dns_Websites_Computers_Edit(2);">
	<input type="button" id="Computers_Add_Cancel" value=<%GetString("NewUI","213");%> onClick="norton_dns_cancel();">
	<input type="button" id="Computers_Edit_Cancel" value=<%GetString("NewUI","214");%> onClick="norton_dns_cancel();">
</div>
  
<form id="norton_dns_Websites_save" onSubmit="return onceOnly(this);" method="POST" action="norton_dns.html">
	<input type="hidden" id="Websites_Excluded_Filter1" name="Websites_Excluded_Filter1" value='<%NvramGet("Websites_Excluded_Filter1");%>'>
	<input type="hidden" id="Websites_Excluded_Filter2" name="Websites_Excluded_Filter2" value='<%NvramGet("Websites_Excluded_Filter2");%>'>
	<input type="hidden" id="Websites_Excluded_Filter3" name="Websites_Excluded_Filter3" value='<%NvramGet("Websites_Excluded_Filter3");%>'>
	<input type="hidden" id="Websites_Excluded_Filter4" name="Websites_Excluded_Filter4" value='<%NvramGet("Websites_Excluded_Filter4");%>'>
	<input type="hidden" id="Websites_Excluded_Filter5" name="Websites_Excluded_Filter5" value='<%NvramGet("Websites_Excluded_Filter5");%>'>
	<input type="hidden" id="Websites_Excluded_Filter6" name="Websites_Excluded_Filter6" value='<%NvramGet("Websites_Excluded_Filter6");%>'>
	<input type="hidden" id="Websites_Excluded_Filter7" name="Websites_Excluded_Filter7" value='<%NvramGet("Websites_Excluded_Filter7");%>'>
	<input type="hidden" id="Websites_Excluded_Filter8" name="Websites_Excluded_Filter8" value='<%NvramGet("Websites_Excluded_Filter8");%>'>
	<input type="hidden" id="Websites_Excluded_Filter9" name="Websites_Excluded_Filter9" value='<%NvramGet("Websites_Excluded_Filter9");%>'>
	<input type="hidden" id="Websites_Excluded_Filter10" name="Websites_Excluded_Filter10" value='<%NvramGet("Websites_Excluded_Filter10");%>'>
	<input type="hidden" id="Websites_Excluded_Filter11" name="Websites_Excluded_Filter11" value='<%NvramGet("Websites_Excluded_Filter11");%>'>
	<input type="hidden" id="Websites_Excluded_Filter12" name="Websites_Excluded_Filter12" value='<%NvramGet("Websites_Excluded_Filter12");%>'>
	<input type="hidden" id="Websites_Excluded_Filter13" name="Websites_Excluded_Filter13" value='<%NvramGet("Websites_Excluded_Filter13");%>'>
	<input type="hidden" id="Websites_Excluded_Filter14" name="Websites_Excluded_Filter14" value='<%NvramGet("Websites_Excluded_Filter14");%>'>
	<input type="hidden" id="Websites_Excluded_Filter15" name="Websites_Excluded_Filter15" value='<%NvramGet("Websites_Excluded_Filter15");%>'>
	<input type="hidden" id="Websites_Excluded_Filter16" name="Websites_Excluded_Filter16" value='<%NvramGet("Websites_Excluded_Filter16");%>'>
	<input type="hidden" id="Websites_Excluded_Filter17" name="Websites_Excluded_Filter17" value='<%NvramGet("Websites_Excluded_Filter17");%>'>
	<input type="hidden" id="Websites_Excluded_Filter18" name="Websites_Excluded_Filter18" value='<%NvramGet("Websites_Excluded_Filter18");%>'>
	<input type="hidden" id="Websites_Excluded_Filter19" name="Websites_Excluded_Filter19" value='<%NvramGet("Websites_Excluded_Filter19");%>'>
	<input type="hidden" id="Websites_Excluded_Filter20" name="Websites_Excluded_Filter20" value='<%NvramGet("Websites_Excluded_Filter20");%>'>
	<input type="hidden" name="nosave_session_num" value="<% NvramGet("session_num"); %>">
</form> 
<form id="norton_dns_Computers_save" onSubmit="return onceOnly(this);" method="POST" action="norton_dns.html">
	<input type="hidden" id="Computers_Excluded_Filter1" name="Computers_Excluded_Filter1" value='<%NvramGet("Computers_Excluded_Filter1");%>'>
	<input type="hidden" id="Computers_Excluded_Filter2" name="Computers_Excluded_Filter2" value='<%NvramGet("Computers_Excluded_Filter2");%>'>
	<input type="hidden" id="Computers_Excluded_Filter3" name="Computers_Excluded_Filter3" value='<%NvramGet("Computers_Excluded_Filter3");%>'>
	<input type="hidden" id="Computers_Excluded_Filter4" name="Computers_Excluded_Filter4" value='<%NvramGet("Computers_Excluded_Filter4");%>'>
	<input type="hidden" id="Computers_Excluded_Filter5" name="Computers_Excluded_Filter5" value='<%NvramGet("Computers_Excluded_Filter5");%>'>
	<input type="hidden" id="Computers_Excluded_Filter6" name="Computers_Excluded_Filter6" value='<%NvramGet("Computers_Excluded_Filter6");%>'>
	<input type="hidden" id="Computers_Excluded_Filter7" name="Computers_Excluded_Filter7" value='<%NvramGet("Computers_Excluded_Filter7");%>'>
	<input type="hidden" id="Computers_Excluded_Filter8" name="Computers_Excluded_Filter8" value='<%NvramGet("Computers_Excluded_Filter8");%>'>
	<input type="hidden" id="Computers_Excluded_Filter9" name="Computers_Excluded_Filter9" value='<%NvramGet("Computers_Excluded_Filter9");%>'>
	<input type="hidden" id="Computers_Excluded_Filter10" name="Computers_Excluded_Filter10" value='<%NvramGet("Computers_Excluded_Filter10");%>'>
	<input type="hidden" id="Computers_Excluded_Filter11" name="Computers_Excluded_Filter11" value='<%NvramGet("Computers_Excluded_Filter11");%>'>
	<input type="hidden" id="Computers_Excluded_Filter12" name="Computers_Excluded_Filter12" value='<%NvramGet("Computers_Excluded_Filter12");%>'>
	<input type="hidden" id="Computers_Excluded_Filter13" name="Computers_Excluded_Filter13" value='<%NvramGet("Computers_Excluded_Filter13");%>'>
	<input type="hidden" id="Computers_Excluded_Filter14" name="Computers_Excluded_Filter14" value='<%NvramGet("Computers_Excluded_Filter14");%>'>
	<input type="hidden" id="Computers_Excluded_Filter15" name="Computers_Excluded_Filter15" value='<%NvramGet("Computers_Excluded_Filter15");%>'>
	<input type="hidden" id="Computers_Excluded_Filter16" name="Computers_Excluded_Filter16" value='<%NvramGet("Computers_Excluded_Filter16");%>'>
	<input type="hidden" id="Computers_Excluded_Filter17" name="Computers_Excluded_Filter17" value='<%NvramGet("Computers_Excluded_Filter17");%>'>
	<input type="hidden" id="Computers_Excluded_Filter18" name="Computers_Excluded_Filter18" value='<%NvramGet("Computers_Excluded_Filter18");%>'>
	<input type="hidden" id="Computers_Excluded_Filter19" name="Computers_Excluded_Filter19" value='<%NvramGet("Computers_Excluded_Filter19");%>'>
	<input type="hidden" id="Computers_Excluded_Filter20" name="Computers_Excluded_Filter20" value='<%NvramGet("Computers_Excluded_Filter20");%>'>
	<input type="hidden" name="nosave_session_num" value="<% NvramGet("session_num"); %>">
</form>  
</body>
</html>
