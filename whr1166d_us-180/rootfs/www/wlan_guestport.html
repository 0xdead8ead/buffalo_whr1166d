<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=<%ChangeCharset();%>">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Cache-Control" content="no-cache">
<meta http-equiv="Expires" content="Thu, 01 Dec 1994 16:00:00 GMT">
<META http-equiv="Content-Style-Type" content="text/css">
<LINK rel="stylesheet" href="WHR-G300N-160149-style-ENG.css" type="text/css">
<LINK rel="stylesheet" href="WHR-G300N-160149-style-ad-ENG.css" type="text/css">
<meta http-equiv="Content-Script-Type" content="text/javascript">
<script language="javascript" type="text/javascript" src="common.js"></script>
<script type="text/javascript" src="/js/yahoo_2.0.0.js"></script>
<script type="text/javascript" src="/js/connection_2.0.0.js"></script>
<script type="text/javascript" src="/js/event_2.0.0.js"></script>
<link rel="alternate stylesheet" id="anothercss_common" type="text/css" href="/images/style-PY20-common.css">
<link rel="alternate stylesheet" id="iecss_common" type="text/css" href="/images/style-PY20-common-compatible.css">

<script language="JavaScript">

var oCallback = {
success:function(oResponse) { 			
			document.getElementById("id_main").style.display = "none";
			top.document.getElementById("indicator").style.display = "";
			top.document.getElementById("waiting_err_text").style.display = "none";
			top.document.getElementById("waiting_err_btn").style.display = "none";
			top.dispWaiting(true);
//			window.setTimeout("updateInnerHtml()", 6000);
			//window.setTimeout("top.dispWaiting(false)", 20000);
			window.setTimeout("window.location.href='wlan_guestport.html'", 25000);
}, 
failure:function(oResponse) { 
//alert(oResponse.errorText); 
} 
};


var ischangeflag=0;

function isChanged()
{
  ischangeflag=1;
  SetCwinHeight();
}


function disableItem(val1,val2)
{
	document.getElementById(val1).disabled = val2;
}


function displayTR(tbl,val)
{
	var tblObj=document.getElementById("id_"+tbl+"_tbl");
	if (val)
	{
		tblObj.style.display="";
		tblObj.disabled=false;
	}
	else
	{
		tblObj.style.display="none";
		tblObj.disabled=true;
	}
}

function disableWEP(sid,val)
{
	disableItem("id_WIFIWEPKey1_S"+sid,val);
	disableItem("id_WIFIWEPKey2_S"+sid,val);
	disableItem("id_WIFIWEPKey3_S"+sid,val);
	disableItem("id_WIFIWEPKey4_S"+sid,val);
	disableItem("id_WIFIWEPKey1Type_S"+sid,val);
	disableItem("id_WIFIWEPKeyIndex"+sid+"_1",val);
	disableItem("id_WIFIWEPKeyIndex"+sid+"_2",val);
	disableItem("id_WIFIWEPKeyIndex"+sid+"_3",val);
	disableItem("id_WIFIWEPKeyIndex"+sid+"_4",val);
}

function disablePSK(sid,val)
{
	disableItem("id_WIFIWPAPSK"+sid,val);
}

function etype_change_S4()
{
	if (document.getElementById("id_WIFIAuthType4").selectedIndex==3)
	{
		if (document.getElementById("id_WIFIEncrypType4").selectedIndex)
		{
			displayTR("wep4",true);
			disableWEP("4",false);
		}
		else
		{
			displayTR("wep4",false);
			disableWEP("4",true);
		}
	}
}

function auth_change_S4()
{
  var etype = "<%NvramGet("WIFIEncrypType4");%>";//Caspar modify 20090610 for AES/TKIP information issue 
	var obj_etype = document.getElementById("id_WIFIEncrypType4");
	
	for (i=obj_etype.length-1;i>=0;i--)
  	obj_etype.remove(obj_etype.options[i]);

	switch (document.getElementById("id_WIFIAuthType4").selectedIndex){
	case 3:
		obj_etype.options[0] = new Option("<%GetString("WlanMulti","76");%>","NONE",0,(etype=="NONE")? 1:0);
		obj_etype.options[1] = new Option("<%GetString("WlanMulti","56");%>","WEP",0,(etype=="WEP")? 1:0);
		if (etype=="WEP")
		{
			displayTR("wep4",true);
			disableWEP("4",false);
		}
		else
		{
			displayTR("wep4",false);
			disableWEP("4",true);
		}
		displayTR("psk4",false);
		disablePSK("4",true);
		break;
	case 0:
		obj_etype.options[0] = new Option("<%GetString("WlanMulti","55");%>","AES",0,1);
		//obj_etype.options[0] = new Option("<%GetString("WlanMulti","52");%>","TKIPAES",0,1);
		displayTR("wep4",false);
		displayTR("psk4",true);
		disableWEP("4",true);
		disablePSK("4",false);
		break;
	case 1:
	case 2:
		//obj_etype.options[0] = new Option("<%GetString("WlanMulti","54");%>","TKIP",0,(etype=="TKIP")?1:0);//Enter 20110801
		obj_etype.options[0] = new Option("<%GetString("WlanMulti","55");%>","AES",0,(etype=="AES")?1:0);
		displayTR("wep4",false);
		displayTR("psk4",true);
		disableWEP("4",true);
		disablePSK("4",false);
		break;
	}
}

function hide_ssid()
{
	if (document.getElementById("id_usessid8").checked)
		document.getElementById("id_WIFISsid4").disabled=true;
	else
		document.getElementById("id_WIFISsid4").disabled=false;
}


function enable_gpauth(val)
{
	document.getElementById("id_usessid8").disabled=val;
	document.getElementById("id_usessid9").disabled=val;
	document.getElementById("id_WIFISsid4").disabled=val;
	document.getElementById("id_WIFIWPAPSK4").disabled=val;
	document.getElementById("id_WIFIAuthType4").disabled=val;
	document.getElementById("id_WIFIEncrypType4").disabled=val;

	var i=1;
	for (i=1;i<=4;i++)
	{
		document.getElementById("id_WIFIWEPKey" + i+ "_S4").disabled=val;
		document.getElementById("id_WIFIWEPKeyIndex4_"+i).disabled=val;
	}
	document.getElementById("id_WIFIWEPKey1Type_S4").disabled=val;
    if(val==false)
        auth_change_S4();    
}


function gpauth_enable()
{
	//check_multi_enable("gpauth");
	if (document.getElementById("id_gpauth").checked)
	{
		enable_gpauth(false);
		if (document.getElementById("id_gpauth").checked)
			hide_ssid();
	}
	else
		enable_gpauth(true);
}

function rm_DisableSSID()
{
			
		
	if (document.getElementById("id_usessid8").checked==true)
		document.getElementById("id_WIFISsid4").value="";
			
}

function initSsid()
{
	if (!document.getElementById("id_usessid8").checked)
	{
		if (document.getElementById("id_WIFISsid4").value.length==0)
			document.getElementById("id_usessid8").checked=true;
		else
			document.getElementById("id_usessid9").checked=true;
	}
	
	if (document.getElementById("id_usessid8").checked)
	{
		document.getElementById("id_WIFISsid4").disabled=true;
		document.getElementById("id_WIFISsid4").value="";
	}
	else
		document.getElementById("id_WIFISsid4").disabled=false;
		
	rm_DisableSSID();
	gpauth_enable();
}

function ChkWebKey(num)
{
	for (i=1;i<=4;i++)
	{
        var err_title="<%GetString("WlanSingle","60");%>"; //patch 20100105
		if (document.getElementById("id_WIFIWEPKey" + i+ "_S"+num).value.length==0 &&
			document.getElementById("id_WIFIWEPKeyIndex"+num+"_" + i).checked)
		{
			Show_error(err_title,"<%GetString("WlanMulti","66");%>");
			return false;
		}
		if (document.getElementById("id_WIFIWEPKey" + i+ "_S"+num).value!="******")
		{			
			var key_type = document.getElementById("id_WIFIWEPKey1Type_S"+num).value;
			var key_value=document.getElementById("id_WIFIWEPKey" + i+ "_S"+num).value;
			var key_length = 0;
			if (key_type=="A5")
				key_length = 5;
			else if (key_type=="A13")
				key_length = 13;
			else if (key_type=="H10")
				key_length = 10;
			else if (key_type=="H26")
				key_length = 26;
			if (key_value.length<key_length && key_value.length>0)
			{
				Show_error(err_title,"<%GetString("WlanMulti","67");%>");
				return false;
			}
			if (key_value.length>key_length)
			{
				Show_error(err_title,"<%GetString("WlanMulti","63");%>");
				return false;
			}
//+++Eric add to block multyple byte
			if (key_type=="A5" || key_type=="A13"){
				if (/[^\x00-\xff]/g.test(key_value)) {
					Show_error(err_title,"<%GetString("WlanMulti","61");%>");
					return false;
				}
			}
//---Eric add to block multyple byte
			if (key_type=="H10" || key_type=="H26")
			{
				var j=0;
				for (j=0;j<key_value.length;j++)
				{
					if (!((key_value.charAt(j)>='a' && key_value.charAt(j)<='f')||
							(key_value.charAt(j)>='A' && key_value.charAt(j)<='F')||
							(key_value.charAt(j)>='0' && key_value.charAt(j)<='9')))
					{
						Show_error(err_title,"<%GetString("WlanMulti","61");%>");
						return false;
					}
				}
			}
			if (key_type=="H10")
			{
				if(key_value=="0000000000")
				{
					Show_error(err_title,"<%GetString("WlanMulti","73");%>");
					return false;
				}
			}
			if (key_type=="H26")
			{
				if(key_value=="00000000000000000000000000")
				{
					Show_error(err_title,"<%GetString("WlanMulti","73");%>");
					return false;
				}
			}
		}
	}
	return true;
}

function setMulti()
{
	var n=0;
// check ssid1	
	var etype = document.getElementById("id_WIFIEncrypType4").value;
	var i=1;
	if (document.getElementById("id_gpauth").checked)
	{    
		if (document.getElementById("id_usessid9").checked && 
			document.getElementById("id_WIFISsid4").value.length==0)
		{
			Show_error("<%GetString("WlanSingle","58");%>","<%GetString("WlanSingle","59");%>");
			return false;
		}
		if ((document.getElementById("id_WIFISsid4").value.length!=0)&&(document.getElementById("id_usessid9").checked))
		{
			if(!Escape_String(document.getElementById("id_WIFISsid4").value))
			{
				Show_error("<%GetString("WlanMulti","25");%>","<%GetString("WlanMulti","61");%>");
				return false;			
			}
		}
		switch (document.getElementById("id_WIFIAuthType4").selectedIndex)
		{
			case 3:
				if (etype=="WEP")
				{
					var err_title="<%GetString("WlanSingle","60");%>";
					if (!ChkWebKey("4"))
						return false;
				}
				break;
			case 0:
				if (document.getElementById("id_WIFIWPAPSK4").value!="******")
				{
					var err_title="<%GetString("WlanSingle","68");%>";
					var err_msg="";
					var key_value=document.getElementById("id_WIFIWPAPSK4").value;
					if (key_value.length<8)
						err_msg="<%GetString("WlanSingle","65");%>";
					
					if (key_value.length==64 && !check_0Tof(key_value))
						err_msg="<%GetString("WlanSingle","65");%>"+" <%GetString("WlanSingle","81");%>";
						
					var j=0;
					if (err_msg!="")
					{
						Show_error(err_title,err_msg);
						return false;
					}
				}
				else
					document.getElementById("id_WIFIWPAPSK4").disabled=true;
			case 1:
				if (document.getElementById("id_WIFIWPAPSK4").value!="******")
				{
					var err_title="<%GetString("WlanSingle","85");%>";
					var err_msg="";
					var key_value=document.getElementById("id_WIFIWPAPSK4").value;
					if (key_value.length<8)
						err_msg="<%GetString("WlanSingle","86");%>";
					
					if (key_value.length==64 && !check_0Tof(key_value))
						err_msg="<%GetString("WlanSingle","86");%>"+" <%GetString("WlanSingle","81");%>";
						
					var j=0;
					if (err_msg!="")
					{
						Show_error(err_title,err_msg);
						return false;
					}
				}
				else
					document.getElementById("id_WIFIWPAPSK4").disabled=true;
			case 2:
				if (document.getElementById("id_WIFIWPAPSK4").value!="******")
				{
					var err_title="<%GetString("WlanSingle","87");%>";
					var err_msg="";
					var key_value=document.getElementById("id_WIFIWPAPSK4").value;
					if (key_value.length<8)
						err_msg="<%GetString("WlanSingle","88");%>";
					
					if (key_value.length==64 && !check_0Tof(key_value))
						err_msg="<%GetString("WlanSingle","88");%>"+" <%GetString("WlanSingle","81");%>";
						
					var j=0;
					if (err_msg!="")
					{
						Show_error(err_title,err_msg);
						return false;
					}
				}
				else
					document.getElementById("id_WIFIWPAPSK4").disabled=true;
					
	//+++Eric add to block multyple byte
				if (/[^\x00-\xff]/g.test(key_value)) {
					Show_error(err_title,"<%GetString("WlanMulti","61");%>");
					return false;
				}
	//---Eric add to block multyple byte			

		}
			if (key_value=="******")
				document.getElementById("id_WIFIWPAPSK4").disabled=true;
			document.getElementById("id_WIFIAuthType4").disabled=false;
			document.getElementById("id_WIFIEncrypType4").disabled=false;
			//document.getElementById("id_WIFISsid4Enable").value=1;                  
    }
	//else
		//document.getElementById("id_WIFISsid4Enable").value=0;    

	return true;
}

function input_guestport()
{
	if(document.getElementById("id_gpenable").checked)
	{
		document.getElementById("id_GuestPortEnabled").value = 1;
		if(document.getElementById("id_gpauthenable").checked)
		{
			document.getElementById("id_GuestPortAuthEnabled").value = 1;
		}
		else
		{
			document.getElementById("id_GuestPortAuthEnabled").value = 0;
		}
		if(document.getElementById("id_AM0").checked)
		{
			document.getElementById("id_GuestPortAuto").value = 1;
		}
		else
		{
			document.getElementById("id_GuestPortAuto").value = 0;
			document.getElementById("id_GuestPortManualIP").value = document.getElementById("id_ip").value;
			document.getElementById("id_GuestPortManualMask").value = document.getElementById("id_subnet").value;
			if(document.getElementById("id_gpDHCPEnabled").checked)
			{
				document.getElementById("id_GuestPortDHCPEnabled").value=1;
			}
			else
			{
				document.getElementById("id_GuestPortDHCPEnabled").value=0;
			}
		}		
	}
	else
	{
		document.getElementById("id_GuestPortEnabled").value = 0;
	}
}

function isAllowValueIP(s,item)
{
  var i;
	for (i=0; i<s.length; i++)
	{
		var c;
		
		c=s.charAt(i);
	
		if (((c>='0')&&(c<='9')) || (c=='.'))
		{
      continue;
		}
		else
		{
			Show_error(item,"<%GetString("Lan","36");%>");
      return false;
		}
	}
	
	return true;
}

function dot2num(dot) {
var d = dot.split('.');
return ((((((+d[0])*256)+(+d[1]))*256)+(+d[2]))*256)+(+d[3]);
}

function isNetBroadAddr(ip, mask)
{

/*
	var b_ip = dot2num (ip);
	var b_mask = dot2num (mask);
	var b_wholemask = dot2num("255.255.255.255");
	if(b_ip & b_mask == b_ip)
		return true;
	if(b_ip | b_mask == b_wholemask) 
		return true;
*/
	var net_tag = 0;
	var broad_tag = 0;
	var i=0;
	var ip_partition = ip.split('.');
	var mask_partition = mask.split('.');
	
	for (i=0; i<4; i++)
	{
		if((parseInt(ip_partition[i]) & parseInt(mask_partition[i])) != parseInt(ip_partition[i]))
		{
			break;
		}
		net_tag++;
	}
	
	if(net_tag == 4)
		return true;

	for (i=0; i<4; i++)
	{
		if( (parseInt(ip_partition[i]) | parseInt(mask_partition[i])) != 255)
		{
			break;
		}
		broad_tag++;
	}	

	if(broad_tag == 4)
		return true;	
	
	return false;
}


function check_ip_format(ip, item, type,netmask)
{
	var n;
	var canNotSetTo255=0;
	var wanip="<%NvramGet("WanCurrentIP");%>";
	var wanmask="<%NvramGet("WanCurrentNetmask");%>";
	var lanip = "<%NvramGet("LanIPAddr");%>";
	var lanmask = "<%NvramGet("LanNetmask");%>";
	
	
	if (netmask)
	{
		if (netmask.length > 0)
		{
			o = netmask.split('.');
			if (o.length==4)
			{
				if (o[2]>=254)
					canNotSetTo255=1;
			}
		}
	}
	
	if(!isAllowValueIP(ip,item))
	{
    return false;
  }
  if (ip=="0.0.0.0")
  {
    Show_error(item,"<%GetString("Lan","30");%>");
    return false;
  }
  if (ip=="255.255.255.255")
  {
    Show_error(item,"<%GetString("Lan","31");%>");
    return false;
  }
  
  if (!isBlank(ip))
  {
    n = ip.split('.');
    
    if (n.length!=4)
    {
      Show_error(item,"<%GetString("Lan","33");%>");
      return false;
    }
    else
    {
      if(isBlank(n[0]))
      {
        Show_error(item,"<%GetString("Lan","33");%>");
        return false;
      }	
      //else if((isNaN(n[0]))||(n[0]<=0)||(n[0]>255)||!check_integer(n[0])||check_initial_zero(n[0])) 
	  else if((isNaN(n[0]))||(n[0]<=0)||(n[0]>255)||!check_integer(n[0])) 
      {
        Show_error(item,"<%GetString("Lan","33");%>");
        return false;
      }
      else if (n[0]==127)
      {
        Show_error(item,"<%GetString("Lan","34");%>");
        return false;
      }
	  else if (n[0]>=224 && n[0]<=239)
      {
        Show_error(item,"<%GetString("WizardFuncInet","49");%>");
        return false;
      }
      else if (n[0]>=240 && n[0]<=255)
      {
        Show_error(item,"<%GetString("Lan","35");%>");
        return false;
      }	
      
      if(isBlank(n[1]))
      {
        Show_error(item,"<%GetString("Lan","33");%>");
        return false;
      }
      //else if((isNaN(n[1]))||(n[1]<0)||(n[1]>255)||!check_integer(n[1])||check_initial_zero(n[1])) 
	  else if((isNaN(n[1]))||(n[1]<0)||(n[1]>255)||!check_integer(n[1])) 
      {
        Show_error(item,"<%GetString("Lan","33");%>");
        return false;
      }		
      
      if(isBlank(n[2]))
      {
        Show_error(item,"<%GetString("Lan","33");%>");
        return false;
      }
      //else if((isNaN(n[2]))||(n[2]<0)||(n[2]>255)||!check_integer(n[2])||check_initial_zero(n[2])) 
	  else if((isNaN(n[2]))||(n[2]<0)||(n[2]>255)||!check_integer(n[2])) 
      {
        Show_error(item,"<%GetString("Lan","33");%>");
        return false; 
      }
      
      if(isBlank(n[3]))
      {
        Show_error(item,"<%GetString("Lan","33");%>");
        return false;
      }
      //else if((isNaN(n[3]))||(n[3]<0)||(n[3]>255)||!check_integer(n[3])||check_initial_zero(n[3]))
	  else if((isNaN(n[3]))||(n[3]<0)||(n[3]>255)||!check_integer(n[3]))
      {
      	if (!(canNotSetTo255==0 && n[3]==255))
       	{
        	Show_error(item,"<%GetString("Lan","33");%>");
        	return false;
        }
      }
	  else if(n[0] != 10 && n[0] != 172 && n[0] != 192)
	  {
			Show_error(item,"<%GetString("Lan","33");%>");
			return false;
	  }
	  else if(n[0] == 172)
	  {
			if(n[1]>31 || n[1]<16)
			{
				Show_error(item,"<%GetString("Lan","33");%>");
				return false;
			}
	  }
	  else if(n[0] == 192 && n[1] != 168)
	  {
			Show_error(item,"<%GetString("Lan","33");%>");
			return false;  
	  }
	  else if(isNetBroadAddr(ip, netmask))
	  {
			Show_error(item,"<%GetString("Lan","33");%>");
			return false;
	  }
    }
    
	if (type == "Guest")
	{
		if(wanip!="" && check_the_same_subnet(wanip,ip,wanmask))
		{
		    Show_error(item,"<%GetString("Lan","69");%>");
			return false;
		}
		if(lanip!="" && check_the_same_subnet(lanip,ip,lanmask))
		{
		    Show_error(item,"<%GetString("Lan","37");%>");
			return false;
		}		
		if(lanip!="" && check_the_same_subnet(lanip,ip,netmask))
		{
		    Show_error(item,"<%GetString("Lan","37");%>");
			return false;
		}			
	}
	
	
	if (type=="lanip")
	{
		if(wanip!="" && check_the_same_subnet(wanip,ip,wanmask))
		{
		    Show_error(item,"<%GetString("Lan","69");%>");
			return false;
		}
	}
	
	
    if (type=="defaultgw")//check default getway
    {
      if (!check_the_same_subnet(lanip,ip,lanmask))
      {
        Show_error(item,"<%GetString("Lan","28");%>");
        return false;
      }
    }
  }
  else
  {
        Show_error(item,"<%GetString("Lan","33");%>");
        return false; 
  }
  return true;
}

function apply()
{
		document.getElementById("GuestPortLeaseTime").value = document.getElementById("input_TIME").value;
		var manualIP, netmask;
		if (document.getElementById("id_gpauth").checked)
		{    
            if (document.getElementById("id_WIFIWPAPSK4").value=="******")
                document.getElementById("id_WIFIWPAPSK4").disabled=true;
            //if(document.getElementById("id_WIFIAuthType0").selectedIndex==0)
            //{
                for (i=1;i<=4;i++)
                {
                    if (document.getElementById("id_WIFIWEPKey" + i+ "_S4").value=="******")
                        document.getElementById("id_WIFIWEPKey" + i+ "_S4").disabled=true;
                }
            //}            
        }

		input_guestport();
		
		manualIP = document.getElementById("id_GuestPortManualIP").value;
		netmask = document.getElementById("id_GuestPortManualMask").value;
		
		//Hide_error();
		if(document.getElementById("id_GuestPortAuto").value == 1 || check_ip_format(manualIP,"<%GetString("Guestport","8");%>" ,"Guest", netmask ))
		{
			document.getElementById("basic_content").style.display="none";
			document.getElementById("basic_confirm").style.display="none";
			document.getElementById("confirm_space").style.display="none";
			document.getElementById("confirm_64").style.display="none";
			document.getElementById("confirm_ssid").style.display="none";
			document.getElementById("id_userlist").style.display="none";
			//document.guestportForm.submit();
			YAHOO.util.Connect.setForm('guestportForm'); 
			YAHOO.util.Connect.asyncRequest('POST','wlan_guestport.html'+'?timestampt='+new Date().toString(),oCallback); 
		}
		else
			return false
			
		


}

function valtoasc(val)
{
	var str = "";
	var i;
	for (i=0;i<val.length;i++)
	{
		str = str.concat("&#");
		str = str.concat(val.charCodeAt(i));
	}	
	return str;
}

function check_dupSSID()
{
	var ssid4 = valtoasc(document.getElementById("id_WIFISsid4").value);
	var ssid1 = "<%NvramGetAdv("WIFISsid1");%>";
	//ssid1 = ssid1.replace("&quot;", "\"");
	var ssid3 = "<%NvramGetAdv("WIFISsid3");%>";
	//ssid3 = ssid3.replace("&quot;", "\"");
	var ssid1_5g = "<%NvramGetAdv("WIFISsid1_5g");%>";
	//ssid1_5g = ssid1_5g.replace("&quot;", "\"");
	var ssid3_5g = "<%NvramGetAdv("WIFISsid3_5g");%>";
	//ssid3_5g = ssid3_5g.replace("&quot;", "\"");

	/*if("<%NvramGet("WIFISsid0Enable");%>" == "1")
	{
		if(ssid4 == "<%NvramGet("WIFISsid0");%>" )
			return false;
	}
	if("<%NvramGet("WIFISsid1Enable");%>" == "1")
	{
		if(ssid4 == ssid1 )
			return false;
	}	
	if("<%NvramGet("WIFISsid3Enable");%>" == "1")
	{
		if(ssid4 == ssid3 )
			return false;
	}*/
	if (document.getElementById("id_usessid8").checked)
		ssid4 = valtoasc("<%GetMultiWMAC("4");%>");
	
	if (ssid4 == ssid1 || ssid4 ==ssid3 || ssid4 == ssid1_5g || ssid4 ==ssid3_5g)
		return false;
		
	return true;

}

function setWifi()
{
  var wpapsk4=document.getElementById("id_WIFIWPAPSK4").value;
  //var wpapsk2=document.getElementById("id_WIFIWPAPSK2").value;
  var ssid4=document.getElementById("id_WIFISsid4").value;
  
	if(check_dupSSID()==false)
	{
      	Show_error("<%GetString("WlanMulti","25");%>","<%GetString("WlanMulti","74");%>");
		return false;	
	}
  
	if (!setMulti())
	{
		if (document.getElementById("id_gpauth").checked)
		{    
		if (document.getElementById("id_WIFIWPAPSK4").value=="******")
			document.getElementById("id_WIFIWPAPSK4").disabled=false;
        }
	}
	else//Candy add 20100105
	{
	apply();


		
	}
}

function disable_guestport(val)
{
	document.getElementById("id_gpauthenable").disabled=val;
	document.getElementById("id_AM0").disabled=val;
	document.getElementById("id_AM1").disabled=val;
	document.getElementById("id_recommend_ip").disabled=val;
	document.getElementById("id_ip").disabled=val;
	document.getElementById("id_subnet").disabled=val;
	document.getElementById("id_gpDHCPEnabled").disabled=val;
}

function guestport_enable()
{
	if(document.getElementById("id_gpenable").checked==true)
	{
		disable_guestport(false);
	}
	else
	{
		disable_guestport(true);
	}
}

function guestportauto_change()
{
	if(document.getElementById("id_AM0").checked)
	{
		document.getElementById("ip").style.display="none";
		document.getElementById("dhcps_use").style.display="none";
	}
	else
	{
		document.getElementById("ip").style.display="";
		document.getElementById("dhcps_use").style.display="";
		document.getElementById("id_subnet").value=document.getElementById("id_GuestPortManualMask").value;
	}
	SetCwinHeight();
}
function init_guestport()
{
	
	top.dispWaiting(false);
	//document.getElementById("id_main").style.display = "block";
	checkBrowserCss();

//	top.frames[3].location.href = "./help/help_guest_port.html";
	guestport_enable();
/*
	if(document.getElementById("id_GuestPortAuto").value=="1")
	{
		document.getElementById("id_AM0").checked=true;
	}
	else
	{
		document.getElementById("id_AM1").checked=true;
	}
*/
	guestportauto_change();
}

function set_recommend_value()
{	
	var address_num=64;
	IntMin = 13;
	IntMax = 113;
	if(document.getElementById("id_subnet").selectedIndex==0)
	{
		address_num=1;
	}
	else if(document.getElementById("id_subnet").selectedIndex <=4 )
	{
		address_num = Math.pow(2, document.getElementById("id_subnet").selectedIndex + 1 );
	}
	
	IntRandom = Math.floor(Math.random()*(IntMax-IntMin+1))+IntMin;
	
	document.getElementById("id_ip").value = "192.168." + IntRandom + ".1" ; 
	document.getElementById("id_subnet").options[6].selected = true;
	
	if(document.getElementById("id_gpDHCPEnabled").checked== true)
	{
		document.getElementById("gp_dhcprange1").innerHTML = "192.168." + IntRandom + ".1";
		document.getElementById("gp_dhcprange2").innerHTML = " <%GetString("Guestport","12");%> "+ address_num  + " <%GetString("Guestport","13");%>";
	}
}

function initUserlist()
{
	var flag;
	flag=0;
	if("<%NvramGet("GuestPortUN1");%>"=="")
	{
		document.getElementById("id_gpuser1").style.display="none";
		flag += 1;		
	}
	if("<%NvramGet("GuestPortUN2");%>"=="")
	{
		document.getElementById("id_gpuser2").style.display="none";
		flag += 1;		
	}
	if("<%NvramGet("GuestPortUN3");%>"=="")
	{
		document.getElementById("id_gpuser3").style.display="none";
		flag += 1;		
	}
	if("<%NvramGet("GuestPortUN4");%>"=="")
	{
		document.getElementById("id_gpuser4").style.display="none";
		flag += 1;		
	}
	if("<%NvramGet("GuestPortUN5");%>"=="")
	{
		document.getElementById("id_gpuser5").style.display="none";
		flag += 1;		
	}
	if(flag < 5) 	
	{		
		document.getElementById("id_gpuser0").style.display="none";
	}	

	if("<%NvramGet("GuestPortU1On");%>"=="0")
	{
		document.getElementById("id_gpuser1").className="DISABLE"
		document.getElementById("submit_user1").value="<%GetString("NewUI","55");%>"
	}
	if("<%NvramGet("GuestPortU2On");%>"=="0")
	{
		document.getElementById("id_gpuser2").className="DISABLE"
		document.getElementById("submit_user2").value="<%GetString("NewUI","55");%>"
	}
	if("<%NvramGet("GuestPortU3On");%>"=="0")
	{
		document.getElementById("id_gpuser3").className="DISABLE"
		document.getElementById("submit_user3").value="<%GetString("NewUI","55");%>"
	}
	if("<%NvramGet("GuestPortU4On");%>"=="0")
	{
		document.getElementById("id_gpuser4").className="DISABLE"
		document.getElementById("submit_user4").value="<%GetString("NewUI","55");%>"
	}
	if("<%NvramGet("GuestPortU5On");%>"=="0")
	{
		document.getElementById("id_gpuser5").className="DISABLE"
		document.getElementById("submit_user5").value="<%GetString("NewUI","55");%>"
	}

	
}

function setLeaseTime()
{
	document.getElementById("GuestPortLeaseTime").value = document.getElementById("input_TIME").value;
}

function clear_wep(index)
{
	var i=1;
	for (i=1;i<=4;i++)
		document.getElementById("id_WIFIWEPKey" + i+ "_S"+index).value="";
}

function gpDHCP_enable()
{
	var address_num=64;
	var start_ip = "<%NvramGet("GuestPortDHCPStart");%>" ;
	/*if (start_ip == "")
		start_ip = "192.168.69.2";*/
	
	if(document.getElementById("id_subnet").selectedIndex==0)
	{
		address_num=1;
	}
	else if(document.getElementById("id_subnet").selectedIndex <=4 )
	{
		address_num = Math.pow(2, document.getElementById("id_subnet").selectedIndex + 1 );
	}
	if(document.getElementById("id_gpDHCPEnabled").checked== true)
	{
		document.getElementById("gp_dhcprange1").innerHTML = document.getElementById("id_ip").value;
		if(document.getElementById("id_ip").value!="")
		document.getElementById("gp_dhcprange2").innerHTML = " <%GetString("Guestport","12");%> " + address_num + " <%GetString("Guestport","13");%>";
	}
	else
	{
		document.getElementById("gp_dhcprange1").innerHTML = "";
		document.getElementById("gp_dhcprange2").innerHTML = "";
	}
}


/*var onSubmitClick = function(oEvent) { 	    
	    //Callback клеє 
		//alert("asd");
	    var oCallback2 = { 
	        success:function(oResponse) { 
				//alert("bbb");
	            document.getElementById("id_main").style.display = "none";
				top.document.getElementById("indicator").style.display = "";
				top.document.getElementById("waiting_err_text").style.display = "none";
				top.document.getElementById("waiting_err_btn").style.display = "none";
				top.dispWaiting(true);
//				window.setTimeout("updateInnerHtml()", 6000);
				//window.setTimeout("top.dispWaiting(false)", 10000);
				window.setTimeout("window.location.href='wsc.html'", 20000);
	        }, 
	        failure:function(oResponse) { 
				//alert("aaa");
	            //dContainer.innerHTML = oResponse.errorText; 
	        }  
	    };
	     
	    YAHOO.util.Connect.setForm('form_userlist'); 
        YAHOO.util.Connect.asyncRequest('POST','wlan_guestport.html'+'?timestampt='+new Date().toString(),oCallback2); 
	    YAHOO.util.Event.stopEvent(oEvent); 
	    return false; 
}; 
	
YAHOO.util.Event.addListener('submit','click', onSubmitClick);*/


function Submit_user(user,id)
{
	document.forms[1].detectuser.value = user;
	if(document.getElementById(id).value=="On")
		document.forms[1].detectuser.value = user+0;
	else
		document.forms[1].detectuser.value = user;
	YAHOO.util.Connect.setForm(document.forms[1]); 
	YAHOO.util.Connect.asyncRequest('POST','wlan_guestport.html'+'?timestampt='+new Date().toString(),oCallback);
	
}



</script>

<body class="BFK_BODY" onLoad="init_guestport();auth_change_S4();initSsid(); initUserlist();gpDHCP_enable();" id="id_main" style="display:none;">
<br/>
<div id="basic_content">
<div id= "id_errtbl" class="C_ERR"></div>
<form  method="POST" name="guestportForm">

<table class="AD_TTL2">
   <tr>
     <td><%GetString("Guestport","2");%></td>
   </tr>
</table>
<table class="AD_SET">
	<tr>
		<th><%GetString("Guestport","1");%></th>
		<td>
			<input type="hidden" name="GuestPortEnabled" id="id_GuestPortEnabled" value="<%NvramGet("GuestPortEnabled");%>">
			
			<input type="checkbox" id="id_gpenable" value="1" <%NvramMatch("GuestPortEnabled","1","checked");%> onClick="guestport_enable();"><%GetString("Guestport","3");%>
		</td>
	</tr>
	<tr>
		<th nowrap><%GetString("Guestport","4");%></th>
		<td>
			<input type="hidden" name="GuestPortAuthEnabled" id="id_GuestPortAuthEnabled" value="<%NvramGet("GuestPortAuthEnabled");%>">
			<input type="checkbox" id="id_gpauthenable" value="1" <%NvramMatch("GuestPortAuthEnabled","1","checked");%>><%GetString("Guestport","3");%>
		</td>
	</tr>
	<tr>
		<th nowrap><%GetString("Guestport","5");%></th>
		<td>
		<table>
		<tr>
		  <input type="hidden" name="GuestPortAuto" id="id_GuestPortAuto" value="<%NvramGet("GuestPortAuto");%>">
		  <td>
			<input type="radio" name="nosave_AutoManual" id="id_AM0" value="0" onClick="guestportauto_change();" <%NvramMatch("GuestPortAuto","1","checked");%>>
		  </td>
		  <td><%GetString("Guestport","6");%></td>
		</tr>
		<tr>
		  <td>
			<input type="radio" name="nosave_AutoManual" id="id_AM1" value="1" onClick="guestportauto_change();" <%NvramMatch("GuestPortAuto","0","checked");%>>
		  </td>
		  <td><%GetString("Guestport","7");%></td>
		</tr>
		
		
		<tr>
		<td></td>
		<td>
			<table id="ip">
				<tr><td colspan="2"><input type ="button" name="nosave_recommend_ip" id="id_recommend_ip" value="<%GetString("Guestport","10");%>" onClick="set_recommend_value();"></td></tr>
				<tr>
				  <td><%GetString("Guestport","8");%></td>
				  <td>
				  	<input type="hidden" name="GuestPortManualIP" id="id_GuestPortManualIP" value="<%NvramGet("GuestPortManualIP");%>">
					<input type="text" name="nosave_ip" id="id_ip" size="20" maxlength="15" value="<%NvramGet("GuestPortManualIP");%>">
				  </td>
				</tr>
				<tr>
				  <input type="hidden" name="GuestPortManualMask" id="id_GuestPortManualMask" value="<%NvramGet("GuestPortManualMask");%>">
				  <td><%GetString("Guestport","9");%></td>
				  <td><select size="1" name="nosave_subnet" id="id_subnet">
						<option value="255.255.255.252" >255.255.255.252</option>
						<option value="255.255.255.248" >255.255.255.248</option>
						<option value="255.255.255.240" >255.255.255.240</option>
						<option value="255.255.255.224" >255.255.255.224</option>
						<option value="255.255.255.192" >255.255.255.192</option>
						<option value="255.255.255.128" >255.255.255.128</option>
						<option value="255.255.255.0" selected>255.255.255.0</option>
						<option value="255.255.254.0" >255.255.254.0</option>
						<option value="255.255.252.0" >255.255.252.0</option>
						<option value="255.255.248.0" >255.255.248.0</option>
						<option value="255.255.240.0" >255.255.240.0</option>
						<option value="255.255.224.0" >255.255.224.0</option>
						<option value="255.255.192.0" >255.255.192.0</option>
						<option value="255.255.128.0" >255.255.128.0</option>
						<option value="255.255.0.0" >255.255.0.0</option>
						<option value="255.254.0.0" >255.254.0.0</option>
						<option value="255.252.0.0" >255.252.0.0</option>
						<option value="255.248.0.0" >255.248.0.0</option>
						<option value="255.240.0.0" >255.240.0.0</option>
						<option value="255.224.0.0" >255.224.0.0</option>
						<option value="255.192.0.0" >255.192.0.0</option>
						<option value="255.128.0.0" >255.128.0.0</option>
						<option value="255.0.0.0" >255.0.0.0</option>
						<option value="254.0.0.0" >254.0.0.0</option>
						<option value="252.0.0.0" >252.0.0.0</option>
						<option value="248.0.0.0" >248.0.0.0</option>
						<option value="240.0.0.0" >240.0.0.0</option>
						<option value="224.0.0.0" >224.0.0.0</option>
						<option value="192.0.0.0" >192.0.0.0</option>
						<option value="128.0.0.0" >128.0.0.0</option>
						</select>
				</td>
				</tr>
				</table>
				</td>
				</tr>
				
				
				
				
		</table>
		</td>
		
	
		
		
	</tr>
	
	
	
	<tr id="dhcps_use">
		<th><%GetString("Guestport","11");%></th>
		<td>
			<input type="hidden" name="GuestPortDHCPEnabled" id="id_GuestPortDHCPEnabled" value="<%NvramGet("GuestPortAuthEnabled");%>">
			<input type="checkbox" id="id_gpDHCPEnabled" value="1" <%NvramMatch("GuestPortDHCPEnabled","1","checked");%> onClick="gpDHCP_enable();"><%GetString("Guestport","3");%>  <span id="gp_dhcprange1"></span><span id="gp_dhcprange2"></span>
		</td>
	</tr>	
	
	
		<tr class="input_item">
		<th><%GetString("NewUI","44");%></th>
		<td>
			<input type="hidden" id="GuestPortLeaseTime" name="GuestPortLeaseTime" value="<%NvramGet("GuestPortLeaseTime");%>">
				<select name="input_TIME" onChange="setDirty(true);setLeaseTime();" id="input_TIME" class="editbox_select" value="10800">
				<option value="0" <%NvramMatch("GuestPortLeaseTime","0","selected");%>><%GetString("NewUI","45");%></option>
				<option value="3600" <%NvramMatch("GuestPortLeaseTime","3600","selected");%>>1 <%GetString("NewUI","46");%></option>
				<option value="7200" <%NvramMatch("GuestPortLeaseTime","7200","selected");%>>2 <%GetString("NewUI","47");%></option>
				<option value="10800" <%NvramMatch("GuestPortLeaseTime","10800","selected");%>>3 <%GetString("NewUI","47");%></option>
				<option value="14400" <%NvramMatch("GuestPortLeaseTime","14400","selected");%>>4 <%GetString("NewUI","47");%></option>
				<option value="18000" <%NvramMatch("GuestPortLeaseTime","18000","selected");%>>5 <%GetString("NewUI","47");%></option>
				<option value="21600" <%NvramMatch("GuestPortLeaseTime","21600","selected");%>>6 <%GetString("NewUI","47");%></option>
				<option value="25200" <%NvramMatch("GuestPortLeaseTime","25200","selected");%>>7 <%GetString("NewUI","47");%></option>
				<option value="28800" <%NvramMatch("GuestPortLeaseTime","28800","selected");%>>8 <%GetString("NewUI","47");%></option>
				<option value="32400" <%NvramMatch("GuestPortLeaseTime","32400","selected");%>>9 <%GetString("NewUI","47");%></option>
				<option value="36000" <%NvramMatch("GuestPortLeaseTime","36000","selected");%>>10 <%GetString("NewUI","47");%></option>
				<option value="39600" <%NvramMatch("GuestPortLeaseTime","39600","selected");%>>11 <%GetString("NewUI","47");%></option>
				<option value="43200" <%NvramMatch("GuestPortLeaseTime","43200","selected");%>>12 <%GetString("NewUI","47");%></option>
				<option value="46800" <%NvramMatch("GuestPortLeaseTime","46800","selected");%>>13 <%GetString("NewUI","47");%></option>
				<option value="50400" <%NvramMatch("GuestPortLeaseTime","50400","selected");%>>14 <%GetString("NewUI","47");%></option>
				<option value="54000" <%NvramMatch("GuestPortLeaseTime","54000","selected");%>>15 <%GetString("NewUI","47");%></option>
				<option value="57600" <%NvramMatch("GuestPortLeaseTime","57600","selected");%>>16 <%GetString("NewUI","47");%></option>
				<option value="61200" <%NvramMatch("GuestPortLeaseTime","61200","selected");%>>17 <%GetString("NewUI","47");%></option>
				<option value="64800" <%NvramMatch("GuestPortLeaseTime","64800","selected");%>>18 <%GetString("NewUI","47");%></option>
				<option value="68400" <%NvramMatch("GuestPortLeaseTime","68400","selected");%>>19 <%GetString("NewUI","47");%></option>
				<option value="72000" <%NvramMatch("GuestPortLeaseTime","72000","selected");%>>20 <%GetString("NewUI","47");%></option>
				<option value="75600" <%NvramMatch("GuestPortLeaseTime","75600","selected");%>>21 <%GetString("NewUI","47");%></option>
				<option value="79200" <%NvramMatch("GuestPortLeaseTime","79200","selected");%>>22 <%GetString("NewUI","47");%></option>
				<option value="82800" <%NvramMatch("GuestPortLeaseTime","82800","selected");%>>23 <%GetString("NewUI","47");%></option>
				<option value="86400" <%NvramMatch("GuestPortLeaseTime","86400","selected");%>>24 <%GetString("NewUI","47");%></option>
				</select><br>
			</td>
		</tr>
	
	
</table>

<table class="AD_TTL2">
   <tr>
     <td><%GetString("Guestport","14");%></td>
   </tr>
</table>

<table class="AD_SET">
	<tr style="display: none;">
		<th width="180"><%GetString("Guestport","15");%></th>
		<td width="400">
			<!--<input type="hidden" name="WIFISsid4Enable" id="id_WIFISsid4Enable" value="<%NvramGet("WIFISsid4Enable");%>">-->
			<input type="checkbox" id="id_gpauth" value="1" checked onClick="gpauth_enable();"><%GetString("WlanMulti","28");%>
		</td>
	</tr>
	<tr>
		<th><%GetString("WlanMulti","25");%></th>
		<td>
			<input type="radio" name="nosave_usessid4" id="id_usessid8" value="0" onClick="hide_ssid();"
				<%GetMultiWMAC("ssid4","checked");%> <%NvramMatch("WIFISsid4","0","disabled");%>>
				<%GetString("WlanMulti","29");%> (<%GetMultiWMAC("4");%>)<br>
			<input type="radio" name="nosave_usessid4" id="id_usessid9" value="1" onClick="hide_ssid();">
			
				<%GetString("WlanMulti","30");%> :<input type="text" size="40" maxlength="32" name="WIFISsid4" id="id_WIFISsid4" value="<%NvramGetAdv("WIFISsid4");%>"
				<%NvramMatch("WIFISsid4Enable","0","disabled");%>>
		</td>
	</tr>
	<tr>
		<th><%GetString("WlanMulti","45");%></th>
		  <td>
			<select name="WIFIAuthType4" id="id_WIFIAuthType4" onChange="auth_change_S4();isChanged();">			  
			  <option value="WPAPSK" <%NvramMatch("WIFIAuthType4","WPAPSK","selected");%>><%GetString("WlanMulti","47");%></option>
			  <option value="WPA2PSK" <%NvramMatch("WIFIAuthType4","WPA2PSK","selected");%>><%GetString("WlanMulti","48");%></option>
			  <option value="WPAPSKWPA2PSK" <%NvramMatch("WIFIAuthType4","WPAPSKWPA2PSK","selected");%>><%GetString("WlanMulti","49");%></option>
			  <option value="OPEN" <%NvramMatch("WIFIAuthType4","OPEN","selected");%>><%GetString("WlanMulti","46");%></option>
			</select>
		  </td>		
	</tr>
    <tr>
      <th><%GetString("NewUI","267");%></th>
      <td>
	  <select name="WIFIEncrypType4" id="id_WIFIEncrypType4"  onchange="etype_change_S4();isChanged();"> <!--patch 20100105-->
	    <%GetEncrypTypeS4();%>
	  </select>
      </td>
    </tr>	

    <tr id="id_wep4_tbl">
      <th><%GetString("WlanMulti","40");%></th>
      <td>
        <table>
     	  <tr>
     	    <td colspan="2">
     		 <select onChange="clear_wep('4')" name="nosave_WIFIWEPKey1Type_S4" id="id_WIFIWEPKey1Type_S4" onchange="isChanged();">
                <option value="A5" <%GetWEPKeyType("A5","selected","4");%>><%GetString("WlanMulti","41");%></option>
                <option value="A13" <%GetWEPKeyType("A13","selected","4");%>><%GetString("WlanMulti","42");%></option>
                <option value="H10" <%GetWEPKeyType("H10","selected","4");%>><%GetString("WlanMulti","43");%></option>
                <option value="H26" <%GetWEPKeyType("H26","selected","4");%>><%GetString("WlanMulti","44");%></option>
     		 </select>
     	    </td>
     	  </tr>
          <tr>
            <td><input type="radio" name="WIFIWEPKeyIndex4" id="id_WIFIWEPKeyIndex4_1" value="1" onChange="isChanged();" <%NvramMatch("WIFIWEPKeyIndex4","1","checked");%>>1:
         </td>
            <td><input type="password" name="WIFIWEPKey1_S4" id="id_WIFIWEPKey1_S4" size="40" maxlength="26" 
            	value="<%ChangeKeyToStar("WIFIWEPKey1_S4");%>"  onchange="isChanged();"></td>
          </tr>
          <tr>
            <td><input type="radio" name="WIFIWEPKeyIndex4" id="id_WIFIWEPKeyIndex4_2" value="2" onChange="isChanged();" <%NvramMatch("WIFIWEPKeyIndex4","2","checked");%>>2:
         </td>
            <td><input type="password" name="WIFIWEPKey2_S4" id="id_WIFIWEPKey2_S4" size="40" maxlength="26" 
            	value="<%ChangeKeyToStar("WIFIWEPKey2_S4");%>"  onchange="isChanged();"></td>
          </tr>
          <tr>
            <td><input type="radio" name="WIFIWEPKeyIndex4" id="id_WIFIWEPKeyIndex4_3" value="3" onChange="isChanged();" <%NvramMatch("WIFIWEPKeyIndex4","3","checked");%>>3:
         </td>
            <td><input type="password" name="WIFIWEPKey3_S4" id="id_WIFIWEPKey3_S4" size="40" maxlength="26" 
            	value="<%ChangeKeyToStar("WIFIWEPKey3_S4");%>"  onchange="isChanged();"></td>
          </tr>
          <tr>
            <td><input type="radio" name="WIFIWEPKeyIndex4" id="id_WIFIWEPKeyIndex4_4" value="4" onChange="isChanged();" <%NvramMatch("WIFIWEPKeyIndex4","4","checked");%>>4:
         </td>
            <td><input type="password" name="WIFIWEPKey4_S4" id="id_WIFIWEPKey4_S4" size="40" maxlength="26" 
            	value="<%ChangeKeyToStar("WIFIWEPKey4_S4");%>"  onchange="isChanged();"></td>
          </tr>
        </table>
      </td>
    </tr>
    <tr id="id_psk4_tbl">
      <th><%GetString("WlanMulti","34");%></th>
      <td>
		<input type="password" name="WIFIWPAPSK4" id="id_WIFIWPAPSK4" size="64" maxlength="64" 
		value="<%ChangeKeyToStar("WIFIWPAPSK4");%>"  onchange="isChanged();">
      </td>
    </tr>	
	
</table>
  <!--<p><input type="button" value="<%GetString("WlanMulti","57");%>" name="nosave_SETUP_MULTI_SETTINGS" onclick="setWifi();"></p>-->
<input type="hidden" name="nosave_session_num" value="<% NvramGet("session_num"); %>">
</form>
</div>
<div id="basic_confirm" style="display:none;">  
  <p><span id="confirm_64" style="display:none;"><%GetString("WlanMulti","77");%></span></p>
  <p><span id="confirm_space" style="display:none;"><%GetString("WlanMulti","77");%></span></p>
  <p><span id="confirm_ssid" style="display:none;"><%GetString("WlanMulti","78");%></span></p>
</div>

<div id="id_userlist">
<form name="form_userlist" method="POST">
<input type="hidden" name="detectuser" value="">
  <table class="AD_TTL2">
    <tr>
      <td><%GetString("Guestport","16");%></td>
    </tr>
  </table>

  <table class="AD_LIST">
    <tr>
      <th><%GetString("Guestport","17");%></th>
      <th><%GetString("Guestport","18");%></th>
      <th><%GetString("Guestport","19");%></th>
      <th><%GetString("Guestport","20");%></th>
    </tr>
	
	<tr id="id_gpuser0" >
     	<td colspan="4" align="center"><div name="NoReg"><%GetString("NewUI","250");%></div></td>
    </tr>
    
    <tr id="id_gpuser1">
     	<td>
		<%NvramGet("GuestPortUN1");%>
     	</td>
		<%GetGPUserMac("1");%>
     	<td>
		<input type="button" id="submit_user1" value="<%GetString("NewUI","56");%>" name="GP_OP1" onClick="Submit_user('1',this.id);">
     	</td>
    </tr>
     
    <tr id="id_gpuser2">
     	<td>
		<%NvramGet("GuestPortUN2");%>
     	</td>
		<%GetGPUserMac("2");%>
     	<td>
		<input type="button" id="submit_user2" value="<%GetString("NewUI","56");%>" name="GP_OP2" onClick="Submit_user('2',this.id);">
     	</td>
    </tr>
     
    <tr id="id_gpuser3">
     	<td>
		<%NvramGet("GuestPortUN3");%>
     	</td>
		<%GetGPUserMac("3");%>
     	<td>
		<input type="button" id="submit_user3" value="<%GetString("NewUI","56");%>" name="GP_OP3" onClick="Submit_user('3',this.id);">
     	</td>
    </tr>

    <tr id="id_gpuser4">
     	<td>
		<%NvramGet("GuestPortUN4");%>
     	</td>
		<%GetGPUserMac("4");%>
     	<td>
		<input type="button" id="submit_user4" value="<%GetString("NewUI","56");%>" name="GP_OP4" onClick="Submit_user('4',this.id);">
     	</td>
    </tr>
	
    <tr id="id_gpuser5">
     	<td>
		<%NvramGet("GuestPortUN5");%>
     	</td>
		<%GetGPUserMac("5");%>
     	<td>
		<input type="button" id="submit_user5" value="<%GetString("NewUI","56");%>" name="GP_OP5" onClick="Submit_user('5',this.id);">
     	</td>
    </tr>
    	
  </table>
<input type="hidden" name="nosave_session_num" value="<% NvramGet("session_num"); %>">
</form>

  <p><input type="button" value="<%GetString("Guestport","22");%>"
   onClick="location.href
    ='wlan_gpaccount.html'
    "></p>
  <p><input type="button" value="<%GetString("Guestport","23");%>" onClick="location.href='wlan_guestport.html'"></p>  
    
  <div id="button_accept" class="button5" name="nosave_SETUP_MULTI_SETTINGS" onClick="setWifi();">
	  <div class="button_text"><%GetString("WlanMulti","57");%></div>
  </div>
  
  <br/>
  <br/>
</body>
</html>