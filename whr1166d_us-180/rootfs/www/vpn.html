<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=<%ChangeCharset();%>">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Cache-Control" content="no-cache">
<META http-equiv="Content-Style-Type" content="text/css">
<LINK rel="stylesheet" href="WHR-G300N-160149-style-ENG.css" type="text/css">
<LINK rel="stylesheet" href="WHR-G300N-160149-style-ad-ENG.css" type="text/css">

<script language="JavaScript" type="text/javascript" src="common.js"></script>
<script language="JavaScript">
<!--

function set_recommend_lanvalue()
{
	var IntMin = 13;
	var IntMax = 113;
	var IntRandom = Math.floor(Math.random()*(IntMax-IntMin+1))+IntMin;
	
	document.vpnnosave_form.LanIPAddr.value  = "192.168." + IntRandom + ".1" ;
	document.vpnnosave_form.LanNetmask.options[6].selected = true;
	document.vpnnosave_form.DHCPSIPStart.value  = "192.168." + IntRandom + ".2" ;
	document.vpnnosave_form.DHCPSIPEnd.value = "64" ;	 
}

function checkbroadcast(lanip,lanmask,dhcpip,endip,num) 
{
	var i=0;
	var ip,mask,start,end;
	var lastip=new Array(4);
	var startip,endip,chkip;
	var setflag=0;
	ip=lanip.split('.');
	mask=lanmask.split('.');
	start=dhcpip.split('.');
	end=endip.split('.');
	for (i=3;i>=0;i--)
	{
		if (mask[i]==0)
			lastip[i]=255;
		else
		{
			if (mask[i]!=255)
				lastip[i]=(ip[i]&mask[i])+(255-mask[i]);
			else
				lastip[i]=start[i];
		}
			
	}
	//startip=start[0]+":"+start[1]+":"+start[2]+":"+start[3];
	//chkip=lastip[0]+":"+lastip[1]+":"+lastip[2]+":"+lastip[3];
	//alert("before:startip:"+startip+"endip:"+endip+"chkip:"+chkip);
	startip=Math.pow(255,3)*(parseInt(start[0],10))+Math.pow(255,2)*(parseInt(start[1],10))+255*(parseInt(start[2],10))+(parseInt(start[3],10));  
	endip=Math.pow(255,3)*(parseInt(end[0],10))+Math.pow(255,2)*(parseInt(end[1],10))+255*(parseInt(end[2],10))+(parseInt(end[3],10));
	chkip=Math.pow(255,3)*(parseInt(lastip[0],10))+Math.pow(255,2)*(parseInt(lastip[1],10))+255*(parseInt(lastip[2],10))+(parseInt(lastip[3],10));
	//alert("after:startip:"+startip+"endip:"+endip+"chkip:"+chkip);
	if ((parseInt(startip,10)<=parseInt(chkip,10))&&(parseInt(endip,10)>=parseInt(chkip,10)))	
		return false;
	else
		return true;
}

function dhcps_ext_exist() {
  var oElmsExt = document.getElementById("dhcpleasetime");
  if(oElmsExt.length == 0)
  {
    return(false);
  }
  return(true);
}

function vpndhcp_sv_select()
{
  var disable_flag = 0;
  
  if (document.getElementById("vpnid_DHCPSEnable").checked == true) 
  {
    disable_flag = 0;
    document.vpnnosave_form.DHCPSEnable.value="1";
  } 
  else 
  {
    disable_flag = 1;
    document.vpnnosave_form.DHCPSEnable.value="0";
  }
  
  document.vpnnosave_form.DHCPSIPStart.disabled = disable_flag;
  document.getElementById("vpnid_DHCPSIPEnd").disabled = disable_flag;
  /*hebe mark
  document.vpnnosave_form.DHCPSExcludedIPAll.disabled = disable_flag;
  
  if( dhcps_ext_exist()==true ) 
  {
    document.getElementById("dhcpleasetime").disabled = disable_flag;
    document.vpnnosave_form.DHCPSDefaultGWStatus[0].disabled = disable_flag;
    document.vpnnosave_form.DHCPSDefaultGWStatus[1].disabled = disable_flag;
    document.vpnnosave_form.DHCPSDefaultGWStatus[2].disabled = disable_flag;
    document.vpnnosave_form.DHCPSDefaultGW.disabled = disable_flag;
    document.vpnnosave_form.DHCPSDNSServerStatus[0].disabled = disable_flag;
    document.vpnnosave_form.DHCPSDNSServerStatus[1].disabled = disable_flag;
    document.vpnnosave_form.DHCPSDNSServerStatus[2].disabled = disable_flag;
    document.vpnnosave_form.DHCPSDNSServer1.disabled = disable_flag;
    document.vpnnosave_form.DHCPSDNSServer2.disabled = disable_flag;
    document.vpnnosave_form.DHCPSWINSServerStatus[0].disabled = disable_flag;
    document.vpnnosave_form.DHCPSWINSServerStatus[1].disabled = disable_flag;
    document.vpnnosave_form.DHCPSWINSServerStatus[2].disabled = disable_flag;
    document.vpnnosave_form.DHCPSWINSServer.disabled = disable_flag;
    document.vpnnosave_form.DHCPSDomainNameStatus[0].disabled = disable_flag;
    document.vpnnosave_form.DHCPSDomainNameStatus[1].disabled = disable_flag;
    document.vpnnosave_form.DHCPSDomainNameStatus[2].disabled = disable_flag;
    document.vpnnosave_form.DHCPSDomainName.disabled = disable_flag;
    
    if(disable_flag == 0) 
    {
      dhcps_ext_select();
    }
  }
  hebe mark*/
}

function server_select()
{
	if (document.vpnnosave_form.PPTPServer[1].checked == true) 
	{
		document.vpnnosave_form.PPTPServerManualIP.disabled = 0;
	} 
	else 
	{
		document.vpnnosave_form.PPTPServerManualIP.disabled = 1;
	}
}

function client_select()
{
	if (document.vpnnosave_form.PPTPClient[1].checked == true) 
	{
		document.vpnnosave_form.PPTPClientManualIP.disabled = 0;
	} 
	else 
	{
		document.vpnnosave_form.PPTPClientManualIP.disabled = 1;
	}
}

function dns_select()
{
	if (document.vpnnosave_form.PPTPDNS[1].checked == true) 
	{
		document.vpnnosave_form.PPTPDNSManualIP.disabled = 0;
	}
	else 
	{
		document.vpnnosave_form.PPTPDNSManualIP.disabled = 1;
	}
}

function set_pptpdisplay()
{
	if (document.getElementById("id_PPTPEnabled").checked == true)
	{
	    document.vpnnosave_form.PPTPEnable.value="1";

		document.vpnnosave_form.PPTPAuth.disabled = 0;

		document.vpnnosave_form.PPTPServer[0].disabled = 0;
		document.vpnnosave_form.PPTPServer[1].disabled = 0;
		document.vpnnosave_form.PPTPServerManualIP.disabled = 0;

		document.vpnnosave_form.PPTPClient[0].disabled = 0;
		document.vpnnosave_form.PPTPClient[1].disabled = 0;
		document.vpnnosave_form.PPTPClientManualIP.disabled = 0;

		document.vpnnosave_form.PPTPDNS[0].disabled = 0;
		document.vpnnosave_form.PPTPDNS[1].disabled = 0;
		document.vpnnosave_form.PPTPDNS[2].disabled = 0;
		document.vpnnosave_form.PPTPDNSManualIP.disabled = 0;

		document.vpnnosave_form.PPTPWinsIP.disabled = 0;

		document.vpnnosave_form.PPTPMtu.disabled = 0;

		server_select();
		client_select();
		dns_select();
	}
	else
	{
	    document.vpnnosave_form.PPTPEnable.value="0";

		document.vpnnosave_form.PPTPAuth.disabled = 1;

		document.vpnnosave_form.PPTPServer[0].disabled = 1;
		document.vpnnosave_form.PPTPServer[1].disabled = 1;
		document.vpnnosave_form.PPTPServerManualIP.disabled = 1;

		document.vpnnosave_form.PPTPClient[0].disabled = 1;
		document.vpnnosave_form.PPTPClient[1].disabled = 1;
		document.vpnnosave_form.PPTPClientManualIP.disabled = 1;

		document.vpnnosave_form.PPTPDNS[0].disabled = 1;
		document.vpnnosave_form.PPTPDNS[1].disabled = 1;
		document.vpnnosave_form.PPTPDNS[2].disabled = 1;
		document.vpnnosave_form.PPTPDNSManualIP.disabled = 1;

		document.vpnnosave_form.PPTPWinsIP.disabled = 1;

		document.vpnnosave_form.PPTPMtu.disabled = 1;
	}
}

/*hebe mark
function dhcps_ext_select()
{
  if (document.vpnnosave_form.DHCPSDefaultGWStatus[1].checked == true) 
  {
    document.vpnnosave_form.DHCPSDefaultGW.disabled = 0;
  } 
  else 
  {
    document.vpnnosave_form.DHCPSDefaultGW.disabled = 1;
  }
  
  if (document.vpnnosave_form.DHCPSDNSServerStatus[1].checked == true) 
  {
    document.vpnnosave_form.DHCPSDNSServer1.disabled = 0;
    document.vpnnosave_form.DHCPSDNSServer2.disabled = 0;
  } 
  else 
  {
    document.vpnnosave_form.DHCPSDNSServer1.disabled = 1;
    document.vpnnosave_form.DHCPSDNSServer2.disabled = 1;
  }
  
  if (document.vpnnosave_form.DHCPSWINSServerStatus[1].checked == true) 
  {
    document.vpnnosave_form.DHCPSWINSServer.disabled = 0;
  } 
  else 
  {
    document.vpnnosave_form.DHCPSWINSServer.disabled = 1;
  }
  
  if (document.vpnnosave_form.DHCPSDomainNameStatus[1].checked == true) 
  {
    document.vpnnosave_form.DHCPSDomainName.disabled = 0;
  } 
  else 
  {
    document.vpnnosave_form.DHCPSDomainName.disabled = 1;
  }
}

function set_display()
{
  if(document.getElementById("id_DHCPSAdvancedDisplay").checked == true)
  {
    document.getElementById("dhcps_ext_settings").style.display = "";
    document.vpnnosave_form.DHCPSAdvancedDisplay.value="1";
  } 
  else 
  {
    document.getElementById("dhcps_ext_settings").style.display = "none";
    document.vpnnosave_form.DHCPSAdvancedDisplay.value="0";
  }
}
hebe mark*/

function vpnInitForms()
{
  var lanipadd="<%NvramGet("LanIPAddr");%>";
  var dhcpstartip="<%NvramGet("DHCPSIPStart");%>";
  var dhcpendip="<%NvramGet("DHCPSIPEnd");%>";
  var dhcpendipnum_3="<%NvramGet("DHCPSMaxUser");%>";
  var pptpauth="<%NvramGet("PPTPAuth");%>";
  var vpnserveron="<%NvramGet("PPTPEnable");%>";
  var vpnserverauto="<%NvramGet("PPTPServerIP");%>";
  var n1,n2;
  //hebe mark var leasetime= "<%NvramGet("DHCPSLeaseTime");%>";

  var lanipaddvar = lanipadd.split(".");
  
  if (lanipaddvar[2] == "11")
  {
	top.content_helpframe.document.location.href = "./help/help_vpn_auto.html";

	var err_msg = "<%GetString("VPN","62");%>";

	document.getElementById("id_dhcp_setting").style.display = "";

	document.getElementById("id_errtbl_msg").innerHTML += "<p>"+err_msg+"</p>";
	document.getElementById("id_errtbl_msg").style.display="";
  }
  else
  {
	top.content_helpframe.document.location.href = "./help/help_vpn.html";
	document.getElementById("id_dhcp_setting").style.display = "none";
  }

  if (vpnserverauto.length != 0 && vpnserveron == 1)
  {
	var auto_serverip = "<%NvramGet("PPTPServerIP");%>";
	var auto_clientip = "<%NvramGet("PPTPClientIP");%>" + "<%GetString("VPN","27");%>";

	document.getElementById("id_serverautoip").innerHTML += "(&nbsp;&nbsp;" + auto_serverip + "&nbsp;&nbsp;)";
	document.getElementById("id_serverautoip").style.display="";

	document.getElementById("id_clientautoip").innerHTML += "(&nbsp;&nbsp;" + auto_clientip + "&nbsp;&nbsp;)";
	document.getElementById("id_clientautoip").style.display="";
  }

  vpndhcp_sv_select('vpnnosave_form');
  //set_display();
  
  //hebe mark dhcps_ext_exist();

  set_pptpdisplay();

  document.getElementById("vpnid_DHCPSIPEnd").value=dhcpendipnum_3.toString();//set dhcp end ip num
  document.vpnnosave_form.PPTPAuth.value = pptpauth;
/*
  n1=dhcpstartip.split('.');
  n2=dhcpendip.split('.');
  if (n1[2]==n2[2])
  {
    dhcpendipnum_3=parseInt(n2[3],10)-parseInt(n1[3],10)+1;//start-end+1
    document.getElementById("vpnid_DHCPSIPEnd").value=dhcpendipnum_3.toString();//set dhcp end ip num
  }
  else //if (n1[2]!=n2[2])
  {
    dhcpendipnum_3=parseInt(n2[3],10)+255-parseInt(n1[3],10)+1;//start+255-end+1
    document.getElementById("vpnid_DHCPSIPEnd").value=dhcpendipnum_3.toString();//set dhcp end ip num
  }*/
  
  //hebe mark document.getElementById("dhcpleasetime").value = (parseInt(leasetime))/3600;
}

function check_ip_format(ip, item, type,netmask)
{
	var n;
	var lanip=document.vpnnosave_form.LanIPAddr.value;
	var lanmask=document.vpnnosave_form.LanNetmask.options[document.vpnnosave_form.LanNetmask.selectedIndex].value;
	var canNotSetTo255=0;
	var wanip="<%NvramGet("WanCurrentIP");%>";
	var wanmask="<%NvramGet("WanCurrentNetmask");%>";
	
	if (netmask)
	{
		if (netmask.length > 0)
		{
			o = netmask.split('.');
			if (o.length==4)
			{
				if (o[2]>=254)
					canNotSetTo255=1;
			}
		}
	}
	
	if(!isAllowValueIP(ip,item))
	{
    return false;
  }
  if (ip=="0.0.0.0")
  {
    Show_error(item,"<%GetString("Lan","30");%>");
    return false;
  }
  if (ip=="255.255.255.255")
  {
    Show_error(item,"<%GetString("Lan","31");%>");
    return false;
  }
  
  if (!isBlank(ip))
  {
    n = ip.split('.');
    
    if (n.length!=4)
    {
      Show_error(item,"<%GetString("Lan","33");%>");
      return false;
    }
    else
    {
      if(isBlank(n[0]))
      {
        Show_error(item,"<%GetString("Lan","33");%>");
        return false;
      }	
      //else if((isNaN(n[0]))||(n[0]<=0)||(n[0]>255)||!check_integer(n[0])||check_initial_zero(n[0])) 
	  else if((isNaN(n[0]))||(n[0]<=0)||(n[0]>255)||!check_integer(n[0])) 
      {
        Show_error(item,"<%GetString("Lan","33");%>");
        return false;
      }
      else if (n[0]==127)
      {
        Show_error(item,"<%GetString("Lan","34");%>");
        return false;
      }
	  else if (n[0]>=224 && n[0]<=239)
      {
        Show_error(item,"<%GetString("WizardFuncInet","49");%>");
        return false;
      }
      else if (n[0]>=240 && n[0]<=255)
      {
        Show_error(item,"<%GetString("Lan","35");%>");
        return false;
      }	
      
      if(isBlank(n[1]))
      {
        Show_error(item,"<%GetString("Lan","33");%>");
        return false;
      }
      //else if((isNaN(n[1]))||(n[1]<0)||(n[1]>255)||!check_integer(n[1])||check_initial_zero(n[1])) 
	  else if((isNaN(n[1]))||(n[1]<0)||(n[1]>255)||!check_integer(n[1])) 
      {
        Show_error(item,"<%GetString("Lan","33");%>");
        return false;
      }		
      
      if(isBlank(n[2]))
      {
        Show_error(item,"<%GetString("Lan","33");%>");
        return false;
      }
      //else if((isNaN(n[2]))||(n[2]<0)||(n[2]>255)||!check_integer(n[2])||check_initial_zero(n[2])) 
	  else if((isNaN(n[2]))||(n[2]<0)||(n[2]>255)||!check_integer(n[2])) 
      {
        Show_error(item,"<%GetString("Lan","33");%>");
        return false; 
      }
      
      if(isBlank(n[3]))
      {
        Show_error(item,"<%GetString("Lan","33");%>");
        return false;
      }
      //else if((isNaN(n[3]))||(n[3]<0)||(n[3]>255)||!check_integer(n[3])||check_initial_zero(n[3]))
	  else if((isNaN(n[3]))||(n[3]<0)||(n[3]>255)||!check_integer(n[3]))
      {
      	if (!(canNotSetTo255==0 && n[3]==255))
       	{
        	Show_error(item,"<%GetString("Lan","33");%>");
        	return false;
        }
      }
    }
    
	if (type=="lanip")
	{
		if(wanip!="" && check_the_same_subnet(wanip,ip,wanmask))
		{
		    Show_error(item,"<%GetString("Lan","69");%>");
			return false;
		}
	}
	
	
    if (type=="defaultgw")//check default getway
    {
      if (!check_the_same_subnet(lanip,ip,lanmask))
      {
        Show_error(item,"<%GetString("Lan","28");%>");
        return false;
      }
    }
  }
  return true;
}

function isEmpty(s)
{
	if(s.length==0)
	{
		return true;
	}
	else
	{
		return false;
	}
}

function check_initial_zero(tmp)
{
	if(tmp.length>1&&tmp.charAt(0)=="0")
	{
		return true;
	}
	return false;
}

function isAllowValueIP(s,item)
{
  var i;
	for (i=0; i<s.length; i++)
	{
		var c;
		
		c=s.charAt(i);
	
		if (((c>='0')&&(c<='9')) || (c=='.'))
		{
      continue;
		}
		else
		{
			Show_error(item,"<%GetString("Lan","36");%>");
      return false;
		}
	}
	
	return true;
}

/*hebe marked
function checkExcludeIP()
{
  var excip=document.vpnnosave_form.DHCPSExcludedIPAll.value;
  var n1,n2;
  var i;
  var item="<%GetString("Lan","39");%>";
  
  n1=excip.split(',');
  
  for (i=0; i<n1.length; i++)//divide with, and divide with-   and checkip(all ip)
  {
    if (isEmpty(n1[i]))
    {
      Show_error(item,"<%GetString("Lan","33");%>");
      return false;
    }
    
    n2=n1[i].split('-');
    
    if (n2.length==1)
    {
      if (isEmpty(n1[i]))
      {
        Show_error(item,"<%GetString("Lan","33");%>");
        return false;
      }
      if (!check_ip_format(n1[i],"<%GetString("Lan","39");%>",""))
      {
        return false;
      }
      if (!checkExcludeRange(n1[i]))
      {
        return false;
      }
    }
    else if (n2.length==2)
    {
      if (isEmpty(n2[0]) || isEmpty(n2[1]))
      {
        Show_error(item,"<%GetString("Lan","33");%>");
        return false;
      }
      if (!check_ip_format(n2[0],"<%GetString("Lan","39");%>","") || !check_ip_format(n2[1],"<%GetString("Lan","39");%>",""))
      {
        return false;
      }
      
      if (!checkExcludeRange(n2[0]) || !checkExcludeRange(n2[1]))//checkip(Excluded IP Addresses)  should in same subnetmask
      {
        return false;
      }
	if (!ipBig(n2[1],n2[0]))
      //if (!ipBig(n2[2],n1[2]))//check- first ip should big than later
      {
        Show_error(item,"<%GetString("Lan","40");%>");
        return false;
      }
    }
    else//if more Character
    {
      Show_error(item,"<%GetString("Lan","33");%>");
      return false;
    }
  }
 
  return true;
}
*/

function checkExcludeRange(ip)
{
  var lanip=document.vpnnosave_form.LanIPAddr.value;
	var lanmask=document.vpnnosave_form.LanNetmask.options[document.vpnnosave_form.LanNetmask.selectedIndex].value;
	var dhcpstartip=document.vpnnosave_form.DHCPSIPStart.value;
	var dhcpendip=document.vpnnosave_form.DHCPSIPEnd.value;
	var item="<%GetString("Lan","39");%>";
  
  if (!check_the_same_subnet(ip,lanip,lanmask))//same subnetmask
  {
    Show_error(item,"<%GetString("Lan","28");%>");
    return false;
  }
  
  if (ipBig(dhcpstartip,ip) || ipBig(ip,dhcpendip))//in dhcp range  if (ip < dhcpstartip || ip > dhcpendip)
  {
    Show_error(item,"<%GetString("Lan","29");%>");
    return false;
  }
  
  return true;
}

function ipBig(ip1,ip2)
{
	var start, end;
	var startip, endip;
	start=ip1.split('.');
	startip=Math.pow(255,3)*(parseInt(start[0],10))+Math.pow(255,2)*(parseInt(start[1],10))+255*(parseInt(start[2],10))+(parseInt(start[3],10));
 	end=ip2.split('.');
 	endip=Math.pow(255,3)*(parseInt(end[0],10))+Math.pow(255,2)*(parseInt(end[1],10))+255*(parseInt(end[2],10))+(parseInt(end[3],10));
	
	if (parseInt(startip,10)>parseInt(endip,10))//ip1 > ip2
		return true;
	else //if ip1<=ip2
		return false;
}

function checkDHCPRange()
{
  var lanip=document.vpnnosave_form.LanIPAddr.value;
	var lanmask=document.vpnnosave_form.LanNetmask.options[document.vpnnosave_form.LanNetmask.selectedIndex].value;
	var dhcpstartip=document.vpnnosave_form.DHCPSIPStart.value;
	var dhcpendip=document.getElementById("vpnid_DHCPSIPEnd").value;
	var dhcpendipnum_3,dhcpendipnum_2;
	var item="<%GetString("Lan","41");%>";
	var n1,n2;
  var n1_3,n2_3,n1_2,n2_2;
	var dhcpendip_ip;
	
	if (!check_the_same_subnet(dhcpstartip,lanip,lanmask))//start ip should be same subnetmask wuth lanip
  {
    Show_error(item,"<%GetString("Lan","28");%>");
    return false;
  }
  
  n1=dhcpstartip.split('.');
  n2=lanip.split('.');
  n1_3=parseInt(n1[3],10);//start ip
  n2_3=parseInt(n2[3],10);//lan ip
  dhcpendipnum_3=parseInt(dhcpendip,10)+n1_3-1;//start+end-1
  
  if (n1[2]==n2[2])
  {
    dhcpendip_ip=n1[0]+"."+n1[1]+"."+n1[2]+"."+dhcpendipnum_3.toString();
    
    if (dhcpendipnum_3>255)
    {
      dhcpendipnum_3=dhcpendipnum_3-255;
      dhcpendipnum_2=parseInt(n1[2],10)+1;
      dhcpendip_ip=n1[0]+"."+n1[1]+"."+dhcpendipnum_2.toString()+"."+dhcpendipnum_3.toString();
    }
    if (!check_the_same_subnet(dhcpendip_ip,lanip,lanmask))//end ip should be same subnetmask with lanip
    {
      Show_error(item,"<%GetString("Lan","28");%>");
      return false;
    }
    if (!ipBig(dhcpstartip,lanip) && !ipBig(lanip,dhcpendip_ip))//can't include lanip
    {
      Show_error(item,"<%GetString("Lan","42");%>");
      return false;
    }
  }
  else //if (n1[2]!=n2[2])
  {
    dhcpendipnum_3=dhcpendipnum_3-255;
    dhcpendipnum_2=parseInt(n1[2],10)+1;
    dhcpendip_ip=n1[0]+"."+n1[1]+"."+dhcpendipnum_2.toString()+"."+dhcpendipnum_3.toString();
    
    if (!check_the_same_subnet(dhcpendip_ip,lanip,lanmask))//end ip should be same subnetmask with lanip
    {
      Show_error(item,"<%GetString("Lan","28");%>");
      return false;
    }
    if (!ipBig(dhcpstartip,lanip) && !ipBig(lanip,dhcpendip_ip))//can't include lanip  if(dhcpstartip <= lanip <= dhcpendip)
    {
      Show_error(item,"<%GetString("Lan","42");%>");
      return false;
    }
  }    
  //---------------------------add 0423
   var d_mask=turnCIDRMask(lanmask);
   var FirstIP=NetworkIP(ip2long(lanip), d_mask);
   var LastIP=BrocastIP(FirstIP, d_mask);
   var _BrocastIP=long2ip(LastIP);   
  if (dhcpstartip==_BrocastIP)
  {
    Show_error(item,"<%GetString("Lan","46");%>");
    return false;
  }
  //---------------------------add 0423 end
  //alert(lanip+" : "+lanmask+" : "+dhcpstartip+" : "+dhcpendip_ip+" : "+dhcpendip);
  if(!checkbroadcast(lanip,lanmask,dhcpstartip,dhcpendip_ip,dhcpendip))
  {
      Show_error(item,"<%GetString("Lan","28");%>");
      return false;
  }
  document.vpnnosave_form.DHCPSIPEnd.value=dhcpendip_ip;//set hidden dhcp end ip

  return true;
}

function checkDomainValue()
{
  var domain=document.vpnnosave_form.DHCPSDomainName.value;
  var domain_s=domain.split('.');

  /*
  if(domain_s[0].length<=2)
  {
	Show_error("<%GetString("Lan","43");%>","<%GetString("Lan","44");%>");	
	return false;
  }
  */
 
  for (i=0; i<domain.length; i++)
	{
		var c;
			
		c=domain.charAt(i);
		
		if (((c>='0')&&(c<='9')) || ((c>='a')&&(c<='z')) || ((c>='A')&&(c<='Z')) || (c=='.') || (c=='-'))
		{
			continue;
		}
		else
		{
		  Show_error("<%GetString("Lan","43");%>","<%GetString("Lan","36");%>");
			return false;
		}
	}
	
	if ((domain.charAt(0)=='-')||(domain.charAt(0)=='.') ||(domain.charAt(domain.length-1)=='-') ||(domain.charAt(domain.length-1)=='.'))
	{
		Show_error("<%GetString("Lan","43");%>","<%GetString("Lan","44");%>");
		return false;		
	}
	
	return true;
}

function vpncheckerror(item)
{
	var f = document.forms[0];

	if (item == 1)
	{
		var fixip = f.PPTPServerManualIP.value.split(".");
		var errorname = "<%GetString("VPN","19");%>";
	}
	else
	{
		var fixip = f.PPTPClientManualIP.value.split(".");
		var errorname = "<%GetString("VPN","20");%>";
	}

	if (fixip[0] != 10 && fixip[0] != 172 && fixip[0] != 192)
	{
		Show_error(errorname,"<%GetString("VPN","55");%>");
		return false;
	}
	else if (fixip[0] == 10)
	{
		if (fixip[1] < 0 || fixip[1] > 255)
		{
			Show_error(errorname,"<%GetString("VPN","55");%>");
			return false;
		}
		if (fixip[2] < 0 || fixip[2] > 255)
		{
			Show_error(errorname,"<%GetString("VPN","55");%>");
			return false;
		}
		if (fixip[3] < 1 || fixip[3] > 254)
		{
			Show_error(errorname,"<%GetString("VPN","55");%>");
			return false;
		}
	}
	else if (fixip[0] == 172)
	{
		if (fixip[1] < 16 || fixip[1] > 31)
		{
			Show_error(errorname,"<%GetString("VPN","55");%>");
			return false;
		}
		if (fixip[2] < 0 || fixip[2] > 255)
		{
			Show_error(errorname,"<%GetString("VPN","55");%>");
			return false;
		}
		if (fixip[3] < 1 || fixip[3] > 254)
		{
			Show_error(errorname,"<%GetString("VPN","55");%>");
			return false;
		}
	}
	else if (fixip[0] == 192)
	{
		if (fixip[1] != 168)
		{
			Show_error(errorname,"<%GetString("VPN","55");%>");
			return false;
		}
		if (fixip[2] < 0 || fixip[2] > 255)
		{
			Show_error(errorname,"<%GetString("VPN","55");%>");
			return false;
		}
		if (fixip[3] < 1 || fixip[3] > 254)
		{
			Show_error(errorname,"<%GetString("VPN","55");%>");
			return false;
		}
	}

	var lanadd="<%NvramGet("LanIPAddr");%>";
	var lanaddvar = lanadd.split(".");

	if (fixip[0] == lanaddvar[0] && fixip[1] == lanaddvar[1] && fixip[2] == lanaddvar[2])
	{
		Show_error(errorname,"<%GetString("VPN","75");%>");
		return false;
	}

	return true;	
}

function ip2long(ip)
{
    var ips = ip.split('.');
    var iplong = 0;
    iplong = ips[0]*Math.pow(256,3)+ips[1]*Math.pow(256,2)+ips[2]*Math.pow(256,1)+ips[3]*Math.pow(256,0)
    return iplong;
}

function long2ip(l) 
{
    var ip1 = Math.floor(l/Math.pow(256,3));
    var ip2 = Math.floor((l%Math.pow(256,3))/Math.pow(256,2));
    var ip3 = Math.floor(((l%Math.pow(256,3))%Math.pow(256,2))/Math.pow(256,1));
    var ip4 = Math.floor((((l%Math.pow(256,3))%Math.pow(256,2))%Math.pow(256,1))/Math.pow(256,0));
    return ip1 + '.' + ip2 + '.' + ip3 + '.' + ip4;
}

function NetworkIP(ip, mask)
{
    return ip - (ip & (Math.pow(2, 32-mask)-1)) ;
}

function BrocastIP(ip, mask) 
{
    return ip + (Math.pow(2, (32 - mask))-1);
}

function turnCIDRMask(mask) 
{
    var masks = mask.split('.');
    var count=0;
    var i,j;
    var tmp;
    for(i=0;i<=3;i++)
    {
        tmp=parseInt(masks[i],10);         
        tmp=tmp.toString(2);
        for(j=0;j<=8;j++)
        {
            if(tmp.charAt(j)=="1")
            count+=1;
        }
    }
    return count;
}

function checkIsNetworkBroadcast(ip,netmask,netmaskindex,item)
{

    var mask=turnCIDRMask(netmask);
    var FirstIP=NetworkIP(ip2long(ip), mask);
    var LastIP=BrocastIP(FirstIP, mask);
    var _NetworkIP=long2ip(FirstIP);
    var _BrocastIP=long2ip(LastIP);
    var _Mask=long2ip(((Math.pow(2, 32)-1) - (Math.pow(2, (32-mask))-1)));
    var flag_network_fail=0,flag_broadcast_fail=0;

    //alert("[_NetworkIP:"+_NetworkIP+"][_BrocastIP:"+_BrocastIP+"][sMask:"+_Mask+"]");
    if(ip==_NetworkIP)
        flag_network_fail=1;
    if(ip==_BrocastIP)
        flag_broadcast_fail=1;
        
    if(flag_network_fail==1)
    {
        Show_error(item,"<%GetString("Lan","45");%>");
            return false;	
    }
    if (flag_broadcast_fail==1)
    {
        Show_error(item,"<%GetString("Lan","46");%>");
        return false;
    }
      
      return true;
}

function checkItem()
{
  var lanipbefore="<%NvramGet("LanIPAddr");%>";
  var netmaskbefore="<%NvramGet("LanNetmask");%>";
  var lanipafter=document.vpnnosave_form.LanIPAddr.value;
  var netmaskafter=document.vpnnosave_form.LanNetmask.options[document.vpnnosave_form.LanNetmask.selectedIndex].value;
  
  if (lanipbefore==lanipafter && netmaskbefore==netmaskafter)
  {
    document.vpnnosave_form.submit();
  }
  else
  {
    document.getElementById("content").style.display = "none";
    document.getElementById("confirm").style.display = "";
  }
}

function goBack()
{
  	document.getElementById("content").style.display = "";
	document.getElementById("confirm").style.display = "none";
}

function apply()
{
  document.getElementById("vpnid_editlanflag").value=1;
  document.vpnnosave_form.LanIPAddr.value = ip_normalize_0(document.vpnnosave_form.LanIPAddr.value);
  //document.vpnnosave_form.DHCPSDefaultGW.value = ip_normalize_0(document.vpnnosave_form.DHCPSDefaultGW.value);  
  
  document.vpnnosave_form.submit();
}

function setPPTP()
{
  var lanmask=document.vpnnosave_form.LanNetmask.options[document.vpnnosave_form.LanNetmask.selectedIndex].value;
  if (isEmpty(document.vpnnosave_form.LanIPAddr.value))
  {
    Show_error("<%GetString("Lan","47");%>","<%GetString("Lan","38");%>");
    return false;
  }
  if (!check_ip_format(document.vpnnosave_form.LanIPAddr.value,"<%GetString("Lan","47");%>","lanip",lanmask))//checkip(LAN Side IP Address)
  {
    return false;
  }
  if (!checkIsNetworkBroadcast(document.vpnnosave_form.LanIPAddr.value,lanmask,document.vpnnosave_form.LanNetmask.selectedIndex,"<%GetString("Lan","47");%>"))
  {
    return false;
  }
  
  if (document.getElementById("vpnid_DHCPSEnable").checked==true)//if(DHCP Server Function checked)
  {
    if (isEmpty(document.vpnnosave_form.DHCPSIPStart.value))
    {
      Show_error("<%GetString("Lan","41");%>","<%GetString("Lan","38");%>");
      return false;
    }
    if (!check_ip_format(document.vpnnosave_form.DHCPSIPStart.value,"<%GetString("Lan","41");%>",""))//checkip(dhcp ip start)  can't include lanip
    {
      return false;
    }
    
    if (isEmpty(document.getElementById("vpnid_DHCPSIPEnd").value))//checkint(dhcp ip end)  1-256
    {
      Show_error("<%GetString("Lan","48");%>","<%GetString("Lan","38");%>");
      return false;
    }
    else if (!check_integer(document.getElementById("vpnid_DHCPSIPEnd").value))
    {
      Show_error("<%GetString("Lan","48");%>","<%GetString("Lan","36");%>");
      return false;
    }
    else if (parseInt(document.getElementById("vpnid_DHCPSIPEnd").value,10)<1)
    {
      Show_error("<%GetString("Lan","48");%>","<%GetString("Lan","49");%>");
      return false;
    }
    else if (parseInt(document.getElementById("vpnid_DHCPSIPEnd").value,10)>256)
    {
      Show_error("<%GetString("Lan","48");%>","<%GetString("Lan","50");%>");
      return false;
    }
    
    if (!checkDHCPRange())
    {
      return false;
    }

	/* hebe mark
    if (!isEmpty(document.vpnnosave_form.DHCPSExcludedIPAll.value))
    {
      if (!checkExcludeIP())
      {
        return false;
      }
    }

	if(document.getElementById("id_PPTPEnabled").checked == true)
	{
		document.vpnnosave_form.DHCPSExcludedIPAll.value;
	}
	
    if (isEmpty(document.getElementById("dhcpleasetime").value))//checkint(Lease Period)  1-999
    {
      Show_error("<%GetString("Lan","51");%>","<%GetString("Lan","38");%>");
      return false;
    }
    else if (!check_integer(document.getElementById("dhcpleasetime").value))
    {
      Show_error("<%GetString("Lan","51");%>","<%GetString("Lan","36");%>");
      return false;
    }
    else if (parseInt(document.getElementById("dhcpleasetime").value,10)<1)
    {
      Show_error("<%GetString("Lan","51");%>","<%GetString("Lan","49");%>");
      return false;
    }
    
    leasetime=parseInt(document.getElementById("dhcpleasetime").value,10)*3600;
    document.vpnnosave_form.DHCPSLeaseTime.value=leasetime.toString(10);
    
    if (document.vpnnosave_form.DHCPSDefaultGWStatus[1].checked==true)//if (Default Gateway select)
    {
      if (isEmpty(document.vpnnosave_form.DHCPSDefaultGW.value))//ip can't empty
      {
        Show_error("<%GetString("Lan","52");%>","<%GetString("Lan","38");%>");
        return false;
      }
      if (!check_ip_format(document.vpnnosave_form.DHCPSDefaultGW.value,"<%GetString("Lan","52");%>","defaultgw"))//checkip(Default Gateway ip)  check same sunetmask
      {
        return false;
      }
    }

    
    
    if (document.vpnnosave_form.DHCPSDomainNameStatus[1].checked==true)//if (Domain Name selsct)
    {
      if (isEmpty(document.vpnnosave_form.DHCPSDomainName.value))//name can't empty
      {
        Show_error("<%GetString("Lan","43");%>","<%GetString("Lan","38");%>");
        return false;
      }
      if (!checkDomainValue())//name should be latter number - .   - and . can't be first one and last one
      {
        return false;
      }
    }
	hebe mark*/
  }

  if (document.forms[0].PPTPServer[1].checked == true)
  {
	  if (vpncheckerror(1) == false)
	  {
		return false;
	  }
  }

  if (document.forms[0].PPTPClient[1].checked == true)
  {
	  if (vpncheckerror(2) == false)
	  {
		return false;
	  }
  }
  
  if (document.vpnnosave_form.PPTPDNS[1].checked==true)//if (DNS Servers select)
  {
	if (isEmpty(document.vpnnosave_form.PPTPDNSManualIP.value))//Primary ip can't empty
	{
		Show_error("<%GetString("VPN","21");%>","<%GetString("Lan","38");%>");
		return false;
	}
	if (!check_ip_format(document.vpnnosave_form.PPTPDNSManualIP.value,"<%GetString("VPN","21");%>",""))//checkip(ip)
	{
		return false;
	}
  }
  if (!check_ip_format(document.vpnnosave_form.PPTPWinsIP.value,"<%GetString("VPN","22");%>",""))//checkip(ip)
  {
	return false;
  }

  if (document.vpnnosave_form.PPTPMtu.value < 578)
  {
	Show_error("<%GetString("VPN","23");%>","<%GetString("VPN","64");%>");
	return false;
  }

  if (document.vpnnosave_form.PPTPMtu.value > 1500)
  {
	Show_error("<%GetString("VPN","23");%>","<%GetString("VPN","63");%>");
	return false;
  }

  checkItem();
}

function PPTP_disconnect(pid, username){
	document.vpndelete_form.PPTPDeleteid.value = pid;
	document.vpndelete_form.PPTPDeleteuser.value = username;
	document.vpndelete_form.submit();
}

// -->
</script>
</head>
<body class="BFK_BODY" onLoad="vpnInitForms();">
<br>

<form name="vpnnosave_form" method="POST">
<input type="hidden" id="vpnid_editlanflag" name="nosave_lanRestartFlag" value="0">
<div id="content">
<div id="id_errtbl" class="C_ERR" style="display:none;"></div>
<div id="id_errtbl_msg" class="C_ERR" style="display:none;"></div>
<div id="id_dhcp_setting" style="display:none;">
  <br/>
  <table class="AD_SET">
    <tbody>
	<tr>
	  <th><%GetString("HelpNet","278");%></th>
	  <td>
		<input type="button" value="<%GetString("VPN","61");%>" onclick="set_recommend_lanvalue();">
	  </td>
	</tr>
    <tr>
      <th><%GetString("VPN","1");%></th>
      <td>
        <table>
          <tr>
            <td><%GetString("VPN","2");%></td>
            <td>
              <input type="text" name="LanIPAddr" size="20" maxlength="15" value="<%NvramGet("LanIPAddr");%>">
            </td>
          </tr>
          <tr>
            <td><%GetString("VPN","3");%></td>
            <td><select size="1" name="LanNetmask">
       		<option value="255.255.255.252" <%NvramMatch("LanNetmask", "255.255.255.252", "selected");%>>255.255.255.252</option>
<option value="255.255.255.248" <%NvramMatch("LanNetmask", "255.255.255.248", "selected");%>>255.255.255.248</option>
<option value="255.255.255.240" <%NvramMatch("LanNetmask", "255.255.255.240", "selected");%>>255.255.255.240</option>
<option value="255.255.255.224" <%NvramMatch("LanNetmask", "255.255.255.224", "selected");%>>255.255.255.224</option>
<option value="255.255.255.192" <%NvramMatch("LanNetmask", "255.255.255.192", "selected");%>>255.255.255.192</option>
<option value="255.255.255.128" <%NvramMatch("LanNetmask", "255.255.255.128", "selected");%>>255.255.255.128</option>
<option value="255.255.255.0" <%NvramMatch("LanNetmask", "255.255.255.0", "selected");%>>255.255.255.0</option>
<option value="255.255.254.0" <%NvramMatch("LanNetmask", "255.255.254.0", "selected");%>>255.255.254.0</option>
<option value="255.255.252.0" <%NvramMatch("LanNetmask", "255.255.252.0", "selected");%>>255.255.252.0</option>
<option value="255.255.248.0" <%NvramMatch("LanNetmask", "255.255.248.0", "selected");%>>255.255.248.0</option>
<option value="255.255.240.0" <%NvramMatch("LanNetmask", "255.255.240.0", "selected");%>>255.255.240.0</option>
<option value="255.255.224.0" <%NvramMatch("LanNetmask", "255.255.224.0", "selected");%>>255.255.224.0</option>
<option value="255.255.192.0" <%NvramMatch("LanNetmask", "255.255.192.0", "selected");%>>255.255.192.0</option>
<option value="255.255.128.0" <%NvramMatch("LanNetmask", "255.255.128.0", "selected");%>>255.255.128.0</option>
<option value="255.255.0.0" <%NvramMatch("LanNetmask", "255.255.0.0", "selected");%>>255.255.0.0</option>
<option value="255.254.0.0" <%NvramMatch("LanNetmask", "255.254.0.0", "selected");%>>255.254.0.0</option>
<option value="255.252.0.0" <%NvramMatch("LanNetmask", "255.252.0.0", "selected");%>>255.252.0.0</option>
<option value="255.248.0.0" <%NvramMatch("LanNetmask", "255.248.0.0", "selected");%>>255.248.0.0</option>
<option value="255.240.0.0" <%NvramMatch("LanNetmask", "255.240.0.0", "selected");%>>255.240.0.0</option>
<option value="255.224.0.0" <%NvramMatch("LanNetmask", "255.224.0.0", "selected");%>>255.224.0.0</option>
<option value="255.192.0.0" <%NvramMatch("LanNetmask", "255.192.0.0", "selected");%>>255.192.0.0</option>
<option value="255.128.0.0" <%NvramMatch("LanNetmask", "255.128.0.0", "selected");%>>255.128.0.0</option>
<option value="255.0.0.0" <%NvramMatch("LanNetmask", "255.0.0.0", "selected");%>>255.0.0.0</option>
<option value="254.0.0.0" <%NvramMatch("LanNetmask", "254.0.0.0", "selected");%>>254.0.0.0</option>
<option value="252.0.0.0" <%NvramMatch("LanNetmask", "252.0.0.0", "selected");%>>252.0.0.0</option>
<option value="248.0.0.0" <%NvramMatch("LanNetmask", "248.0.0.0", "selected");%>>248.0.0.0</option>
<option value="240.0.0.0" <%NvramMatch("LanNetmask", "240.0.0.0", "selected");%>>240.0.0.0</option>
<option value="224.0.0.0" <%NvramMatch("LanNetmask", "224.0.0.0", "selected");%>>224.0.0.0</option>
<option value="192.0.0.0" <%NvramMatch("LanNetmask", "192.0.0.0", "selected");%>>192.0.0.0</option>
<option value="128.0.0.0" <%NvramMatch("LanNetmask", "128.0.0.0", "selected");%>>128.0.0.0</option>     
</select>
			</td>
          </tr>
        </table>
      </td>
    </tr>
        <tr>
      <th><%GetString("VPN","4");%></th>
      <td>
        <input type="checkbox" id="vpnid_DHCPSEnable"  onClick="vpndhcp_sv_select();" <%NvramMatch("DHCPSEnable", "1", "checked");%>><%GetString("VPN","5");%>
        <input type="hidden" value="<%NvramGet("DHCPSEnable");%>" name="DHCPSEnable">
      </td>
    </tr>
    <tr>
      <th><%GetString("VPN","6");%></th>
      <td>
        <input type="text" name="DHCPSIPStart" size="20" maxlength="15" value="<%NvramGet("DHCPSIPStart");%>"><%GetString("VPN","7");%>
        <input type="text" name="DHCPSMaxUser" id="vpnid_DHCPSIPEnd" size="10" maxlength="3" value=""><%GetString("VPN","8");%><br>
        <input type="hidden" value="<%NvramGet("DHCPSIPEnd");%>" name="DHCPSIPEnd">
      </td>
    </tr>

    </tbody>
  </table>
</div>
  <table class="AD_SET">
    <tbody>
    <tr>
      <th><%GetString("VPN","10");%></th>
      <td>
        <input type="checkbox" id="id_PPTPEnabled" onClick="set_pptpdisplay();" <%NvramMatch("PPTPEnable", "1", "checked");%>><%GetString("VPN","11");%>
        <input type="hidden" value="<%NvramGet("PPTPEnable");%>" name="PPTPEnable">
      </td>
    </tr>
	<tr>
      <th><%GetString("VPN","12");%></th>
      <td>
		<select size="1" name="PPTPAuth">
			<option value="CHAP"><%GetString("VPN","13");%></option>
			<option value="PAP"><%GetString("VPN","14");%></option>
			<option value="MSCHAP"><%GetString("VPN","15");%></option>
			<option value="MSCHAPV2-40"><%GetString("VPN","16");%></option>
			<option value="MSCHAPV2-128"><%GetString("VPN","17");%></option>
      </td>
    </tr>
    </tbody>
  </table>

  <table class="AD_TTL2">
    <tbody>
    <tr><td><%GetString("VPN","18");%> </td></tr>
    </tbody>
  </table>

  <table class="AD_SET" id="pptp_ext_settings">
	<tbody>
    <tr>
      <th><%GetString("VPN","19");%></th>
      <td>
		<table>
			<tr>
				<td>
					<input type="radio" value="auto" name="PPTPServer" onClick="server_select();" <%NvramMatch("PPTPServer", "auto", "checked");%>><%GetString("VPN","24");%>&nbsp;&nbsp;<span id="id_serverautoip" style="display:none;"></span>
				</td>
			</tr>
			<tr>
				<td>
					<input type="radio" value="manual" name="PPTPServer" onClick="server_select();" <%NvramMatch("PPTPServer", "manual", "checked");%>><%GetString("VPN","25");%><input type="text" name="PPTPServerManualIP" size="20" maxlength="15"	value="<%NvramGet("PPTPServerManualIP");%>">
				</td>
			</tr>
		</table>
      </td>
    </tr>
	<tr>
      <th><%GetString("VPN","20");%></th>
      <td>
		<table>
			<tr>
				<td>
					<input type="radio" value="auto" name="PPTPClient" onClick="client_select();" <%NvramMatch("PPTPClient", "auto", "checked");%>><%GetString("VPN","26");%>&nbsp;&nbsp;<span id="id_clientautoip" style="display:none;"></span>
				</td>
			</tr>
			<tr>
				<td>
					<input type="radio" value="manual" name="PPTPClient" onClick="client_select();" <%NvramMatch("PPTPClient", "manual", "checked");%>><%GetString("VPN","25");%><input type="text" name="PPTPClientManualIP" size="20" maxlength="15"	value="<%NvramGet("PPTPClientManualIP");%>"><%GetString("VPN","27");%>
				</td>
			</tr>
		</table>
      </td>
    </tr>
	<tr>
      <th><%GetString("VPN","21");%></th>
      <td>
		<table>
			<tr>
				<td>
					<input type="radio" value="auto" name="PPTPDNS" onClick="dns_select();" <%NvramMatch("PPTPDNS", "auto", "checked");%>><%GetString("VPN","28");%>
				</td>
			</tr>
			<tr>
				<td>
					<input type="radio" value="manual" name="PPTPDNS" onClick="dns_select();" <%NvramMatch("PPTPDNS", "manual", "checked");%>><%GetString("VPN","25");%><input type="text" name="PPTPDNSManualIP" size="20" maxlength="15"	value="<%NvramGet("PPTPDNSManualIP");%>">
				</td>
			</tr>
			<tr>
				<td>
					<input type="radio" value="none" name="PPTPDNS" onClick="dns_select();" <%NvramMatch("PPTPDNS", "none", "checked");%>><%GetString("VPN","29");%>
				</td>
			</tr>
		</table>
      </td>
    </tr>
	<tr>
      <th><%GetString("VPN","22");%></th>
      <td>
        <input type="text" name="PPTPWinsIP" size="20" maxlength="15" value="<%NvramGet("PPTPWinsIP");%>">
      </td>
    </tr>
	<tr>
      <th><%GetString("VPN","23");%></th>
      <td>
        <input type="text" name="PPTPMtu" size="20" maxlength="4" value="<%NvramGet("PPTPMtu");%>">
      </td>
    </tr>
	</tbody>
  </table>

  <p><input type="button" value="<%GetString("VPN","30");%>" onclick="setPPTP();"></p>

  <hr/>

  <table class="AD_TTL2">
    <tbody>
    <tr><td><%GetString("VPN","31");%></td></tr>
    </tbody>
  </table>

  <%PPTPList();%>

  <p><input type="button" value="<%GetString("VPN","36");%>" onclick="location.href='vpn_edituser.html'"></p>

  <p><br/><input type="button" value="<%GetString("VPN","37");%>" onclick="location.href='vpn.html'"></p>
</div>
  <!---------------------------------------->
<div id="confirm" style="display:none;">
<p>
    <div id="selectitem"></div>
</p>
<p>
<%GetString("Lan","59");%>
</p>

<div class="C_CONFIRM">
<p>
<%GetString("Lan","60");%><br>
<ol>
<%GetString("Lan","61");%>
<%GetString("Lan","62");%>
<%GetString("Lan","63");%>
</ol>
<%GetString("Lan","64");%>
</p>
</div>
     <input type="button" id="go"   value="<%GetString("Lan","27");%>" onclick="apply();">
     <input type="button" id="back" value="<%GetString("Lan","65");%>" onclick="goBack();">
</div>
<input type="hidden" name="nosave_session_num" value="<% NvramGet("session_num"); %>">
</form>
<form name="vpndelete_form" method="POST">
	<input type="hidden" id="vpnid_PPTPDelete" name="PPTPDeleteid" value="">
	<input type="hidden" id="vpnid_PPTPDeleteuser" name="PPTPDeleteuser" value="">
	<input type="hidden" name="nosave_session_num" value="<% NvramGet("session_num"); %>">
</form>
</body>
</html>
